<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.266">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Telling Stories with Data - 8&nbsp; Hunt data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-clean_and_prepare.html" rel="next">
<link href="./07-gather.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-farm.html">Acquisition</a></li><li class="breadcrumb-item"><a href="./08-hunt.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hunt data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Telling Stories with Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RohanAlexander/telling_stories/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Telling stories with data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-drinking_from_a_fire_hose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Drinking from a fire hose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-writing_research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-static_communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Static communication</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Acquisition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-farm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Farm data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-gather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Gather data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-hunt.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hunt data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-clean_and_prepare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Clean and prepare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-store_and_share.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Store and share</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ijalm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-ijaglm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Generalized linear models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-causality_from_obs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Causality from observational data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mrp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multilevel regression with post-stratification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Text as data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-concluding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Concluding remarks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-r_essentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R essentials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Papers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Interaction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-datasheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Datasheets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">SQL essentials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Production</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29-activities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Class activities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./97-errata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Errata and updates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-cocktails.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Cocktails</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">8.1</span> Introduction</a></li>
  <li><a href="#field-experiments-and-randomized-controlled-trials" id="toc-field-experiments-and-randomized-controlled-trials" class="nav-link" data-scroll-target="#field-experiments-and-randomized-controlled-trials"><span class="header-section-number">8.2</span> Field experiments and randomized controlled trials</a>
  <ul class="collapse">
  <li><a href="#randomization" id="toc-randomization" class="nav-link" data-scroll-target="#randomization"><span class="header-section-number">8.2.1</span> Randomization</a></li>
  <li><a href="#simulated-example-cats-or-dogs" id="toc-simulated-example-cats-or-dogs" class="nav-link" data-scroll-target="#simulated-example-cats-or-dogs"><span class="header-section-number">8.2.2</span> Simulated example: cats or dogs</a></li>
  <li><a href="#treatment-and-control" id="toc-treatment-and-control" class="nav-link" data-scroll-target="#treatment-and-control"><span class="header-section-number">8.2.3</span> Treatment and control</a></li>
  <li><a href="#fishers-tea-party" id="toc-fishers-tea-party" class="nav-link" data-scroll-target="#fishers-tea-party"><span class="header-section-number">8.2.4</span> Fisher’s tea party</a></li>
  <li><a href="#ethical-foundations" id="toc-ethical-foundations" class="nav-link" data-scroll-target="#ethical-foundations"><span class="header-section-number">8.2.5</span> Ethical foundations</a></li>
  </ul></li>
  <li><a href="#surveys" id="toc-surveys" class="nav-link" data-scroll-target="#surveys"><span class="header-section-number">8.3</span> Surveys</a>
  <ul class="collapse">
  <li><a href="#democracy-fund-voter-study-group" id="toc-democracy-fund-voter-study-group" class="nav-link" data-scroll-target="#democracy-fund-voter-study-group"><span class="header-section-number">8.3.1</span> Democracy Fund Voter Study Group</a></li>
  </ul></li>
  <li><a href="#rct-examples" id="toc-rct-examples" class="nav-link" data-scroll-target="#rct-examples"><span class="header-section-number">8.4</span> RCT examples</a>
  <ul class="collapse">
  <li><a href="#the-oregon-health-insurance-experiment" id="toc-the-oregon-health-insurance-experiment" class="nav-link" data-scroll-target="#the-oregon-health-insurance-experiment"><span class="header-section-number">8.4.1</span> The Oregon Health Insurance Experiment</a></li>
  <li><a href="#civic-honesty-around-the-globe" id="toc-civic-honesty-around-the-globe" class="nav-link" data-scroll-target="#civic-honesty-around-the-globe"><span class="header-section-number">8.4.2</span> Civic Honesty Around The Globe</a></li>
  </ul></li>
  <li><a href="#ab-testing" id="toc-ab-testing" class="nav-link" data-scroll-target="#ab-testing"><span class="header-section-number">8.5</span> A/B testing</a>
  <ul class="collapse">
  <li><a href="#upworthy" id="toc-upworthy" class="nav-link" data-scroll-target="#upworthy"><span class="header-section-number">8.5.1</span> Upworthy</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">8.6</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales">Scales</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial">Tutorial</a></li>
  <li><a href="#paper" id="toc-paper" class="nav-link" data-scroll-target="#paper">Paper</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RohanAlexander/telling_stories/edit/main/08-hunt.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-hunt-data" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hunt data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Prerequisites</strong></p>
<ul>
<li>Read <em>Impact evaluation in practice</em>, <span class="citation" data-cites="gertler2016impact">(<a href="99-references.html#ref-gertler2016impact" role="doc-biblioref">Gertler et al. 2016</a>)</span>
<ul>
<li>Focus on Chapters 3 and 4 which provide a broad discussion of causal inference and randomization.</li>
</ul></li>
<li>Read <em>The Psychology of Survey Response</em>, <span class="citation" data-cites="tourangeau2000">(<a href="99-references.html#ref-tourangeau2000" role="doc-biblioref">Tourangeau, Rips, and Rasinski 2000</a>)</span>
<ul>
<li>Focus on Chapter 2 “Respondents’ Understanding of Survey Questions”, which discusses the wording of survey questions.</li>
</ul></li>
<li>Read <em>How to Run Surveys</em>, <span class="citation" data-cites="Stantcheva2023">(<a href="99-references.html#ref-Stantcheva2023" role="doc-biblioref">Stantcheva 2023</a>)</span>
<ul>
<li>This paper provides an overview of practice concerns when putting surveys together.</li>
</ul></li>
<li>Read <em>Q&amp;A: How Pew Research Center surveyed nearly 30,000 people in India</em>, <span class="citation" data-cites="pewletterman">(<a href="99-references.html#ref-pewletterman" role="doc-biblioref">Letterman 2021</a>)</span>
<ul>
<li>Discusses many practical issues that occurred during a large survey about religious beliefs.</li>
</ul></li>
<li>Read <em>Statistics and causal inference</em>, <span class="citation" data-cites="holland1986statistics">(<a href="99-references.html#ref-holland1986statistics" role="doc-biblioref">Holland 1986</a>)</span>
<ul>
<li>Focus on Parts 1-3 which discuss how we can use statistical models, especially Rubin’s model, to understand the effect of causes.</li>
</ul></li>
<li>Read <em>Big tech is testing you</em>, <span class="citation" data-cites="fry2020big">(<a href="99-references.html#ref-fry2020big" role="doc-biblioref">Fry 2020</a>)</span>
<ul>
<li>This article discusses the use of A/B testing in tech firms.</li>
</ul></li>
<li>Watch <em>Causal Inference Challenges in Industry: A perspective from experiences at LinkedIn</em>, <span class="citation" data-cites="yaxu">(<a href="99-references.html#ref-yaxu" role="doc-biblioref">Xu 2020</a>)</span>
<ul>
<li>Focus on the first half of this video, which provides an overview of A/B testing.</li>
</ul></li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>Randomization is used to establish treatment and control groups. The idea is that, but for the treatment, these groups would be the same. This then allows us to measure an average effect of the treatment. But there are many threats to the validity of that estimate.</li>
<li>Once we have estimates, we want to know the extent to which they apply. If they apply to only the context of the experiment, then they have internal validity. If they generalize outside of that context, then they have external validity. <!-- - The value of experiments comes from the fact that they are  --></li>
<li>Appreciating why informed consent and establishing the need for an experiment are important.</li>
<li>A/B testing and some of its nuances.</li>
<li>Designing and implementing surveys.</li>
</ul>
<p><strong>Software and packages</strong></p>
<ul>
<li>Base R <span class="citation" data-cites="citeR">(<a href="99-references.html#ref-citeR" role="doc-biblioref">R Core Team 2023</a>)</span></li>
<li><code>haven</code> <span class="citation" data-cites="citehaven">(<a href="99-references.html#ref-citehaven" role="doc-biblioref">Wickham, Miller, and Smith 2023</a>)</span></li>
<li><code>knitr</code> <span class="citation" data-cites="citeknitr">(<a href="99-references.html#ref-citeknitr" role="doc-biblioref">Xie 2023</a>)</span></li>
<li><code>labelled</code> <span class="citation" data-cites="citelabelled">(<a href="99-references.html#ref-citelabelled" role="doc-biblioref">Larmarange 2023</a>)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(<a href="99-references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">8.1</span> Introduction</h2>
<p>This chapter is about obtaining data with experiments. This is a situation in which we can explicitly control and vary what we are interested in. The advantage of this is that identifying and estimating an effect should be clear. There is a treatment group that is subject to what we are interested in, and a control group that is not. These are randomly split before treatment. And so, if they end up different, then it must be because of the treatment. Unfortunately, life is rarely so smooth. Arguing about how similar the treatment and control groups were tends to carry on indefinitely. And before we can estimate an effect, we need to be able to measure whatever it is that we are interested in, which is often surprisingly difficult.</p>
<p>By way of motivation, consider the situation of someone who moved to San Francisco in 2014—as soon as they moved the Giants won the World Series and the Golden State Warriors began a historic streak of World Championships. They then moved to Chicago, and immediately the Cubs won the World Series for the first time in 100 years. They then moved to Massachusetts, and the Patriots won the Super Bowl again, and again, and again. And finally, they moved to Toronto, where the Raptors immediately won the World Championship. Should a city pay them to move, or could municipal funds be better spent elsewhere?</p>
<p>One way to get at the answer would be to run an experiment. Make a list of the North American cities with major sports teams. Then roll some dice, send them to live there for a year, and measure the outcomes of the sports teams. With enough lifetimes, we could work it out. This would take a long time because we cannot both live in a city and not live in a city. This is the fundamental problem of causal inference: a person cannot be both treated and untreated. Experiments and randomized controlled trials are circumstances in which we try to randomly allocate some treatment, to have a belief that everything else was the same (or at least ignorable). We use the Neyman-Rubin potential outcomes framework to formalize the situation <span class="citation" data-cites="holland1986statistics">(<a href="99-references.html#ref-holland1986statistics" role="doc-biblioref">Holland 1986</a>)</span>. <!-- This is named after Jerzy Neyman and Donald Rubin, who were both twentieth century statisticians. --></p>
<p>A treatment, <span class="math inline">\(t\)</span>, will often be a binary variable, that is either 0 or 1. It is 0 if the person, <span class="math inline">\(i\)</span>, is not treated, which is to say they are in the control group, and 1 if they are treated. We will typically have some outcome, <span class="math inline">\(Y_i\)</span>, of interest for that person which could be binary, categorical, multinomial, ordinal, continuous, or possibly even some other type of variable. For instance, it could be vote choice, in which case we could measure whether the person is: “Conservative” or “Not Conservative”; which party they support, say: “Conservative”, “Liberal”, “Democratic”, “Green”; or maybe a probability of supporting some particular leader.</p>
<p>The effect of a treatment is then causal if <span class="math inline">\((Y_i|t=0) \neq (Y_i|t=1)\)</span>. That is to say, the outcome for person <span class="math inline">\(i\)</span>, given they were not treated, is different to their outcome given they were treated. If we could both treat and control the one individual at the one time, then we would know that it was only the treatment that had caused any change in outcome. There could be no other factor to explain it. But the fundamental problem of causal inference remains: we cannot both treat and control the one individual at the one time. So, when we want to know the effect of the treatment, we need to compare it with a counterfactual. The counterfactual, introduced in <a href="04-writing_research.html"><span>Chapter&nbsp;4</span></a>, is what would have happened if the treated individual were not treated. As it turns out, this means one way to think of causal inference is as a missing data problem, where we are missing the counterfactual.</p>
<p>We cannot compare treatment and control in one individual. So we instead compare the average of two groups—those treated and those not. We are looking to estimate the counterfactual at a group level because of the impossibility of doing it at an individual level. Making this trade-off allows us to move forward but comes at the cost of certainty. We must instead rely on randomization, probabilities, and expectations.</p>
<p>We usually consider a default of there being no effect and we look for evidence that would cause us to change our mind. As we are interested in what is happening in groups, we turn to expectations and notions of probability to express ourselves. Hence, we will make claims that apply on average. Maybe wearing fun socks really does make you have a lucky day, but on average, across the group, it is probably not the case. It is worth pointing out that we do not just have to be interested in the average effect. We may consider the median, or variance, or whatever. Nonetheless, if we were interested in the average effect, then one way to proceed would be to:</p>
<ol type="1">
<li>divide the dataset in two—treated and not treated—and have a binary effect variable—lucky day or not;</li>
<li>sum the variable, then divide it by the length of the variable; and</li>
<li>compare this value between the two groups.</li>
</ol>
<p>This is an estimator, introduced in <a href="04-writing_research.html"><span>Chapter&nbsp;4</span></a>, which is a way of putting together a guess of something of interest. The estimand is the thing of interest, in this case the average effect, and the estimate is whatever our guess turns out to be. We can simulate data to illustrate the situation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>treat_control <span class="ot">&lt;-</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Control"</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">binary_effect =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>treat_control</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   group     binary_effect
   &lt;chr&gt;             &lt;dbl&gt;
 1 Treatment             0
 2 Control               1
 3 Control               1
 4 Treatment             1
 5 Treatment             1
 6 Treatment             0
 7 Treatment             1
 8 Treatment             1
 9 Control               0
10 Control               0
# ℹ 90 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>treat_control <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat_result =</span> <span class="fu">sum</span>(binary_effect) <span class="sc">/</span> <span class="fu">length</span>(binary_effect),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> group</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  group     treat_result
  &lt;chr&gt;            &lt;dbl&gt;
1 Treatment        0.552
2 Control          0.333</code></pre>
</div>
</div>
<p>In this case, we draw either 0 or 1, 100 times, for each the treatment and control group, and then the estimate of the average effect of being treated is 0.22.</p>
<p>More broadly, to tell causal stories we need to bring together theory and a detailed knowledge of what we are interested in <span class="citation" data-cites="Cunningham2021">(<a href="99-references.html#ref-Cunningham2021" role="doc-biblioref">Cunningham 2021, 4</a>)</span>. In <a href="07-gather.html"><span>Chapter&nbsp;7</span></a> we discussed gathering data that we observed about the world. In this chapter we are going to be more active about turning the world into the data that we need. As the researcher, we will decide what to measure and how, and we will need to define what we are interested in. We will be active participants in the data-generating process. That is, if we want to use this data, then as researchers we must go out and hunt it.</p>
<p>In this chapter we cover experiments, especially constructing treatment and control groups, and appropriately considering their results. We go through implementing a survey. We discuss some aspects of ethical behavior in experiments through reference to the Tuskegee Syphilis Study and the Extracorporeal Membrane Oxygenation (ECMO) experiment and go through various case studies. Finally, we then turn to A/B testing, which is extensively used in industry, and consider a case study based on Upworthy data.</p>
<p>Ronald Fisher, the twentieth century statistician, and Francis Galton, the nineteenth century statistician, are the intellectual grandfathers of much of the work that we cover in this chapter. In some cases it is directly their work, in other cases it is work that built on their contributions. Both men believed in eugenics, amongst other things that are generally reprehensible. In the same way that art history acknowledges, say, Caravaggio as a murderer, while also considering his work and influence, so too must statistics and data science more generally concern themselves with this past, at the same time as we try to build a better future.</p>
</section>
<section id="field-experiments-and-randomized-controlled-trials" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="field-experiments-and-randomized-controlled-trials"><span class="header-section-number">8.2</span> Field experiments and randomized controlled trials</h2>
<section id="randomization" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="randomization"><span class="header-section-number">8.2.1</span> Randomization</h3>
<p>Correlation can be enough in some settings <span class="citation" data-cites="hill1965environment">(<a href="99-references.html#ref-hill1965environment" role="doc-biblioref">Hill 1965</a>)</span>, but to be able to make forecasts when things change, and circumstances are slightly different, we should try to understand causation. Economics went through a credibility revolution in the 2000s <span class="citation" data-cites="angrist2010credibility">(<a href="99-references.html#ref-angrist2010credibility" role="doc-biblioref">Angrist and Pischke 2010</a>)</span>. Economists realized previous work was not as reliable as it could be. There was increased concern with research design and use of experiments. This also happened in other social sciences, such as political science at a similar time <span class="citation" data-cites="Druckman2021">(<a href="99-references.html#ref-Druckman2021" role="doc-biblioref">Druckman and Green 2021</a>)</span>.</p>
<p>The key is the counterfactual: what would have happened in the absence of the treatment. Ideally, we could keep everything else constant, randomly divide the world into two groups, and treat one and not the other. Then we could be confident that any difference between the two groups was due to that treatment. The reason for this is that if we have some population and we randomly select two groups from it, then those two groups (provided they are both big enough) should have the same characteristics as the population. Randomized controlled trials (RCTs) and A/B testing attempt to get us as close to this “gold standard” as we can hope.</p>
<p>When we, and others such as <span class="citation" data-cites="athey2017state">Athey and Imbens (<a href="99-references.html#ref-athey2017state" role="doc-biblioref">2017b</a>)</span>, use such positive language to refer to these approaches, we do not mean to imply that they are perfect. Just that they can be better than most of the other options. For instance, in <a href="14-causality_from_obs.html"><span>Chapter&nbsp;14</span></a> we will consider causality from observational data, and while this is sometimes all that we can do, the circumstances in which it is possible to evaluate both makes it clear that approaches based on observational data are usually second-best <span class="citation" data-cites="Gordon2019 closeenoughaintgoodenough">(<a href="99-references.html#ref-Gordon2019" role="doc-biblioref">Gordon et al. 2019</a>; <a href="99-references.html#ref-closeenoughaintgoodenough" role="doc-biblioref">Gordon, Moakler, and Zettelmeyer 2022</a>)</span>. RCTs and A/B testing also bring other benefits, such as the chance to design a study that focuses on a particular question and tries to uncover the mechanism by which the effect occurs <span class="citation" data-cites="alsan2021beyond">(<a href="99-references.html#ref-alsan2021beyond" role="doc-biblioref">Alsan and Finkelstein 2021</a>)</span>. But they are not perfect, and the embrace of RCTs has not been unanimous <span class="citation" data-cites="Deaton2010">(<a href="99-references.html#ref-Deaton2010" role="doc-biblioref">Deaton 2010</a>)</span>.</p>
<p>One bedrock of experimental practice is that it be blinded, that is, a participant does not know whether they are in the treatment or control group. A failure to blind, especially with subjective outcomes, is grounds for the dismissal of an entire experiment in some disciplines <span class="citation" data-cites="blindpace">(<a href="99-references.html#ref-blindpace" role="doc-biblioref">Edwards 2017</a>)</span>. Ideally experiments should be double-blind, that is, even the researcher does not know. <span class="citation" data-cites="stolberg2006inventing">Stolberg (<a href="99-references.html#ref-stolberg2006inventing" role="doc-biblioref">2006</a>)</span> discusses an early example of a randomized double-blind trial in 1835 to evaluate the effect of homeopathic drugs where neither the participants nor the organizers knew who was in which group. This is rarely the case for RCTs and A/B testing. Again, this is not to say they are not useful—after all in 1847 Semmelweis identified the benefit of having an intern wash their hands before delivering babies without a blinded study <span class="citation" data-cites="morange">(<a href="99-references.html#ref-morange" role="doc-biblioref">Morange 2016, 121</a>)</span>. Another major concern is with the extent to which the result found in the RCT generalizes to outside of that setting. There are typically few RCTs conducted over a long time, although it is possible this is changing and <span class="citation" data-cites="Bouguen2019">Bouguen et al. (<a href="99-references.html#ref-Bouguen2019" role="doc-biblioref">2019</a>)</span> provide some RCTs that could be followed up on to assess long-term effects. Finally, the focus on causality has not been without cost in social sciences. Some argue that a causality-focused approach centers attention on the types of questions that it can answer at the expense of other types of questions.</p>
</section>
<section id="simulated-example-cats-or-dogs" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="simulated-example-cats-or-dogs"><span class="header-section-number">8.2.2</span> Simulated example: cats or dogs</h3>
<p>We hope to be able to establish treatment and control groups that are the same, but for the treatment. This means creating the control group is critical because when we do that, we establish the counterfactual. We might be worried about, say, underlying trends, which is one issue with a before-and-after comparison, or selection bias, which could occur when we allow self-selection into the treatment group. Either of these issues could result in biased estimates. We use randomization to go some way to addressing these.</p>
<p>To get started, we simulate a population, and then randomly sample from it. We will set it up so that half the population likes blue, and the other half likes white. And further, if someone likes blue then they almost surely prefer dogs, but if they like white then they almost surely prefer cats. Simulation is a critical part of the workflow advocated in this book. This is because we know what the outcomes should be from the analysis of simulated data. Whereas if we go straight to analyzing real data, then we do not know if unexpected outcomes are due to our own analysis errors, or actual results. Another good reason it is useful to take this approach of simulation is that when you are working in teams the analysis can get started before the data collection and cleaning is completed. The simulation will also help the collection and cleaning team think about tests they should run on their data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>num_people <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">person =</span> <span class="dv">1</span><span class="sc">:</span>num_people,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">favorite_color =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Blue"</span>, <span class="st">"White"</span>), <span class="at">size =</span> num_people, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prefers_dogs =</span> <span class="fu">if_else</span>(favorite_color <span class="sc">==</span> <span class="st">"Blue"</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rbinom</span>(num_people, <span class="dv">1</span>, <span class="fl">0.9</span>), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rbinom</span>(num_people, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>population <span class="sc">|&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(favorite_color, prefers_dogs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  favorite_color prefers_dogs     n
  &lt;chr&gt;                 &lt;int&gt; &lt;int&gt;
1 Blue                      0   256
2 Blue                      1  2291
3 White                     0  2239
4 White                     1   214</code></pre>
</div>
</div>
<p>Building on the terminology and concepts introduced in <a href="06-farm.html"><span>Chapter&nbsp;6</span></a>, we now construct a sampling frame that contains about 80 per cent of the target population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>frame <span class="ot">&lt;-</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  population <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">in_frame =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> num_people, <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(in_frame <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>frame <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(favorite_color, prefers_dogs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  favorite_color prefers_dogs     n
  &lt;chr&gt;                 &lt;int&gt; &lt;int&gt;
1 Blue                      0   201
2 Blue                      1  1822
3 White                     0  1803
4 White                     1   177</code></pre>
</div>
</div>
<p>For now, we will set aside dog or cat preferences and focus on creating treatment and control groups with favorite color only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  frame <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>prefers_dogs) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Control"</span>), <span class="at">size =</span> <span class="fu">nrow</span>(frame), <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we look at the mean for the two groups, we can see that the proportions that prefer blue or white are very similar to what we specified (<a href="#tbl-dogsdtocats">Table&nbsp;<span>8.1</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sample <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(group, favorite_color) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> group) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Prefers"</span>, <span class="st">"Number"</span>, <span class="st">"Proportion"</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-dogsdtocats" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;8.1: Proportion of the groups that prefer blue or white</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Prefers</th>
<th style="text-align: right;">Number</th>
<th style="text-align: right;">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Blue</td>
<td style="text-align: right;">987</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">997</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment</td>
<td style="text-align: left;">Blue</td>
<td style="text-align: right;">1,036</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment</td>
<td style="text-align: left;">White</td>
<td style="text-align: right;">983</td>
<td style="text-align: right;">0.49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We randomized with favorite color only. But we should also find that we took dog or cat preferences along at the same time and will have a “representative” share of people who prefer dogs to cats. We can look at our dataset (<a href="#tbl-dogstocats">Table&nbsp;<span>8.2</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sample <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    frame <span class="sc">|&gt;</span> <span class="fu">select</span>(person, prefers_dogs),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"person"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(group, prefers_dogs) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> group) <span class="sc">|&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Group"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Prefers dogs to cats"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Number"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Proportion"</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-dogstocats" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;8.2: Proportion of the treatment and control group that prefer dogs or cats</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: right;">Prefers dogs to cats</th>
<th style="text-align: right;">Number</th>
<th style="text-align: right;">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1,002</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">982</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1,002</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1,017</td>
<td style="text-align: right;">0.50</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It is exciting to have a representative share on “unobservables”. (In this case, we do “observe” them—to illustrate the point—but we did not select on them). We get this because the variables were correlated. But it will break down in several ways that we will discuss. It also assumes large enough groups. For instance, if we considered specific dog breeds, instead of dogs as an entity, we may not find ourselves in this situation. To check that the two groups are the same, we look to see if we can identify a difference between the two groups based on observables, theory, experience, and expert opinion. In this case we looked at the mean, but we could look at other aspects as well.</p>
<p>This would traditionally bring us to Analysis of Variance (ANOVA). ANOVA was introduced around 100 years ago by Fisher while he was working on statistical problems in agriculture. (<span class="citation" data-cites="Stolley1991">Stolley (<a href="99-references.html#ref-Stolley1991" role="doc-biblioref">1991</a>)</span> provides additional background on Fisher.) This is less unexpected than it may seem because historically agricultural research was closely tied to statistical innovation. Often statistical methods were designed to answer agricultural questions such as “does fertilizer work?” and were only later adapted to clinical trials <span class="citation" data-cites="yoshioka1998use">(<a href="99-references.html#ref-yoshioka1998use" role="doc-biblioref">Yoshioka 1998</a>)</span>. It was relatively easily to divide a field into “treated” and “non-treated”, and the magnitude of any effect was likely to be large. While appropriate for that context, often these same statistical approaches are still taught today in introductory material, even when they are being applied in different circumstances to those they were designed for. It almost always pays to take a step back and think about what is being done and whether it is appropriate to the circumstances. We mention ANOVA here because of its importance historically. There is nothing wrong with it in the right setting. But the number of modern use-cases where it is the best option tends to be small. It might be better to build the model that underpins ANOVA ourselves, which we cover in <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a>.</p>
</section>
<section id="treatment-and-control" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="treatment-and-control"><span class="header-section-number">8.2.3</span> Treatment and control</h3>
<p>If the treatment and control groups are the same in all ways and remain that way, but for the treatment, then we have internal validity, which is to say that our control will work as a counterfactual and our results can speak to a difference between the groups in that study. Internal validity means that our estimates of the effect of the treatment speak to the treatment and not some other aspect. It means that we can use our results to make claims about what happened in the experiment.</p>
<p>If the group to which we applied our randomization were representative of the broader population, and the experimental set-up was like outside conditions, then we further could have external validity. That would mean that the difference that we find does not just apply in our own experiment, but also in the broader population. External validity means that we can use our experiment to make claims about what would happen outside the experiment. It is randomization that has allowed that to happen. In practice we would not just rely on one experiment but would instead consider that a contribution to a broader evidence-collection effort <span class="citation" data-cites="Duflo2020">(<a href="99-references.html#ref-Duflo2020" role="doc-biblioref">Duflo 2020, 1955</a>)</span>.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dr Esther Duflo is Abdul Latif Jameel Professor of Poverty Alleviation and Development Economics at MIT. After earning a PhD in Economics from MIT in 1999, she remained at MIT as an assistant professor, being promoted to full professor in 2003. One area of her research is economic development where she uses randomized controlled trials to understand how to address poverty. One of her most important books is <em>Poor Economics</em> <span class="citation" data-cites="pooreconomics">(<a href="99-references.html#ref-pooreconomics" role="doc-biblioref">Banerjee and Duflo 2011</a>)</span>. One of her most important papers is <span class="citation" data-cites="banerjee2015miracle">Banerjee et al. (<a href="99-references.html#ref-banerjee2015miracle" role="doc-biblioref">2015</a>)</span> which uses randomization to examine the effect of microfinance. She was awarded the Sveriges Riksbank Prize in Economic Sciences in Memory of Alfred Nobel in 2019.</p>
</div>
</div>
<p>But this means we need randomization twice. Firstly, into the group that was subject to the experiment, and then secondly, between treatment and control. How do we think about this randomization, and to what extent does it matter?</p>
<p>We are interested in the effect of being treated. It may be that we charge different prices, which would be a continuous treatment variable, or that we compare different colors on a website, which would be a discrete treatment variable. Either way, we need to make sure that the groups are otherwise the same. How can we be convinced of this? One way is to ignore the treatment variable and to examine all other variables, looking for whether we can detect a difference between the groups based on any other variables. For instance, if we are conducting an experiment on a website, then are the groups roughly similar in terms of, say:</p>
<ul>
<li>Microsoft and Apple users?</li>
<li>Safari, Chrome, and Firefox users?</li>
<li>Mobile and desktop users?</li>
<li>Users from certain locations?</li>
</ul>
<p>Further, are the groups representative of the broader population? These are all threats to the validity of our claims. For instance, the Nationscape survey which we consider later in this chapter was concerned about the number of Firefox users who completed the survey. In the end they exclude a subset of those respondents <span class="citation" data-cites="nationscapeuserguide">(<a href="99-references.html#ref-nationscapeuserguide" role="doc-biblioref">Vavreck and Tausanovitch 2021, 5</a>)</span>.</p>
<p>When done properly, that is if the treatment is truly independent, then we can estimate the average treatment effect (ATE). In a binary treatment variable setting this is:</p>
<p><span class="math display">\[\mbox{ATE} = \mathbb{E}[Y|t=1] - \mathbb{E}[Y|t=0].\]</span></p>
<p>That is, the difference between the treated group, <span class="math inline">\(t = 1\)</span>, and the control group, <span class="math inline">\(t = 0\)</span>, when measured by the expected value of the outcome, <span class="math inline">\(Y\)</span>. The ATE becomes the difference between two conditional expectations.</p>
<p>To illustrate this concept, we simulate some data that shows an average difference of one between the treatment and control groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ate_example <span class="ot">&lt;-</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">person =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">treated =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>), <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    treated <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    treated <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see the difference, which we simulated to be one, between the two groups in <a href="#fig-exampleatefig">Figure&nbsp;<span>8.1</span></a>. And we can compute the average between the groups and then the difference to see also that we roughly get back the result that we put in (<a href="#tbl-exampleatetable">Table&nbsp;<span>8.3</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ate_example <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> outcome, <span class="at">fill =</span> treated)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge2"</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Outcome"</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of people"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Person was treated"</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exampleatefig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="08-hunt_files/figure-html/fig-exampleatefig-1.png" class="quarto-discovered-preview-image img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8.1: Simulated data showing a difference between the treatment and control group</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ate_example <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(outcome),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> treated) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Was treated?"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Average effect"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-exampleatetable" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;8.3: Average difference between the treatment and control groups for data simulated to have an average difference of one</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Was treated?</th>
<th style="text-align: right;">Average effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">6.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: right;">5.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Unfortunately, there is often a difference between simulated data and reality. For instance, an experiment cannot run for too long otherwise people may be treated many times or become inured to the treatment; but it cannot be too short otherwise we cannot measure longer-term outcomes. We cannot have a “representative” sample across every facet of a population, but if not, then the treatment and control may be different. Practical difficulties may make it difficult to follow up with certain groups and so we end up with a biased collection. Some questions to explore when working with real experimental data include:</p>
<ul>
<li>How are the participants being selected into the frame for consideration?</li>
<li>How are they being selected for treatment? We would hope this is being done randomly, but this term is applied to a variety of situations. Additionally, early “success” can lead to pressure to treat everyone, especially in medical settings.</li>
<li>How is treatment being assessed?</li>
<li>To what extent is random allocation ethical and fair? Some argue that shortages mean it is reasonable to randomly allocate, but that may depend on how linear the benefits are. It may also be difficult to establish definitions, and the power imbalance between those making these decisions and those being treated should be considered.</li>
</ul>
<p>Bias and other issues are not the end of the world. But we need to think about them carefully. Selection bias, introduced in <a href="04-writing_research.html"><span>Chapter&nbsp;4</span></a>, can be adjusted for, but only if it is recognized. For instance, how would the results of a survey about the difficulty of a university course differ if only students who completed the course were surveyed, and not those who dropped out? We should always work to try to make our dataset as representative as possible when we are creating it, but it may be possible to use a model to adjust for some of the bias after the fact. For instance, if there were a variable that was correlated with, say, attrition, then it could be added to the model either by itself, or as an interaction. Similarly, if there was correlation between the individuals. For instance, if there was some “hidden variable” that we did not know about that meant some individuals were correlated, then we could use wider standard errors. This needs to be done carefully and we discuss this further in <a href="14-causality_from_obs.html"><span>Chapter&nbsp;14</span></a>. That said, if such issues can be anticipated, then it may be better to change the experiment. For instance, perhaps it would be possible to stratify by that variable.</p>
</section>
<section id="fishers-tea-party" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="fishers-tea-party"><span class="header-section-number">8.2.4</span> Fisher’s tea party</h3>
<p>The British are funny when it comes to tea. There is substantial, persistent, debate in Britain about how to make the perfect “cuppa” with everyone from George Orwell to John Lennon weighing in. Some say to add the milk first. Others, to add it last. YouGov, a polling company, found that most respondents put milk in last <span class="citation" data-cites="yougovforthedefence">(<a href="99-references.html#ref-yougovforthedefence" role="doc-biblioref">Smith 2018</a>)</span>. But one might wonder whether the order matters at all.</p>
<p>Fisher introduced an experiment designed to see if a person can distinguish between a cup of tea where the milk was added first, or last. We begin by preparing eight cups of tea: four with milk added first and the other four with milk added last. We then randomize the order of all eight cups. We tell the taster, whom we will call “Ian”, about the experimental set-up: there are eight cups of tea, four of each type, he will be given cups of tea in a random order, and his task is to group them into two groups.</p>
<p>One of the nice aspects of this experiment is that we can do it ourselves. There are a few things to be careful of in practice. These include:</p>
<ol type="1">
<li>that the quantities of milk and tea are consistent,</li>
<li>the groups are marked in some way that the taster cannot see, and</li>
<li>the order is randomized.</li>
</ol>
<p>Another nice aspect of this experiment is that we can calculate the chance that Ian is able to randomly get the groupings correct. To decide if his groupings were likely to have occurred at random, we need to calculate the probability this could happen. First, we count the number of successes out of the four that were chosen. There are: <span class="math inline">\({8 \choose 4} = \frac{8!}{4!(8-4)!}=70\)</span> possible outcomes <span class="citation" data-cites="fisherdesignofexperiments">(<a href="99-references.html#ref-fisherdesignofexperiments" role="doc-biblioref">Fisher [1935] 1949, 14</a>)</span>. This notation means there are eight items in the set, and we are choosing four of them, and is used when the order of choice does not matter.</p>
<p>We are asking Ian to group the cups, not to identify which is which, and so there are two ways for him to be perfectly correct. He could either correctly identify all the ones that were milk-first (one outcome out of 70) or correctly identify all the ones that were tea-first (one outcome out of 70). This means the probability of this event is: <span class="math inline">\(\frac{2}{70}\)</span>, or about three per cent.</p>
<p>As <span class="citation" data-cites="fisherdesignofexperiments">Fisher (<a href="99-references.html#ref-fisherdesignofexperiments" role="doc-biblioref">[1935] 1949, 15</a>)</span> makes clear, this now becomes a judgement call. We need to consider the weight of evidence that we require before we accept the groupings did not occur by chance and that Ian was aware of what he was doing. We need to decide what evidence it takes for us to be convinced. If there is no possible evidence that would dissuade us from the view that we held coming into the experiment, say, that there is no difference between milk-first and tea-first, then what is the point of doing an experiment? We expect that if Ian got it completely right, then the reasonable person would accept that he was able to tell the difference.</p>
<p>What if he is almost perfect? By chance, there are 16 ways for a person to be “off-by-one”. Either Ian thinks there was one cup that was milk-first when it was tea-first—there are, <span class="math inline">\({4 \choose 1} = 4\)</span>, four ways this could happen—or he thinks there was one cup that was tea-first when it was milk-first—again, there are, <span class="math inline">\({4 \choose 1}\)</span> = 4, four ways this could happen. These outcomes are independent, so the probability is <span class="math inline">\(\frac{4\times 4}{70}\)</span>, or about 23 per cent. Given there is an almost 23 per cent chance of being off-by-one just by randomly grouping the teacups, this outcome probably would not convince us that Ian could tell the difference between tea-first and milk-first.</p>
<p>What we are looking for, in order to claim something is experimentally demonstrable is that we have come to know the features of an experiment where such a result is reliably found <span class="citation" data-cites="fisherdesignofexperiments">(<a href="99-references.html#ref-fisherdesignofexperiments" role="doc-biblioref">Fisher [1935] 1949, 16</a>)</span>. We need a weight of evidence rather than just one experiment. We are looking to thoroughly interrogate our data and our experiments, and to think precisely about the analysis methods we are using. Rather than searching for meaning in constellations of stars, we want to make it as easy as possible for others to reproduce our work. It is in that way that our conclusions stand a better chance of holding up in the long term.</p>
</section>
<section id="ethical-foundations" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="ethical-foundations"><span class="header-section-number">8.2.5</span> Ethical foundations</h3>
<p>The weight of evidence in medical settings can be measured in lost lives. One reason ethical practice in medical experiments developed is to prevent the unnecessary loss of life. We now detail two cases where human life may have been unnecessarily lost that helped establish foundations of ethical practice. We consider the need to obtain informed consent by discussing the Tuskegee Syphilis Study. And the need to ensure that an experiment is necessary by discussing the ECMO experiments.</p>
<section id="tuskegee-syphilis-study" class="level4" data-number="8.2.5.1">
<h4 data-number="8.2.5.1" class="anchored" data-anchor-id="tuskegee-syphilis-study"><span class="header-section-number">8.2.5.1</span> Tuskegee Syphilis Study</h4>
<p>Following <span class="citation" data-cites="brandt1978racism">Brandt (<a href="99-references.html#ref-brandt1978racism" role="doc-biblioref">1978</a>)</span> and <span class="citation" data-cites="tuskegeeandthehealthofblackmen">Alsan and Wanamaker (<a href="99-references.html#ref-tuskegeeandthehealthofblackmen" role="doc-biblioref">2018</a>)</span>, the Tuskegee Syphilis Study is an infamous medical trial that began in 1932. As part of this experiment, 400 Black Americans with syphilis were not given appropriate treatment, nor even told they had syphilis, well after a standard treatment for syphilis was established and widely available. A control group, without syphilis, were also given non-effective drugs. These financially poor Black Americans in the United States South were offered minimal compensation and not told they were part of an experiment. Further, extensive work was undertaken to ensure the men would not receive treatment from anywhere, including writing to local doctors and the local health department. Even after some of the men were drafted and told to immediately get treatment, the draft board complied with a request to have the men excluded from treatment. By the time the study was stopped in 1972, more than half of the men were deceased and many of deaths were from syphilis-related causes.</p>
<p>The effect of the Tuskegee Syphilis Study was felt not just by the men in the study, but more broadly. <span class="citation" data-cites="tuskegeeandthehealthofblackmen">Alsan and Wanamaker (<a href="99-references.html#ref-tuskegeeandthehealthofblackmen" role="doc-biblioref">2018</a>)</span> found that it is associated with a decrease in life expectancy at age 45 of up to 1.5 years for Black men located around central Alabama because of medical mistrust and decreased interactions with physicians. In response the United States established requirements for Institutional Review Boards and President Clinton made a formal apology in 1997. <span class="citation" data-cites="brandt1978racism">Brandt (<a href="99-references.html#ref-brandt1978racism" role="doc-biblioref">1978, 27</a>)</span> says:</p>
<blockquote class="blockquote">
<p>In retrospect the Tuskegee Study revealed more about the pathology of racism than the pathology of syphilis; more about the nature of scientific inquiry than the nature of the disease process<span class="math inline">\(\dots\)</span> [T]he notion that science is a value-free discipline must be rejected. The need for greater vigilance in assessing the specific ways in which social values and attitudes affect professional behavior is clearly indicated.</p>
</blockquote>
<p><span class="citation" data-cites="hellertuskegee">Heller (<a href="99-references.html#ref-hellertuskegee" role="doc-biblioref">2022</a>)</span> provides further background on the Tuskegee Syphilis Study.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dr Marcella Alsan is a Professor of Public Policy at Harvard University. She has an MD from Loyola University and earned a PhD in Economics from Harvard University in 2012. She was appointed as an assistant professor at Stanford, being promoted to full professor in 2019 when she returned to Harvard. One area of her research is health inequality, and one particularly important paper is <span class="citation" data-cites="tuskegeeandthehealthofblackmen">Alsan and Wanamaker (<a href="99-references.html#ref-tuskegeeandthehealthofblackmen" role="doc-biblioref">2018</a>)</span>, which we discussed above. She was awarded a MacArthur Foundation Fellowship in 2021.</p>
</div>
</div>
</section>
<section id="extracorporeal-membrane-oxygenation-ecmo" class="level4" data-number="8.2.5.2">
<h4 data-number="8.2.5.2" class="anchored" data-anchor-id="extracorporeal-membrane-oxygenation-ecmo"><span class="header-section-number">8.2.5.2</span> Extracorporeal membrane oxygenation (ECMO)</h4>
<p>Turning to the evaluation of extracorporeal membrane oxygenation (ECMO), <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989</a>)</span> describes how they viewed ECMO as a possible treatment for persistent pulmonary hypertension in newborn children. They enrolled 19 patients and used conventional medical therapy on ten of them, and ECMO on nine of them. It was found that six of the ten in the control group survived while all in the treatment group survived. <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989</a>)</span> used randomized consent whereby only the parents of infants randomly selected to be treated with ECMO were asked to consent.</p>
<p>We are concerned with “equipoise”, by which we refer to a situation in which there is genuine uncertainty about whether the treatment is more effective than conventional procedures. In medical settings even if there is initial equipoise it could be undermined if the treatment is found to be effective early in the study. <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989</a>)</span> describes how after the results of these first 19 patients, randomization stopped and only ECMO was used. The recruiters and those treating the patients were initially not told that randomization had stopped. It was decided that this complete allocation to ECMO would continue “until either the 28th survivor or the 4th death was observed”. After 19 of 20 additional patients survived the trial was terminated. The experiment was effectively divided into two phases: in the first there was randomized use of ECMO, and in the second only ECMO was used.</p>
<p>One approach in these settings is a “randomized play-the-winner” rule following <span class="citation" data-cites="wei1978randomized">Wei and Durham (<a href="99-references.html#ref-wei1978randomized" role="doc-biblioref">1978</a>)</span>. Treatment is still randomized, but the probability shifts with each successful treatment to make treatment more likely, and there is some stopping rule. <span class="citation" data-cites="berry1989investigating">Berry (<a href="99-references.html#ref-berry1989investigating" role="doc-biblioref">1989</a>)</span> argues that far from the need for a more sophisticated stopping rule, there was no need for this study of ECMO because equipoise never existed. <span class="citation" data-cites="berry1989investigating">Berry (<a href="99-references.html#ref-berry1989investigating" role="doc-biblioref">1989</a>)</span> re-visits the literature mentioned by <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989</a>)</span> and finds extensive evidence that ECMO was already known to be effective. <span class="citation" data-cites="berry1989investigating">Berry (<a href="99-references.html#ref-berry1989investigating" role="doc-biblioref">1989</a>)</span> points out that there is almost never complete consensus and so one could almost always argue, inappropriately, for the existence of equipoise even in the face of a substantial weight of evidence. <span class="citation" data-cites="berry1989investigating">Berry (<a href="99-references.html#ref-berry1989investigating" role="doc-biblioref">1989</a>)</span> further criticizes <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989</a>)</span> for the use of randomized consent because of the potential that there may have been different outcomes for the infants subject to conventional medical therapy had their parents known there were other options.</p>
<p>The Tuskegee Syphilis Study and ECMO experiments may seem quite far from our present circumstances. While it may be illegal to do this exact research these days, it does not mean that unethical research does not still happen. For instance, we see it in machine learning applications in health and other areas; while we are not meant to explicitly discriminate and we are meant to get consent, it does not mean that we cannot implicitly discriminate without any type of consumer buy-in. For instance, <span class="citation" data-cites="obermeyer2019dissecting">Obermeyer et al. (<a href="99-references.html#ref-obermeyer2019dissecting" role="doc-biblioref">2019</a>)</span> describes how many health care systems in the United States use algorithms to score the severity of how sick a patient is. They show that for the same score, Black patients are sicker, and that if Black patients were scored in the same way as White patients, then they would receive considerably more care. They find that the discrimination occurs because the algorithm is based on health care costs, rather than sickness. But because access to healthcare is unequally distributed between Black and White patients, the algorithm, however inadvertently, perpetuates racial bias.</p>
</section>
</section>
</section>
<section id="surveys" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="surveys"><span class="header-section-number">8.3</span> Surveys</h2>
<p>Having decided what to measure, one common way to get values is to use a survey. This is especially challenging, and there is an entire field—survey research—focused on it. <span class="citation" data-cites="Edelman2021Interview">Edelman, Vittert, and Meng (<a href="99-references.html#ref-Edelman2021Interview" role="doc-biblioref">2021</a>)</span> make it clear that there are no new problems here, and the challenges that we face today are closely related to those that were faced in the past. There are many ways to implement surveys, and this decision matters. For some time, the only option was face-to-face surveys, where an enumerator conducted the survey in-person with the respondent. Eventually surveys began to be conducted over the telephone, again by an enumerator. One issue in both these settings was a considerable interviewer effect <span class="citation" data-cites="anchoringmethod">(<a href="99-references.html#ref-anchoringmethod" role="doc-biblioref">Elliott et al. 2022</a>)</span>. The internet brought a third era of survey research, characterized by low participation rates <span class="citation" data-cites="Groves2011">(<a href="99-references.html#ref-Groves2011" role="doc-biblioref">Groves 2011</a>)</span>. Surveys are a popular and invaluable way to get data. Face-to-face and telephone surveys are still used and have an important role to play, but many surveys are now internet-based.</p>
<p>There are many dedicated survey platforms, such as Survey Monkey and Qualtrics, that are largely internet-based. One especially common approach, because it is free, is to use Google Forms. In general, the focus of those platforms is enabling the user to construct and send a survey form. They typically expect the user already has contact details for some sampling frame.</p>
<p>Other platforms, such as Amazon Mechanical Turk, mentioned in <a href="03-workflow.html"><span>Chapter&nbsp;3</span></a>, and Prolific, focus on providing respondents. When using platforms like those we should try to understand who those respondents are and how they might differ from the population of interest <span class="citation" data-cites="Levay2016 whereyoursurveycomesfrom">(<a href="99-references.html#ref-Levay2016" role="doc-biblioref">Levay, Freese, and Druckman 2016</a>; <a href="99-references.html#ref-whereyoursurveycomesfrom" role="doc-biblioref">Enns and Rothschild 2022</a>)</span>.</p>
<p>The survey form needs to be considered within the context of the broader research and with special concern for the respondent. Try to conduct a test of the survey before releasing it. <span class="citation" data-cites="bydesignplanningresearch">Light, Singer, and Willett (<a href="99-references.html#ref-bydesignplanningresearch" role="doc-biblioref">1990, 213</a>)</span>, in the context of studies to evaluate higher education, say that there is no occasion in which a pilot study will not bring improvements, and that they are almost always worth it. In the case of surveys, we go further. If you do not have the time, or budget, to test a survey then it might be better to re-consider whether the survey should be done.</p>
<p>Try to test the wording of a survey <span class="citation" data-cites="tourangeau2000">(<a href="99-references.html#ref-tourangeau2000" role="doc-biblioref">Tourangeau, Rips, and Rasinski 2000, 23</a>)</span>. When designing the survey, we need to have survey questions that are conversational and flow from one to the next, grouped within topics <span class="citation" data-cites="elson2016question">(<a href="99-references.html#ref-elson2016question" role="doc-biblioref">Elson 2018</a>)</span>. But we should also consider the cognitive load that we place on the respondent, and vary the difficulty of the questions.</p>
<p>When designing a survey, the critical task is to keep the respondent front-of-mind <span class="citation" data-cites="surveystailored">(<a href="99-references.html#ref-surveystailored" role="doc-biblioref">Dillman, Smyth, and Christian [1978] 2014, 94</a>)</span>. Drawing on <span class="citation" data-cites="surveydesign">Swain (<a href="99-references.html#ref-surveydesign" role="doc-biblioref">1985</a>)</span>, all questions need to be relevant and able to be answered by the respondent. The wording of the questions should be based on what the respondent would be comfortable with. The decision between different question types turns on minimizing both error and the burden that we impose on the respondent. In general, if there are a small number of clear options then multiple-choice questions are appropriate. In that case, the responses should usually be mutually exclusive and collectively exhaustive. If they are not mutually exclusive, then this needs to be signaled in the text of the question. It is also important that units are specified, and that standard concepts are used, to the extent possible.</p>
<p>Open text boxes may be appropriate if there are many potential answers. This will increase both the time the respondent spends completing the survey and the time it will take to analyze the answers. Only ask one question at a time and try to ask questions in a neutral way that does not lead to one particular response. Testing the survey helps avoid ambiguous or double-barreled questions, which could confuse respondents. The subject matter of the survey will also affect the appropriate choice of question type. For instance, potentially “threatening” topics may be better considered with open-ended questions <span class="citation" data-cites="blair1977ask">(<a href="99-references.html#ref-blair1977ask" role="doc-biblioref">Blair et al. 1977</a>)</span>.</p>
<p>All surveys need to have an introduction that specifies a title for the survey, who is conducting it, their contact details, and the purpose. It should also include a statement about the confidentiality protections that are in place, and any ethics review board clearances that were obtained.</p>
<p>When doing surveys, it is critical to ask the right person. For instance, <span class="citation" data-cites="Lichand2022">Lichand and Wolf (<a href="99-references.html#ref-Lichand2022" role="doc-biblioref">2022</a>)</span> consider child labor. The extent of child labor is typically based on surveys of parents. When children were surveyed a considerable under-reporting by parents was found.</p>
<p>One aspect of particular concern is questions about sexual orientation and gender identity. While this is an evolving area, <span class="citation" data-cites="whitehousebestpractice">The White House (<a href="99-references.html#ref-whitehousebestpractice" role="doc-biblioref">2023</a>)</span> provides recommendations for best practice, such as considering how the data will be used, and ensuring sufficient sample size. With regard to asking about sexual orientation they recommend the following question:</p>
<ul>
<li>“Which of the following best represents how you think of yourself?”
<ol type="a">
<li>“Gay or lesbian”</li>
<li>“Straight, that is not gay or lesbian”</li>
<li>“Bisexual”</li>
<li>“I use a different term [free-text]”</li>
<li>“I don’t know”</li>
</ol></li>
</ul>
<p>And with regard to gender, they recommend a multi-question approach:</p>
<ul>
<li>“What sex were you assigned at birth, on your original birth certificate?”
<ol type="a">
<li>“Female”</li>
<li>“Male”</li>
</ol></li>
<li>“How do you currently describe yourself (mark all that apply)?”
<ol type="a">
<li>“Female”</li>
<li>“Male”</li>
<li>“Transgender”</li>
<li>“I use a different term [free-text]”</li>
</ol></li>
</ul>
<p>Again, this is an evolving area and best practice is likely to change.</p>
<p>Finally, returning to the reason for doing surveys in the first place, while doing all this, it is important to also keep what we are interested in measuring in mind. Check that the survey questions relate to the estimand.</p>
<section id="democracy-fund-voter-study-group" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="democracy-fund-voter-study-group"><span class="header-section-number">8.3.1</span> Democracy Fund Voter Study Group</h3>
<p>As an example of survey data, we will consider the Democracy Fund Voter Study Group Nationscape dataset <span class="citation" data-cites="nationscapedataset">(<a href="99-references.html#ref-nationscapedataset" role="doc-biblioref">Tausanovitch and Vavreck 2021</a>)</span>. This is a large series of surveys conducted between July 2019 and January 2021. It is weighted on a number of variables including: gender, major census regions, race, Hispanic ethnicity, household income, education, and age. <span class="citation" data-cites="nationscape2021">Holliday et al. (<a href="99-references.html#ref-nationscape2021" role="doc-biblioref">2021</a>)</span> describe it as a convenience sample, which was introduced in <a href="06-farm.html"><span>Chapter&nbsp;6</span></a>, based on demographics. In this case, <span class="citation" data-cites="nationscape2021">Holliday et al. (<a href="99-references.html#ref-nationscape2021" role="doc-biblioref">2021</a>)</span> detail how the sample was provided by Lucid, who operate an online platform for survey respondents, based on certain demographic quotas. <span class="citation" data-cites="nationscape2021">Holliday et al. (<a href="99-references.html#ref-nationscape2021" role="doc-biblioref">2021</a>)</span> found that results are similar to government and commercial surveys.</p>
<p>To get the dataset, go to the Democracy Fund Voter Study Group <a href="https://www.voterstudygroup.org">website</a>, then look for “Nationscape” and request access to the data. This could take a day or two. After getting access, focus on the “.dta” files. Nationscape conducted many surveys in the lead-up to the 2020 United States election, so there are many files. The filename is the reference date, where “ns20200625” refers to 25 June 2020. That is the file that we use here, but many of them are similar. We download and save it as “ns20200625.dta”.</p>
<p>As introduced in <a href="20-r_essentials.html">Online Appendix&nbsp;<span>A</span></a>, we can import “.dta” files after installing <code>haven</code> and <code>labelled</code>. The code that we use to import and prepare the survey dataset is based on that of <span class="citation" data-cites="greatstudentwork">Mitrovski, Yang, and Wankiewicz (<a href="99-references.html#ref-greatstudentwork" role="doc-biblioref">2020</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>raw_nationscape_data <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_dta</span>(<span class="st">"ns20200625.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Stata format separates labels so reunite those</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>raw_nationscape_data <span class="ot">&lt;-</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_factor</span>(raw_nationscape_data)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Just keep relevant variables</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>nationscape_data <span class="ot">&lt;-</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  raw_nationscape_data <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vote_2020, gender, education, state, age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nationscape_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,479 × 5
   vote_2020                gender education                         state   age
 * &lt;fct&gt;                    &lt;fct&gt;  &lt;fct&gt;                             &lt;chr&gt; &lt;dbl&gt;
 1 Donald Trump             Female Associate Degree                  WI       49
 2 I am not sure/don't know Female College Degree (such as B.A., B.… VA       39
 3 Donald Trump             Female College Degree (such as B.A., B.… VA       46
 4 Donald Trump             Female High school graduate              TX       75
 5 Donald Trump             Female High school graduate              WA       52
 6 I would not vote         Female Other post high school vocationa… OH       44
 7 Joe Biden                Female Completed some college, but no d… MA       21
 8 Joe Biden                Female Completed some college, but no d… TX       38
 9 Donald Trump             Female Completed some college, but no d… CA       69
10 Donald Trump             Female College Degree (such as B.A., B.… NC       59
# ℹ 6,469 more rows</code></pre>
</div>
</div>
<p>At this point we want to clean up a few issues. For instance, for simplicity, remove anyone not voting for Trump or Biden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nationscape_data <span class="ot">&lt;-</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  nationscape_data <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vote_2020 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Joe Biden"</span>, <span class="st">"Donald Trump"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vote_biden =</span> <span class="fu">if_else</span>(vote_2020 <span class="sc">==</span> <span class="st">"Joe Biden"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>vote_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then want to create some variables of interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nationscape_data <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  nationscape_data <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;=</span> <span class="dv">29</span> <span class="sc">~</span> <span class="st">"18-29"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;=</span> <span class="dv">44</span> <span class="sc">~</span> <span class="st">"30-44"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;=</span> <span class="dv">59</span> <span class="sc">~</span> <span class="st">"45-59"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"60+"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Trouble"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Female"</span> <span class="sc">~</span> <span class="st">"female"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Male"</span> <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Trouble"</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">education_level =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      education <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"3rd Grade or less"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Middle School - Grades 4 - 8"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Completed some high school"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"High school graduate"</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">~</span> <span class="st">"High school or less"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>      education <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Other post high school vocational training"</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Completed some college, but no degree"</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">~</span> <span class="st">"Some post sec"</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>      education <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Associate Degree"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"College Degree (such as B.A., B.S.)"</span>,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Completed some graduate, but no degree"</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">~</span> <span class="st">"Post sec +"</span>,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>      education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Masters degree"</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Doctorate degree"</span>) <span class="sc">~</span> <span class="st">"Grad degree"</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Trouble"</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>education,<span class="sc">-</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will draw on this dataset in <a href="15-mrp.html"><span>Chapter&nbsp;15</span></a>, so we will save it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="at">x =</span> nationscape_data,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"nationscape_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also have a look at some of the variables (<a href="#fig-nationscapesurveydataquickgraph">Figure&nbsp;<span>8.2</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nationscape_data <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">supports =</span> <span class="fu">if_else</span>(vote_biden <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Biden"</span>, <span class="st">"Trump"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">supports =</span> <span class="fu">factor</span>(supports, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Trump"</span>, <span class="st">"Biden"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">fill =</span> supports)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge2"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age-group of respondent"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of respondents"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Voted for"</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(gender)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">x =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nationscapesurveydataquickgraph" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="08-hunt_files/figure-html/fig-nationscapesurveydataquickgraph-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8.2: Examining some of the variables from the Nationscape survey dataset</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rct-examples" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="rct-examples"><span class="header-section-number">8.4</span> RCT examples</h2>
<section id="the-oregon-health-insurance-experiment" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="the-oregon-health-insurance-experiment"><span class="header-section-number">8.4.1</span> The Oregon Health Insurance Experiment</h3>
<p>In the United States, unlike many developed countries, basic health insurance is not necessarily available to all residents, even those on low incomes. The Oregon Health Insurance Experiment involved low-income adults in Oregon, a state in the northwest of the United States, from 2008 to 2010 <span class="citation" data-cites="finkelstein2012oregon">(<a href="99-references.html#ref-finkelstein2012oregon" role="doc-biblioref">Finkelstein et al. 2012</a>)</span>.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dr Amy Finkelstein is John &amp; Jennie S. Macdonald Professor of Economics at MIT. After earning a PhD in Economics from MIT in 2001, she was a Junior Fellow at the Harvard Society of Fellows, before returning to MIT as an assistant professor in 2005, being promoted to full professor in 2008. One area of her research is health economics where she uses randomized controlled trials to understand insurance. She was one of the lead researchers on <span class="citation" data-cites="finkelstein2012oregon">Finkelstein et al. (<a href="99-references.html#ref-finkelstein2012oregon" role="doc-biblioref">2012</a>)</span> which examined the Oregon Health Insurance Experiment. She was awarded the John Bates Clark Medal in 2012 and a MacArthur Foundation Fellowship in 2018.</p>
</div>
</div>
<p>Oregon funded 10,000 places in the state-run Medicaid program, which provides health insurance for people with low incomes. A lottery was used to allocate these places, and this was judged fair because it was expected, correctly as it turned out, that demand for places would exceed the supply. In the end, 89,824 individuals signed up.</p>
<p>The draws were conducted over a six-month period and 35,169 individuals were selected (the household of those who won the draw were given the opportunity) but only 30 per cent of them turned out to be eligible and completed the paperwork. The insurance lasted indefinitely. This random allocation of insurance allowed the researchers to understand the effect of health insurance.</p>
<p>The reason that this random allocation is important is that it is not usually possible to compare those with and without insurance because the type of people that sign up to get health insurance differ to those who do not. That decision is “confounded” with other variables and results in selection bias.</p>
<p>As the opportunity to apply for health insurance was randomly allocated, the researchers were able to evaluate the health and earnings of those who received health insurance and compare them to those who did not. To do this they used administrative data, such as hospital discharge data, matched credit reports, and, uncommonly, mortality records. The extent of this data is limited and so they also conducted a survey.</p>
<p>The specifics of this are not important, and we will have more to say in <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a>, but they estimate the model:</p>
<p><span id="eq-oregon"><span class="math display">\[
y_{ihj} = \beta_0 + \beta_1\mbox{Lottery} + X_{ih}\beta_2 + V_{ih}\beta_3 + \epsilon_{ihj}
\tag{8.1}\]</span></span></p>
<p><a href="#eq-oregon">Equation&nbsp;<span>8.1</span></a> explains various <span class="math inline">\(j\)</span> outcomes (such as health) for an individual <span class="math inline">\(i\)</span> in household <span class="math inline">\(h\)</span> as a function of an indicator variable as to whether household <span class="math inline">\(h\)</span> was selected by the lottery. It is the <span class="math inline">\(\beta_1\)</span> coefficient that is of particular interest. That is the estimate of the mean difference between the treatment and control groups. <span class="math inline">\(X_{ih}\)</span> is a set of variables that are correlated with the probability of being treated. These adjust for that impact to a certain extent. An example of that is the number of individuals in a household. And finally, <span class="math inline">\(V_{ih}\)</span> is a set of variables that are not correlated with the lottery, such as demographics and previous hospital discharges.</p>
<p>Like earlier studies such as <span class="citation" data-cites="randhealth">Brook et al. (<a href="99-references.html#ref-randhealth" role="doc-biblioref">1984</a>)</span>, <span class="citation" data-cites="finkelstein2012oregon">Finkelstein et al. (<a href="99-references.html#ref-finkelstein2012oregon" role="doc-biblioref">2012</a>)</span> found that the treatment group used more health care including both primary and preventive care as well as hospitalizations but had lower out-of-pocket medical expenditures. More generally, the treatment group reported better physical and mental health.</p>
</section>
<section id="civic-honesty-around-the-globe" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="civic-honesty-around-the-globe"><span class="header-section-number">8.4.2</span> Civic Honesty Around The Globe</h3>
<p>Trust is not something that we think regularly about, but it is fundamental to most interactions, both economic and personal. For instance, many people get paid after they do some work—they are trusting their employer will make good, and vice versa. If you get paid in advance, then they are trusting you. In a strictly naive, one-shot, world without transaction costs, this does not make sense. If you get paid in advance, the incentive is for you to take the money and run in the last pay period before you quit, and through backward induction everything falls apart. We do not live in such a world. For one thing there are transaction costs, for another, generally, we have repeated interactions, and finally, the world usually ends up being fairly small.</p>
<p>Understanding the extent of honesty in different countries may help us to explain economic development and other aspects of interest such as tax compliance, but it is hard to measure. We cannot ask people how honest they are—the liars would lie, resulting in a lemons problem <span class="citation" data-cites="akerlof1970market">(<a href="99-references.html#ref-akerlof1970market" role="doc-biblioref">Akerlof 1970</a>)</span>. This is a situation of adverse selection, where the liars know they are liars, but others do not. To get around this <span class="citation" data-cites="cohn2019civic">Cohn et al. (<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">2019a</a>)</span> conduct an experiment in 355 cities across 40 countries where they “turned in” a wallet that was either empty or contained the local equivalent of US$13.45. They were interested in whether the “recipient” attempted to return the wallet. They found that generally wallets with money were more likely to be returned <span class="citation" data-cites="cohn2019civic">(<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">Cohn et al. 2019a, 1</a>)</span>.</p>
<p>In total <span class="citation" data-cites="cohn2019civic">Cohn et al. (<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">2019a</a>)</span> “turn in” 17,303 wallets to various institutions including banks, museums, hotels, and police stations. The importance of such institutions to an economy is well accepted <span class="citation" data-cites="acemoglu2001colonial">(<a href="99-references.html#ref-acemoglu2001colonial" role="doc-biblioref">Acemoglu, Johnson, and Robinson 2001</a>)</span> and they are common across most countries. Importantly, for the experiment, they usually have a reception area where the wallet could be turned in <span class="citation" data-cites="cohn2019civic">(<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">Cohn et al. 2019a, 1</a>)</span>.</p>
<p>In the experiment a research assistant turned in the wallet to an employee at the reception area, using a set form of words. The research assistant had to note various features of the setting, such as the gender, age-group, and busyness of the “recipient”. The wallets were transparent and contained a key, a grocery list, and a business card with a name and email address. The outcome of interest was whether an email was sent to the unique email address on the business card in the wallet. The grocery list was included to signal that the owner of the wallet was a local. The key was included as something that was only useful to the owner of the wallet, and never the recipient, in contrast to the cash, to adjust for altruism. The language and currency were adapted to local conditions.</p>
<p>The primary treatment in the experiment is whether the wallet contained money or not. The key outcome was whether the wallet was attempted to be returned or not. It was found that the median response time was 26 minutes, and that if an email was sent then it usually happened within a day <span class="citation" data-cites="cohn2019civicaddendum">(<a href="99-references.html#ref-cohn2019civicaddendum" role="doc-biblioref">Cohn et al. 2019b, 10</a>)</span>.</p>
<p>Using the data for the paper that is made available <span class="citation" data-cites="walletsdata">(<a href="99-references.html#ref-walletsdata" role="doc-biblioref">Cohn 2019</a>)</span> we can see that considerable differences were found between countries (<a href="#fig-wallets">Figure&nbsp;<span>8.3</span></a>). In almost all countries wallets with money were more likely to be returned than wallets without. The experiments were conducted across 40 countries, which were chosen based on them having enough cities with populations of at least 100,000, as well as the ability for the research assistants to safely visit and withdraw cash. Within those countries, the cities were chosen starting with the largest ones and there were usually 400 observations in each country <span class="citation" data-cites="cohn2019civicaddendum">(<a href="99-references.html#ref-cohn2019civicaddendum" role="doc-biblioref">Cohn et al. 2019b, 5</a>)</span>. <span class="citation" data-cites="cohn2019civic">Cohn et al. (<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">2019a</a>)</span> further conducted the experiment with the equivalent of US$94.15 in three countries—Poland, the UK, and the US—and found that reporting rates further increased.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-wallets" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="08-hunt_files/figure-html/fig-wallets-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8.3: Comparison of the proportion of wallets handed in, by country, depending on whether they contained money</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In addition to the experiments, <span class="citation" data-cites="cohn2019civic">Cohn et al. (<a href="99-references.html#ref-cohn2019civic" role="doc-biblioref">2019a</a>)</span> conducted surveys that allowed them to understand some reasons for their findings. During the survey, participants were given one of the scenarios and then asked to answer questions. The use of surveys also allowed them to be specific about the respondents. The survey involved 2,525 respondents (829 in the UK, 809 in Poland, and 887 in the US) <span class="citation" data-cites="cohn2019civicaddendum">(<a href="99-references.html#ref-cohn2019civicaddendum" role="doc-biblioref">Cohn et al. 2019b, 36</a>)</span>. Participants were chosen using attention checks and demographic quotas based on age, gender, and residence, and they received US$4.00 for their participation <span class="citation" data-cites="cohn2019civicaddendum">(<a href="99-references.html#ref-cohn2019civicaddendum" role="doc-biblioref">Cohn et al. 2019b, 36</a>)</span>. The survey did not find that larger rewards were expected for turning in a wallet with more money. But it did find that failure to turn in a wallet with more money caused the respondent to feel more like they had stolen money.</p>
</section>
</section>
<section id="ab-testing" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="ab-testing"><span class="header-section-number">8.5</span> A/B testing</h2>
<p>The past two decades have probably seen the most experiments ever run, likely by several orders of magnitude. This is because of the extensive use of A/B testing at tech firms <span class="citation" data-cites="Kohavi2012">(<a href="99-references.html#ref-Kohavi2012" role="doc-biblioref">Kohavi et al. 2012</a>)</span>. For a long time decisions such as what font to use were based on the Highest Paid Person’s Opinion (HIPPO) <span class="citation" data-cites="abtestswired">(<a href="99-references.html#ref-abtestswired" role="doc-biblioref">Christian 2012</a>)</span>. These days, many large tech companies have extensive infrastructure for experiments. They term them A/B tests because of the comparison of two groups: one that gets treatment A and the other that either gets treatment B or does not see any change <span class="citation" data-cites="Salganik2018">(<a href="99-references.html#ref-Salganik2018" role="doc-biblioref">Salganik 2018, 185</a>)</span>. We could additionally consider more than two options at which point we typically use the terminology of “arms” of the experiment.</p>
<p>The proliferation of experiments in the private sector has brought with it a host of ethical concerns. Some private companies do not have ethical review boards, and there are different ethical concerns in the private sector compared with academia. For instance, many A/B tests are designed, explicitly, to make a consumer more likely to spend money. While society may not generally have a concern with that in the case of an online grocery retailer, society may have a problem in the case of an online gambling website. More extensive legislation and the development of private-sector ethical best practice are both likely as the extent of experimentation in the private sector becomes better known.</p>
<p>Every time you are online you are probably subject to tens, hundreds, or potentially thousands, of different A/B tests. While, at their heart, they are just experiments that use sensors to measure data that need to be analyzed, they have many special features that are interesting in their own light. For instance, <span class="citation" data-cites="kohavi">Kohavi, Tang, and Xu (<a href="99-references.html#ref-kohavi" role="doc-biblioref">2020, 3</a>)</span> discuss the example of Microsoft’s search engine Bing. They used A/B testing to examine how to display advertisements. Based on these tests they ended up lengthening the title on the advertisement. They found this caused revenue to increase by 12 per cent, or around $100 million annually, without any significant measured trade-off.</p>
<p>In this book we use the term A/B test to refer to the situation in which we primarily implement an experiment through a technology stack about something that is primarily of the internet, such as a change to a website or similar and measured with sensors rather than a survey. While at their heart they are just experiments, A/B tests have a range of specific concerns. <span class="citation" data-cites="Bosch2022">Bosch and Revilla (<a href="99-references.html#ref-Bosch2022" role="doc-biblioref">2022</a>)</span> detail some of these from a statistical perspective. There is something different about doing tens of thousands of small experiments all the time, compared with the typical RCT set-up of conducting one experiment over the course of months.</p>
<p>RCTs are often, though not exclusively, done in academia or by government agencies, but much of A/B testing occurs in industry. This means that if you are in industry and want to introduce A/B testing to your firm there can be aspects such as culture and relationship building that become important. It can be difficult to convince a manager to run an experiment. Indeed, sometimes it can be easier to experiment by not delivering, or delaying, a change that has been decided to create a control group rather than a treatment group <span class="citation" data-cites="Salganik2018">(<a href="99-references.html#ref-Salganik2018" role="doc-biblioref">Salganik 2018, 188</a>)</span>. Sometimes the most difficult aspect of A/B testing is not the analysis, it is the politics. This is not unique to A/B testing and, for instance, looking at the history of biology, we see that even aspects such as germ theory were not resolved by experiment, but instead by ideology and social standing <span class="citation" data-cites="morange">(<a href="99-references.html#ref-morange" role="doc-biblioref">Morange 2016, 124</a>)</span>.</p>
<p>Following <span class="citation" data-cites="kohavi">Kohavi, Tang, and Xu (<a href="99-references.html#ref-kohavi" role="doc-biblioref">2020, 153</a>)</span>, when conducting A/B testing, as with all experiments, we need to be concerned with delivery. In the case of an experiment, it is usually clear how it is being delivered. For instance, we may have the person come to a doctor’s clinic and then inject them with either a drug or a placebo. But in the case of A/B testing, it is less obvious. For instance, should we make a change to a website, or to an app? This decision affects our ability to both conduct the experiment and to gather data from it. (<span class="citation" data-cites="netflixabtesting">Urban, Sreenivasan, and Kannan (<a href="99-references.html#ref-netflixabtesting" role="doc-biblioref">2016</a>)</span> provide an overview of A/B testing at Netflix, assuming an app is installed on a PlayStation 4.)</p>
<p>It is relatively easy and normal to update a website all the time. This means that small changes can be easily implemented if the A/B test is delivered that way. But in the case of an app, conducting an A/B test becomes a bigger deal. For instance, the release may need to go through an app store, and so would need to be part of a regular release cycle. There is also a selection concern: some users will not update the app and it is possible they are different to those that do regularly update the app.</p>
<p>The delivery decision also affects our ability to gather data from the A/B test. A website change is less of a big deal because we get data from a website whenever a user interacts with it. But in the case of an app, the user may use the app offline or with limited data upload which can add complications.</p>
<p>We need to plan! For instance, results are unlikely to be available the day after a change to an app, but they could be available the day after a change to a website. Further, we may need to consider our results in the context of different devices and platforms, potentially using, say, regression which will be covered in <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a>.</p>
<p>The second aspect of concern, as introduced in <a href="06-farm.html"><span>Chapter&nbsp;6</span></a>, is instrumentation. When we conduct a traditional experiment we might, for instance, ask respondents to fill out a survey. But this is usually not done with A/B testing. Instead we usually use various sensors <span class="citation" data-cites="kohavi">(<a href="99-references.html#ref-kohavi" role="doc-biblioref">Kohavi, Tang, and Xu 2020, 162</a>)</span>. One approach is to use cookies but different types of users will clear these at different rates. Another approach is to force the user to download a tiny image from a server, so that we know when they have completed some action. For instance, this is commonly used to track whether a user has opened an email. But again different types of users will block these at different rates.</p>
<p>The third aspect of concern is what are we randomizing over <span class="citation" data-cites="kohavi">(<a href="99-references.html#ref-kohavi" role="doc-biblioref">Kohavi, Tang, and Xu 2020, 166</a>)</span>? In the case of traditional experiments, this is often a person, or sometimes various groups of people. But in the case of A/B testing it can be less clear. For instance, are we randomizing over the page, the session, or the user?</p>
<p>To think about this, let us consider color. For instance, say we are interested in whether we should change our logo from red to blue on the homepage. If we are randomizing at the page level, then if the user goes to some other page of our website, and then back to the homepage, the logo could change colors. If we are randomizing at the session level, then it could be blue while they use the website this time, if they close it and come back, then it could be red. Finally, if we are randomizing at a user level then possibly it would always be red for one user, but always blue for another.</p>
<p>The extent to which this matters depends on a trade-off between consistency and importance. For instance, if we are A/B testing product prices then consistency is likely an important feature. But if we are A/B testing background colors then consistency might not be as important. On the other hand, if we are A/B testing the position of a log-in button then it might be important that we not move that around too much for the one user, but between users it might matter less.</p>
<p>In A/B testing, as in traditional experiments, we are concerned that our treatment and control groups are the same, but for the treatment. In the case of traditional experiments, we satisfy ourselves of this by conducting analysis based on the data that we have after the experiment is conducted. That is usually all we can do because it would be weird to treat or control both groups. But in the case of A/B testing, the pace of experimentation allows us to randomly create the treatment and control groups, and then check, before we subject the treatment group to the treatment, that the groups are the same. For instance, if we were to show each group the same website, then we would expect the same outcomes across the two groups. If we found different outcomes then we would know that we may have a randomization issue <span class="citation" data-cites="taddy2019">(<a href="99-references.html#ref-taddy2019" role="doc-biblioref">Taddy 2019, 129</a>)</span>. This is termed an A/A test and was mentioned in <a href="04-writing_research.html"><span>Chapter&nbsp;4</span></a>.</p>
<p>We usually run A/B tests not because we desperately care about the specific outcome, but because that feeds into some other measure that we care about. For instance, do we care whether the website is quite-dark-blue or slightly-dark-blue? Probably not. We probably actually care a lot about the company share price. But what if the A/B test outcome of what is the best blue comes at a cost to the share price?</p>
<p>To illustrate this, pretend that we work at a food delivery app, and we are concerned with driver retention. Say we do some A/B tests and find that drivers are always more likely to be retained when they can deliver food to the customer faster. Our hypothetical finding is that faster is better, for driver retention, always. But one way to achieve faster deliveries is for the driver to not put the food into a hot box that would maintain the food’s temperature. Something like that might save 30 seconds, which is significant on a ten-minute delivery. Unfortunately, although we would decide to encourage that based on A/B tests designed to optimize driver-retention, such a decision would likely make the customer experience worse. If customers receive cold food that is meant to be hot, then they may stop using the app, which would be bad for the business. <span class="citation" data-cites="fbdiscoverslongterm">Chen et al. (<a href="99-references.html#ref-fbdiscoverslongterm" role="doc-biblioref">2022</a>)</span> describe how they found a similar situation at Facebook in terms of notifications—although reducing the number of notifications reduced user engagement in the short-term, over the long-term it increased both user satisfaction and app usage.</p>
<p>This trade-off could become known during the hypothetical driver experiment if we were to look at customer complaints. It is possible that on a small team the A/B test analyst would be exposed to those tickets, but on a larger team they may not be. Ensuring that A/B tests are not resulting in false optimization is especially important. This is not something that we typically have to worry about in normal experiments. As another example of this <span class="citation" data-cites="duolingo">Aprameya (<a href="99-references.html#ref-duolingo" role="doc-biblioref">2020</a>)</span> describes testing a feature of Duolingo, a language-learning application, which served an ad for Duolingo Plus when a regular Duolingo user was offline. The feature was found to be positive for Duolingo’s revenue, but negative for customer learning habits. Presumably enough customer negativity would eventually have resulted in the feature having a negative effect on revenue. Related to this, we want to think carefully about the nature of the result that we expect. For instance, in the shades of blues example, we are unlikely to find substantial surprises, and so it might be sufficient to try a small range of blues. But what if we considered a wider variety of colors?</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dr Susan Athey is the Economics of Technology Professor at Stanford University. After earning a PhD in Economics from Stanford in 1995, she joined MIT as an assistant professor, returning to Stanford in 2001, where she was promoted to full professor in 2004. One area of her research is applied economics, and one particularly important paper is <span class="citation" data-cites="Abadie2017">Abadie et al. (<a href="99-references.html#ref-Abadie2017" role="doc-biblioref">2017</a>)</span>, which considers when standard errors need to be clustered. Another is <span class="citation" data-cites="Athey2017">Athey and Imbens (<a href="99-references.html#ref-Athey2017" role="doc-biblioref">2017a</a>)</span>, which considers how to analyze randomized experiments. In addition to her academic appointments, she has worked at Microsoft and other technology firms and been extensively involved in running experiments in this context. She was awarded the John Bates Clark Medal in 2007.</p>
</div>
</div>
<section id="upworthy" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="upworthy"><span class="header-section-number">8.5.1</span> Upworthy</h3>
<p>The trouble with much of A/B testing is that it is done by private firms and so we typically do not have access to their datasets. But <span class="citation" data-cites="upworthy">Matias et al. (<a href="99-references.html#ref-upworthy" role="doc-biblioref">2021</a>)</span> provide access to a dataset of A/B tests from Upworthy, a media website that used A/B testing to optimize their content. <span class="citation" data-cites="aboutupworthy">Fitts (<a href="99-references.html#ref-aboutupworthy" role="doc-biblioref">2014</a>)</span> provides more background information about Upworthy. And the datasets of A/B tests are available <a href="https://osf.io/jd64p/">here</a>.</p>
<p>We can look at what the dataset looks like and get a sense for it by looking at the names and an extract.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>upworthy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://osf.io/vy8mj/download"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>upworthy <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "...1"                 "created_at"           "updated_at"          
 [4] "clickability_test_id" "excerpt"              "headline"            
 [7] "lede"                 "slug"                 "eyecatcher_id"       
[10] "impressions"          "clicks"               "significance"        
[13] "first_place"          "winner"               "share_text"          
[16] "square"               "test_week"           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>upworthy <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 17
   ...1 created_at          updated_at          clickability_test_id     excerpt
  &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;                    &lt;chr&gt;  
1     0 2014-11-20 06:43:16 2016-04-02 16:33:38 546d88fb84ad38b2ce000024 Things…
2     1 2014-11-20 06:43:44 2016-04-02 16:25:54 546d88fb84ad38b2ce000024 Things…
3     2 2014-11-20 06:44:59 2016-04-02 16:25:54 546d88fb84ad38b2ce000024 Things…
4     3 2014-11-20 06:54:36 2016-04-02 16:25:54 546d902c26714c6c44000039 Things…
5     4 2014-11-20 06:54:57 2016-04-02 16:31:45 546d902c26714c6c44000039 Things…
6     5 2014-11-20 06:55:07 2016-04-02 16:25:54 546d902c26714c6c44000039 Things…
# ℹ 12 more variables: headline &lt;chr&gt;, lede &lt;chr&gt;, slug &lt;chr&gt;,
#   eyecatcher_id &lt;chr&gt;, impressions &lt;dbl&gt;, clicks &lt;dbl&gt;, significance &lt;dbl&gt;,
#   first_place &lt;lgl&gt;, winner &lt;lgl&gt;, share_text &lt;chr&gt;, square &lt;chr&gt;,
#   test_week &lt;dbl&gt;</code></pre>
</div>
</div>
<p>It is also useful to look at the documentation for the dataset. This describes the structure of the dataset, which is that there are packages within tests. A package is a collection of headlines and images that were shown randomly to different visitors to the website, as part of a test. A test can include many packages. Each row in the dataset is a package and the test that it is part of is specified by the “clickability_test_id” column.</p>
<p>There are many variables. We will focus on:</p>
<ul>
<li>“created_at”;</li>
<li>“clickability_test_id”, so that we can create comparison groups;</li>
<li>“headline”;</li>
<li>“impressions”, which is the number of people that saw the package; and</li>
<li>“clicks” which is the number of clicks on that package.</li>
</ul>
<p>Within each batch of tests, we are interested in the effect of the varied headlines on impressions and clicks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>upworthy_restricted <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  upworthy <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    created_at, clickability_test_id, headline, impressions, clicks</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(upworthy_restricted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  created_at          clickability_test_id     headline       impressions clicks
  &lt;dttm&gt;              &lt;chr&gt;                    &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;
1 2014-11-20 06:43:16 546d88fb84ad38b2ce000024 They're Being…        3052    150
2 2014-11-20 06:43:44 546d88fb84ad38b2ce000024 They're Being…        3033    122
3 2014-11-20 06:44:59 546d88fb84ad38b2ce000024 They're Being…        3092    110
4 2014-11-20 06:54:36 546d902c26714c6c44000039 This Is What …        3526     90
5 2014-11-20 06:54:57 546d902c26714c6c44000039 This Is What …        3506    120
6 2014-11-20 06:55:07 546d902c26714c6c44000039 This Is What …        3380     98</code></pre>
</div>
</div>
<p>We will focus on the text contained in headlines, and look at whether headlines that asked a question got more clicks than those that did not. We want to remove the effect of different images and so will focus on those tests that have the same image. To identify whether a headline asks a question, we search for a question mark. Although there are more complicated constructions that we could use, this is enough to get started.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>upworthy_restricted <span class="ot">&lt;-</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  upworthy_restricted <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">asks_question =</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="at">string =</span> headline, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">?"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>upworthy_restricted <span class="sc">|&gt;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(asks_question)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  asks_question     n
  &lt;lgl&gt;         &lt;int&gt;
1 FALSE         19130
2 TRUE           3536</code></pre>
</div>
</div>
<p>For every test, and for every picture, we want to know whether asking a question affected the number of clicks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>question_or_not <span class="ot">&lt;-</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  upworthy_restricted <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ave_clicks =</span> <span class="fu">mean</span>(clicks),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(clickability_test_id, asks_question)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>question_or_not <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> asks_question,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> ave_clicks,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"ave_clicks_"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(ave_clicks_FALSE, ave_clicks_TRUE) <span class="sc">|&gt;</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference_in_clicks =</span> ave_clicks_TRUE <span class="sc">-</span> ave_clicks_FALSE) <span class="sc">|&gt;</span> </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average_differce =</span> <span class="fu">mean</span>(difference_in_clicks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  average_differce
             &lt;dbl&gt;
1            -4.89</code></pre>
</div>
</div>
<p>We could also consider a cross-tab (<a href="#tbl-datasummaryupworthy">Table&nbsp;<span>8.4</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>question_or_not <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(ave_clicks),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> asks_question) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Asks a question?"</span>, <span class="st">"Mean clicks"</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">0</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-datasummaryupworthy" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;8.4: Difference between the average number of clicks</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Asks a question?</th>
<th style="text-align: right;">Mean clicks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">44</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We find that in general, having a question in the headline may slightly decrease the number of clicks on a headline, although if there is an effect it does not appear to be very large (<a href="#fig-upworthy">Figure&nbsp;<span>8.4</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-upworthy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="08-hunt_files/figure-html/fig-upworthy-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8.4: Comparison of the average number of clicks when a headline contains a question mark or not</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">8.6</span> Exercises</h2>
<section id="scales" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="scales">Scales</h3>
<ol type="1">
<li><em>(Plan)</em> Consider the following scenario: <em>A political candidate is interested in how two polling values change over the course of an election campaign: approval rating and vote-share. The two are measured as percentages, and are somewhat correlated. There tends to be large changes when there is a debate between candidates.</em> Please sketch what that dataset could look like and then sketch a graph that you could build to show all observations.</li>
<li><em>(Simulate)</em> Please further consider the scenario described and simulate the situation. Please include five tests based on the simulated data. Submit a link to a GitHub Gist that contains your code.</li>
<li><em>(Acquire)</em> Please identify and document a possible source of such a dataset.</li>
<li><em>(Explore)</em> Please use <code>ggplot2</code> to build the graph that you sketched using the simulated data. Submit a link to a GitHub Gist that contains your code.</li>
<li><em>(Communicate)</em> Please write two paragraphs about what you did.</li>
</ol>
</section>
<section id="questions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="questions">Questions</h3>
<ol type="1">
<li>In your own words, what is the fundamental problem of causal inference (write at least three paragraphs and include both examples and references)?</li>
<li>In your own words, what is the role of randomization in constructing a counterfactual (write at least three paragraphs and include both examples and references)?</li>
<li>What is external validity (pick one)?
<ol type="a">
<li>Findings from an experiment hold in that setting.</li>
<li>Findings from an experiment hold outside that setting.</li>
<li>Findings from an experiment that has been repeated many times.</li>
<li>Findings from an experiment for which code and data are available.</li>
</ol></li>
<li>What is internal validity (pick one)?
<ol type="a">
<li>Findings from an experiment hold in that setting.</li>
<li>Findings from an experiment hold outside that setting.</li>
<li>Findings from an experiment that has been repeated many times.</li>
<li>Findings from an experiment for which code and data are available.</li>
</ol></li>
<li>Please write some code for the following dataset that would randomly assign people into one of two groups.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>netflix_data <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">person =</span> <span class="fu">c</span>(<span class="st">"Ian"</span>, <span class="st">"Ian"</span>, <span class="st">"Roger"</span>, <span class="st">"Roger"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Roger"</span>, <span class="st">"Patricia"</span>, <span class="st">"Patricia"</span>, <span class="st">"Helen"</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_show =</span> <span class="fu">c</span>(</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Broadchurch"</span>, <span class="st">"Duty-Shame"</span>, <span class="st">"Broadchurch"</span>, <span class="st">"Duty-Shame"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Shetland"</span>, <span class="st">"Broadchurch"</span>, <span class="st">"Shetland"</span>, <span class="st">"Duty-Shame"</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">hours =</span> <span class="fu">c</span>(<span class="fl">6.8</span>, <span class="fl">8.0</span>, <span class="fl">0.8</span>, <span class="fl">9.2</span>, <span class="fl">3.2</span>, <span class="fl">4.0</span>, <span class="fl">0.2</span>, <span class="fl">10.2</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>How could you check that your randomization had been done appropriately (write at least three paragraphs and include both examples and references)?</li>
<li>Pretend that you work as a junior analyst for a large consulting firm. Further, pretend that your consulting firm has taken a contract to put together a facial recognition model for a government border security department. Write at least three paragraphs, with examples and references, discussing your thoughts, with regard to ethics, on this matter.</li>
<li><span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989, 299</a>)</span> mentions “randomized-consent” and continues that it was “attractive in this setting because a standard approach to informed consent would require that parents of infants near death be approached to give informed consent for an invasive surgical procedure that would then, in some instances, not be administered. Those familiar with the agonizing experience of having a child in a neonatal intensive care unit can appreciate that the process of obtaining informed consent would be both frightening and stressful to parents.” To what extent do you agree with this position, especially given, as <span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989, 305</a>)</span>, mentions “the need to withhold information about the study from parents of infants receiving Conventional Medical Therapy (CMT)”?</li>
<li><span class="citation" data-cites="ware1989investigating">Ware (<a href="99-references.html#ref-ware1989investigating" role="doc-biblioref">1989, 300</a>)</span> mentions “equipoise”. In your own words, could you please define and discuss it (write at least three paragraphs and include both examples and references)?</li>
<li>Please redo the Upworthy analysis, but for “!” instead of “?”. What is the difference in clicks?
<ol type="a">
<li>-8.3</li>
<li>-7.2</li>
<li>-4.5</li>
<li>-5.6</li>
</ol></li>
</ol>
</section>
<section id="tutorial" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="tutorial">Tutorial</h3>
<p>Please consider the <a href="https://academic.oup.com/jssam/pages/special-virtual-issue-on-nonresponse-rates-and-nonresponse-adjustments">Special Virtual Issue on Nonresponse Rates and Nonresponse Adjustments</a> of the <em>Journal of Survey Statistics and Methodology</em>. Focus on one aspect of the editorial, and with reference to relevant literature, please discuss it in at least two pages. Use Quarto, and include an appropriate title, author, date, link to a GitHub repo, and citations. Submit a PDF.</p>
</section>
<section id="paper" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="paper">Paper</h3>
<p>At about this point the <em>Howrah</em> Paper from <a href="23-assessment.html">Online Appendix&nbsp;<span>D</span></a> would be appropriate.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Abadie2017" class="csl-entry" role="listitem">
Abadie, Alberto, Susan Athey, Guido Imbens, and Jeffrey Wooldridge. 2017. <span>“When Should You Adjust Standard Errors for Clustering?”</span> Working Paper 24003. Working Paper Series. National Bureau of Economic Research. <a href="https://doi.org/10.3386/w24003">https://doi.org/10.3386/w24003</a>.
</div>
<div id="ref-acemoglu2001colonial" class="csl-entry" role="listitem">
Acemoglu, Daron, Simon Johnson, and James Robinson. 2001. <span>“The Colonial Origins of Comparative Development: An Empirical Investigation.”</span> <em><span>American Economic Review</span></em> 91 (5): 1369–1401. <a href="https://doi.org/10.1257/aer.91.5.1369">https://doi.org/10.1257/aer.91.5.1369</a>.
</div>
<div id="ref-akerlof1970market" class="csl-entry" role="listitem">
Akerlof, George. 1970. <span>“The Market for <span>‘Lemons’</span>: Quality Uncertainty and the Market Mechanism.”</span> <em>The Quarterly Journal of Economics</em> 84 (3): 488–500. <a href="https://doi.org/10.2307/1879431">https://doi.org/10.2307/1879431</a>.
</div>
<div id="ref-alsan2021beyond" class="csl-entry" role="listitem">
Alsan, Marcella, and Amy Finkelstein. 2021. <span>“Beyond Causality: Additional Benefits of Randomized Controlled Trials for Improving Health Care Delivery.”</span> <em>The Milbank Quarterly</em> 99 (4): 864–81. <a href="https://doi.org/10.1111/1468-0009.12521">https://doi.org/10.1111/1468-0009.12521</a>.
</div>
<div id="ref-tuskegeeandthehealthofblackmen" class="csl-entry" role="listitem">
Alsan, Marcella, and Marianne Wanamaker. 2018. <span>“Tuskegee and the Health of Black Men.”</span> <em>The Quarterly Journal of Economics</em> 133 (1): 407–55. <a href="https://doi.org/10.1093/qje/qjx029">https://doi.org/10.1093/qje/qjx029</a>.
</div>
<div id="ref-angrist2010credibility" class="csl-entry" role="listitem">
Angrist, Joshua, and Jörn-Steffen Pischke. 2010. <span>“The Credibility Revolution in Empirical Economics: How Better Research Design Is Taking the Con Out of Econometrics.”</span> <em>Journal of Economic Perspectives</em> 24 (2): 3–30. <a href="https://doi.org/10.1257/jep.24.2.3">https://doi.org/10.1257/jep.24.2.3</a>.
</div>
<div id="ref-duolingo" class="csl-entry" role="listitem">
Aprameya, Lavanya. 2020. <span>“Improving Duolingo, One Experiment at a Time.”</span> <em>Duolingo Blog</em>, January. <a href="https://blog.duolingo.com/improving-duolingo-one-experiment-at-a-time/">https://blog.duolingo.com/improving-duolingo-one-experiment-at-a-time/</a>.
</div>
<div id="ref-Athey2017" class="csl-entry" role="listitem">
Athey, Susan, and Guido Imbens. 2017a. <span>“The Econometrics of Randomized Experiments.”</span> In <em>Handbook of Field Experiments</em>, 73–140. Elsevier. <a href="https://doi.org/10.1016/bs.hefe.2016.10.003">https://doi.org/10.1016/bs.hefe.2016.10.003</a>.
</div>
<div id="ref-athey2017state" class="csl-entry" role="listitem">
———. 2017b. <span>“The State of Applied Econometrics: Causality and Policy Evaluation.”</span> <em>Journal of Economic Perspectives</em> 31 (2): 3–32. <a href="https://doi.org/10.1257/jep.31.2.3">https://doi.org/10.1257/jep.31.2.3</a>.
</div>
<div id="ref-pooreconomics" class="csl-entry" role="listitem">
Banerjee, Abhijit, and Esther Duflo. 2011. <em>Poor Economics: A Radical Rethinking of the Way to Fight Global Poverty</em>. New York: PublicAffairs.
</div>
<div id="ref-banerjee2015miracle" class="csl-entry" role="listitem">
Banerjee, Abhijit, Esther Duflo, Rachel Glennerster, and Cynthia Kinnan. 2015. <span>“The Miracle of Microfinance? Evidence from a Randomized Evaluation.”</span> <em>American Economic Journal: Applied Economics</em> 7 (1): 22–53. <a href="https://doi.org/10.1257/app.20130533">https://doi.org/10.1257/app.20130533</a>.
</div>
<div id="ref-berry1989investigating" class="csl-entry" role="listitem">
Berry, Donald. 1989. <span>“Comment: Ethics and ECMO.”</span> <em>Statistical Science</em> 4 (4): 306–10. <a href="https://www.jstor.org/stable/2245830">https://www.jstor.org/stable/2245830</a>.
</div>
<div id="ref-blair1977ask" class="csl-entry" role="listitem">
Blair, Ed, Seymour Sudman, Norman M Bradburn, and Carol Stocking. 1977. <span>“How to Ask Questions about Drinking and Sex: Response Effects in Measuring Consumer Behavior.”</span> <em>Journal of Marketing Research</em> 14 (3): 316–21. <a href="https://doi.org/10.2307/3150769">https://doi.org/10.2307/3150769</a>.
</div>
<div id="ref-Bosch2022" class="csl-entry" role="listitem">
Bosch, Oriol, and Melanie Revilla. 2022. <span>“<span class="nocase">When survey science met web tracking: Presenting an error framework for metered data</span>.”</span> <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, November, 1–29. <a href="https://doi.org/10.1111/rssa.12956">https://doi.org/10.1111/rssa.12956</a>.
</div>
<div id="ref-Bouguen2019" class="csl-entry" role="listitem">
Bouguen, Adrien, Yue Huang, Michael Kremer, and Edward Miguel. 2019. <span>“Using Randomized Controlled Trials to Estimate Long-Run Impacts in Development Economics.”</span> <em>Annual Review of Economics</em> 11 (1): 523–61. <a href="https://doi.org/10.1146/annurev-economics-080218-030333">https://doi.org/10.1146/annurev-economics-080218-030333</a>.
</div>
<div id="ref-brandt1978racism" class="csl-entry" role="listitem">
Brandt, Allan. 1978. <span>“Racism and Research: The Case of the Tuskegee Syphilis Study.”</span> <em>Hastings Center Report</em>, 21–29. <a href="https://doi.org/10.2307/3561468">https://doi.org/10.2307/3561468</a>.
</div>
<div id="ref-randhealth" class="csl-entry" role="listitem">
Brook, Robert, John Ware, William Rogers, Emmett Keeler, Allyson Ross Davies, Cathy Sherbourne, George Goldberg, Kathleen Lohr, Patricia Camp, and Joseph Newhouse. 1984. <span>“The Effect of Coinsurance on the Health of Adults: Results from the RAND Health Insurance Experiment.”</span> <a href="https://www.rand.org/pubs/reports/R3055.html">https://www.rand.org/pubs/reports/R3055.html</a>.
</div>
<div id="ref-fbdiscoverslongterm" class="csl-entry" role="listitem">
Chen, Weijun, Yan Qi, Yuwen Zhang, Christina Brown, Akos Lada, and Harivardan Jayaraman. 2022. <span>“Notifications: Why Less Is More,”</span> December. <a href="https://medium.com/@AnalyticsAtMeta/notifications-why-less-is-more-how-facebook-has-been-increasing-both-user-satisfaction-and-app-9463f7325e7d">https://medium.com/@AnalyticsAtMeta/notifications-why-less-is-more-how-facebook-has-been-increasing-both-user-satisfaction-and-app-9463f7325e7d</a>.
</div>
<div id="ref-abtestswired" class="csl-entry" role="listitem">
Christian, Brian. 2012. <span>“<span class="nocase">The A/B Test: Inside the Technology That’s Changing the Rules of Business</span>.”</span> <em>Wired</em>, April. <a href="https://www.wired.com/2012/04/ff-abtesting/">https://www.wired.com/2012/04/ff-abtesting/</a>.
</div>
<div id="ref-walletsdata" class="csl-entry" role="listitem">
Cohn, Alain. 2019. <span>“<span class="nocase">Data and code for: Civic Honesty Around the Globe</span>.”</span> Harvard Dataverse. <a href="https://doi.org/10.7910/dvn/ykbodn">https://doi.org/10.7910/dvn/ykbodn</a>.
</div>
<div id="ref-cohn2019civic" class="csl-entry" role="listitem">
Cohn, Alain, Michel André Maréchal, David Tannenbaum, and Christian Lukas Zünd. 2019a. <span>“Civic Honesty Around the Globe.”</span> <em>Science</em> 365 (6448): 70–73. <a href="https://doi.org/10.1126/science.aau8712">https://doi.org/10.1126/science.aau8712</a>.
</div>
<div id="ref-cohn2019civicaddendum" class="csl-entry" role="listitem">
———. 2019b. <span>“Supplementary Materials for: Civic Honesty Around the Globe.”</span> <em>Science</em> 365 (6448): 70–73.
</div>
<div id="ref-Cunningham2021" class="csl-entry" role="listitem">
Cunningham, Scott. 2021. <em>Causal Inference: The Mixtape</em>. 1st ed. New Haven: Yale Press. <a href="https://mixtape.scunning.com">https://mixtape.scunning.com</a>.
</div>
<div id="ref-Deaton2010" class="csl-entry" role="listitem">
Deaton, Angus. 2010. <span>“Instruments, Randomization, and Learning about Development.”</span> <em>Journal of Economic Literature</em> 48 (2): 424–55. <a href="https://doi.org/10.1257/jel.48.2.424">https://doi.org/10.1257/jel.48.2.424</a>.
</div>
<div id="ref-surveystailored" class="csl-entry" role="listitem">
Dillman, Don, Jolene Smyth, and Leah Christian. (1978) 2014. <em>Internet, Phone, Mail, and Mixed-Mode Surveys: The Tailored Design Method</em>. 4th ed. Wiley.
</div>
<div id="ref-Druckman2021" class="csl-entry" role="listitem">
Druckman, James, and Donald Green. 2021. <span>“A New Era of Experimental Political Science.”</span> In <em>Advances in Experimental Political Science</em>, 1–16. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/9781108777919.002">https://doi.org/10.1017/9781108777919.002</a>.
</div>
<div id="ref-Duflo2020" class="csl-entry" role="listitem">
Duflo, Esther. 2020. <span>“Field Experiments and the Practice of Policy.”</span> <em>American Economic Review</em> 110 (7): 1952–73. <a href="https://doi.org/10.1257/aer.110.7.1952">https://doi.org/10.1257/aer.110.7.1952</a>.
</div>
<div id="ref-Edelman2021Interview" class="csl-entry" role="listitem">
Edelman, Murray, Liberty Vittert, and Xiao-Li Meng. 2021. <span>“An Interview with Murray Edelman on the History of the Exit Poll.”</span> <em>Harvard Data Science Review</em> 3 (1). <a href="https://doi.org/10.1162/99608f92.3a25cd24">https://doi.org/10.1162/99608f92.3a25cd24</a>.
</div>
<div id="ref-blindpace" class="csl-entry" role="listitem">
Edwards, Jonathan. 2017. <span>“<span class="nocase">PACE team response shows a disregard for the principles of science</span>.”</span> <em>Journal of Health Psychology</em> 22 (9): 1155–58. <a href="https://doi.org/10.1177/1359105317700886">https://doi.org/10.1177/1359105317700886</a>.
</div>
<div id="ref-anchoringmethod" class="csl-entry" role="listitem">
Elliott, Michael, Brady West, Xinyu Zhang, and Stephanie Coffey. 2022. <span>“The Anchoring Method: Estimation of Interviewer Effects in the Absence of Interpenetrated Sample Assignment.”</span> <em>Survey Methodology</em> 48 (1): 25–48. <a href="http://www.statcan.gc.ca/pub/12-001-x/2022001/article/00005-eng.htm">http://www.statcan.gc.ca/pub/12-001-x/2022001/article/00005-eng.htm</a>.
</div>
<div id="ref-elson2016question" class="csl-entry" role="listitem">
Elson, Malte. 2018. <span>“Question Wording and Item Formulation.”</span> <a href="https://doi.org/10.31234/osf.io/e4ktc">https://doi.org/10.31234/osf.io/e4ktc</a>.
</div>
<div id="ref-whereyoursurveycomesfrom" class="csl-entry" role="listitem">
Enns, Peter, and Jake Rothschild. 2022. <span>“Do You Know Where Your Survey Data Come From?”</span> May. <a href="https://medium.com/3streams/surveys-3ec95995dde2">https://medium.com/3streams/surveys-3ec95995dde2</a>.
</div>
<div id="ref-finkelstein2012oregon" class="csl-entry" role="listitem">
Finkelstein, Amy, Sarah Taubman, Bill Wright, Mira Bernstein, Jonathan Gruber, Joseph Newhouse, Heidi Allen, Katherine Baicker, and Oregon Health Study Group. 2012. <span>“The Oregon Health Insurance Experiment: Evidence from the First Year.”</span> <em>The Quarterly Journal of Economics</em> 127 (3): 1057–1106. <a href="https://doi.org/10.1093/qje/qjs020">https://doi.org/10.1093/qje/qjs020</a>.
</div>
<div id="ref-fisherdesignofexperiments" class="csl-entry" role="listitem">
Fisher, Ronald. (1935) 1949. <em>The Design of Experiments</em>. 5th ed. London: Oliver; Boyd.
</div>
<div id="ref-aboutupworthy" class="csl-entry" role="listitem">
Fitts, Alexis Sobel. 2014. <span>“The King of Content: How Upworthy Aims to Alter the Web, and Could End up Altering the World.”</span> <em>Columbia Journalism Review</em> 53: 34–38. <a href="https://archives.cjr.org/feature/the%5Fking%5Fof%5Fcontent.php">https://archives.cjr.org/feature/the%5Fking%5Fof%5Fcontent.php</a>.
</div>
<div id="ref-fry2020big" class="csl-entry" role="listitem">
Fry, Hannah. 2020. <span>“Big Tech Is Testing You.”</span> <em>The New Yorker</em>, February, 61–65. <a href="https://www.newyorker.com/magazine/2020/03/02/big-tech-is-testing-you">https://www.newyorker.com/magazine/2020/03/02/big-tech-is-testing-you</a>.
</div>
<div id="ref-gertler2016impact" class="csl-entry" role="listitem">
Gertler, Paul, Sebastian Martinez, Patrick Premand, Laura Rawlings, and Christel Vermeersch. 2016. <em>Impact Evaluation in Practice</em>. 2nd ed. The World Bank. <a href="https://doi.org/10.1596/978-1-4648-0779-4">https://doi.org/10.1596/978-1-4648-0779-4</a>.
</div>
<div id="ref-closeenoughaintgoodenough" class="csl-entry" role="listitem">
Gordon, Brett, Robert Moakler, and Florian Zettelmeyer. 2022. <span>“Close Enough? A Large-Scale Exploration of Non-Experimental Approaches to Advertising Measurement.”</span> <em>Marketing Science</em>, November. <a href="https://doi.org/10.1287/mksc.2022.1413">https://doi.org/10.1287/mksc.2022.1413</a>.
</div>
<div id="ref-Gordon2019" class="csl-entry" role="listitem">
Gordon, Brett, Florian Zettelmeyer, Neha Bhargava, and Dan Chapsky. 2019. <span>“A Comparison of Approaches to Advertising Measurement: Evidence from Big Field Experiments at Facebook.”</span> <em>Marketing Science</em> 38 (2): 193–225. <a href="https://doi.org/10.1287/mksc.2018.1135">https://doi.org/10.1287/mksc.2018.1135</a>.
</div>
<div id="ref-Groves2011" class="csl-entry" role="listitem">
Groves, Robert. 2011. <span>“Three Eras of Survey Research.”</span> <em>Public Opinion Quarterly</em> 75 (5): 861–71. <a href="https://doi.org/10.1093/poq/nfr057">https://doi.org/10.1093/poq/nfr057</a>.
</div>
<div id="ref-hellertuskegee" class="csl-entry" role="listitem">
Heller, Jean. 2022. <span>“AP Exposes the Tuskegee Syphilis Study: The 50th Anniversary.”</span> <em>AP</em>, July. <a href="https://apnews.com/article/tuskegee-study-ap-story-investigation-syphilis-53403657e77d76f52df6c2e2892788c9">https://apnews.com/article/tuskegee-study-ap-story-investigation-syphilis-53403657e77d76f52df6c2e2892788c9</a>.
</div>
<div id="ref-hill1965environment" class="csl-entry" role="listitem">
Hill, Austin Bradford. 1965. <span>“The Environment and Disease: Association or Causation?”</span> <em>Proceedings of the Royal Society of Medicine</em> 58 (5): 295–300.
</div>
<div id="ref-holland1986statistics" class="csl-entry" role="listitem">
Holland, Paul. 1986. <span>“Statistics and Causal Inference.”</span> <em>Journal of the American Statistical Association</em> 81 (396): 945–60. <a href="https://doi.org/10.2307/2289064">https://doi.org/10.2307/2289064</a>.
</div>
<div id="ref-nationscape2021" class="csl-entry" role="listitem">
Holliday, Derek, Tyler Reny, Alex Rossell Hayes, Aaron Rudkin, Chris Tausanovitch, and Lynn Vavreck. 2021. <span>“<span class="nocase">Democracy Fund + UCLA Nationscape Methodology and Representativeness Assessment</span>.”</span>
</div>
<div id="ref-Kohavi2012" class="csl-entry" role="listitem">
Kohavi, Ron, Alex Deng, Brian Frasca, Roger Longbotham, Toby Walker, and Ya Xu. 2012. <span>“Trustworthy Online Controlled Experiments.”</span> In <em>Proceedings of the 18th <span>ACM</span> <span>SIGKDD</span> International Conference on Knowledge Discovery and Data Mining - <span>KDD</span> <span></span>12</em>, 1st ed. <span>ACM</span> Press. <a href="https://doi.org/10.1145/2339530.2339653">https://doi.org/10.1145/2339530.2339653</a>.
</div>
<div id="ref-kohavi" class="csl-entry" role="listitem">
Kohavi, Ron, Diane Tang, and Ya Xu. 2020. <em><span class="nocase">Trustworthy Online Controlled Experiments: A Practical Guide to A/B Testing</span></em>. Cambridge University Press.
</div>
<div id="ref-citelabelled" class="csl-entry" role="listitem">
Larmarange, Joseph. 2023. <em><span class="nocase">labelled: Manipulating Labelled Data</span></em>. <a href="https://CRAN.R-project.org/package=labelled">https://CRAN.R-project.org/package=labelled</a>.
</div>
<div id="ref-pewletterman" class="csl-entry" role="listitem">
Letterman, Clark. 2021. <span>“<span class="nocase">Q&amp;A: How Pew Research Center surveyed nearly 30,000 people in India</span>,”</span> July. <a href="https://medium.com/pew-research-center-decoded/q-a-how-pew-research-center-surveyed-nearly-30-000-people-in-india-7c778f6d650e">https://medium.com/pew-research-center-decoded/q-a-how-pew-research-center-surveyed-nearly-30-000-people-in-india-7c778f6d650e</a>.
</div>
<div id="ref-Levay2016" class="csl-entry" role="listitem">
Levay, Kevin, Jeremy Freese, and James Druckman. 2016. <span>“The Demographic and Political Composition of Mechanical Turk Samples.”</span> <em><span>SAGE</span> Open</em> 6 (1): 1–17. <a href="https://doi.org/10.1177/2158244016636433">https://doi.org/10.1177/2158244016636433</a>.
</div>
<div id="ref-Lichand2022" class="csl-entry" role="listitem">
Lichand, Guilherme, and Sharon Wolf. 2022. <span>“Measuring Child Labor: Whom Should Be Asked, and Why It Matters,”</span> March. <a href="https://doi.org/10.21203/rs.3.rs-1474562/v1">https://doi.org/10.21203/rs.3.rs-1474562/v1</a>.
</div>
<div id="ref-bydesignplanningresearch" class="csl-entry" role="listitem">
Light, Richard, Judith Singer, and John Willett. 1990. <em><span class="nocase">By Design: Planning Research on Higher Education</span></em>. 1st ed. Cambridge: Harvard University Press.
</div>
<div id="ref-upworthy" class="csl-entry" role="listitem">
Matias, Nathan, Kevin Munger, Marianne Aubin Le Quere, and Charles Ebersole. 2021. <span>“<span class="nocase">The Upworthy Research Archive, a time series of 32,487 experiments in U.S. media</span>.”</span> <em>Scientific Data</em> 8 (1): 1–8. <a href="https://doi.org/10.1038/s41597-021-00934-7">https://doi.org/10.1038/s41597-021-00934-7</a>.
</div>
<div id="ref-greatstudentwork" class="csl-entry" role="listitem">
Mitrovski, Alen, Xiaoyan Yang, and Matthew Wankiewicz. 2020. <span>“Joe Biden Projected to Win Popular Vote in 2020 US Election.”</span> <a href="https://github.com/matthewwankiewicz/US_election_forecast">https://github.com/matthewwankiewicz/US_election_forecast</a>.
</div>
<div id="ref-morange" class="csl-entry" role="listitem">
Morange, Michel. 2016. <em>A History of Biology</em>. New Jersey: Princeton University Press.
</div>
<div id="ref-obermeyer2019dissecting" class="csl-entry" role="listitem">
Obermeyer, Ziad, Brian Powers, Christine Vogeli, and Sendhil Mullainathan. 2019. <span>“Dissecting Racial Bias in an Algorithm Used to Manage the Health of Populations.”</span> <em>Science</em> 366 (6464): 447–53. <a href="https://doi.org/10.1126/science.aax2342">https://doi.org/10.1126/science.aax2342</a>.
</div>
<div id="ref-citeR" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Salganik2018" class="csl-entry" role="listitem">
Salganik, Matthew. 2018. <em>Bit by Bit: Social Research in the Digital Age</em>. New Jersey: Princeton University Press.
</div>
<div id="ref-yougovforthedefence" class="csl-entry" role="listitem">
Smith, Matthew. 2018. <span>“Should Milk Go in a Cup of Tea First or Last?”</span> July. <a href="https://yougov.co.uk/topics/consumer/articles-reports/2018/07/30/should-milk-go-cup-tea-first-or-last">https://yougov.co.uk/topics/consumer/articles-reports/2018/07/30/should-milk-go-cup-tea-first-or-last</a>.
</div>
<div id="ref-Stantcheva2023" class="csl-entry" role="listitem">
Stantcheva, Stefanie. 2023. <span>“How to Run Surveys: A Guide to Creating Your Own Identifying Variation and Revealing the Invisible.”</span> <em>Annual Review of Economics</em>. <a href="https://scholar.harvard.edu/files/stantcheva/files/How_to_run_surveys_Stantcheva.pdf">https://scholar.harvard.edu/files/stantcheva/files/How_to_run_surveys_Stantcheva.pdf</a>.
</div>
<div id="ref-stolberg2006inventing" class="csl-entry" role="listitem">
Stolberg, Michael. 2006. <span>“Inventing the Randomized Double-Blind Trial: The Nuremberg Salt Test of 1835.”</span> <em>Journal of the Royal Society of Medicine</em> 99 (12): 642–43. <a href="https://doi.org/10.1177/014107680609901216">https://doi.org/10.1177/014107680609901216</a>.
</div>
<div id="ref-Stolley1991" class="csl-entry" role="listitem">
Stolley, Paul. 1991. <span>“When Genius Errs: R. A. Fisher and the Lung Cancer Controversy.”</span> <em>American Journal of Epidemiology</em> 133 (5): 416–25. <a href="https://doi.org/10.1093/oxfordjournals.aje.a115904">https://doi.org/10.1093/oxfordjournals.aje.a115904</a>.
</div>
<div id="ref-surveydesign" class="csl-entry" role="listitem">
Swain, Larry. 1985. <span>“Basic Principles of Questionnaire Design.”</span> <em>Survey Methodology</em> 11 (2): 161–70.
</div>
<div id="ref-taddy2019" class="csl-entry" role="listitem">
Taddy, Matt. 2019. <em>Business Data Science</em>. 1st ed. McGraw Hill.
</div>
<div id="ref-nationscapedataset" class="csl-entry" role="listitem">
Tausanovitch, Chris, and Lynn Vavreck. 2021. <span>“<span>Democracy Fund + UCLA Nationscape Project</span>.”</span> <a href="https://www.voterstudygroup.org/data/nationscape">https://www.voterstudygroup.org/data/nationscape</a>.
</div>
<div id="ref-whitehousebestpractice" class="csl-entry" role="listitem">
The White House. 2023. <span>“Recommendations on the Best Practices for the Collection of Sexual Orientation and Gender Identity Data on Federal Statistical Survey,”</span> January. <a href="https://www.whitehouse.gov/wp-content/uploads/2023/01/SOGI-Best-Practices.pdf">https://www.whitehouse.gov/wp-content/uploads/2023/01/SOGI-Best-Practices.pdf</a>.
</div>
<div id="ref-tourangeau2000" class="csl-entry" role="listitem">
Tourangeau, Roger, Lance Rips, and Kenneth Rasinski. 2000. <em>The Psychology of Survey Response</em>. 1st ed. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511819322.003">https://doi.org/10.1017/CBO9780511819322.003</a>.
</div>
<div id="ref-netflixabtesting" class="csl-entry" role="listitem">
Urban, Steve, Rangarajan Sreenivasan, and Vineet Kannan. 2016. <span>“<span class="nocase">It’s All A/Bout Testing: The Netflix Experimentation Platform</span>.”</span> <em>Netflix Technology Blog</em>, April. <a href="https://netflixtechblog.com/its-all-a-bout-testing-the-netflix-experimentation-platform-4e1ca458c15">https://netflixtechblog.com/its-all-a-bout-testing-the-netflix-experimentation-platform-4e1ca458c15</a>.
</div>
<div id="ref-nationscapeuserguide" class="csl-entry" role="listitem">
Vavreck, Lynn, and Chris Tausanovitch. 2021. <span>“<span>Democracy Fund + UCLA Nationscape Project User Guide</span>.”</span> <a href="https://www.voterstudygroup.org/data/nationscape">https://www.voterstudygroup.org/data/nationscape</a>.
</div>
<div id="ref-ware1989investigating" class="csl-entry" role="listitem">
Ware, James. 1989. <span>“Investigating Therapies of Potentially Great Benefit: ECMO.”</span> <em>Statistical Science</em> 4 (4): 298–306. <a href="https://doi.org/10.1214/ss/1177012384">https://doi.org/10.1214/ss/1177012384</a>.
</div>
<div id="ref-wei1978randomized" class="csl-entry" role="listitem">
Wei, LJ, and S Durham. 1978. <span>“The Randomized Play-the-Winner Rule in Medical Trials.”</span> <em>Journal of the American Statistical Association</em> 73 (364): 840–43. <a href="https://doi.org/10.2307/2286290">https://doi.org/10.2307/2286290</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“<span class="nocase">Welcome to the Tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-citehaven" class="csl-entry" role="listitem">
Wickham, Hadley, Evan Miller, and Danny Smith. 2023. <em><span class="nocase">haven: Import and Export <span>“SPSS”</span> <span>“Stata”</span> and <span>“SAS”</span> Files</span></em>. <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a>.
</div>
<div id="ref-citeknitr" class="csl-entry" role="listitem">
Xie, Yihui. 2023. <em><span class="nocase">knitr: A General-Purpose Package for Dynamic Report Generation in R</span></em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-yaxu" class="csl-entry" role="listitem">
Xu, Ya. 2020. <span>“Causal Inference Challenges in Industry: A Perspective from Experiences at LinkedIn.”</span> <em>YouTube</em>, July. <a href="https://youtu.be/OoKsLAvyIYA">https://youtu.be/OoKsLAvyIYA</a>.
</div>
<div id="ref-yoshioka1998use" class="csl-entry" role="listitem">
Yoshioka, Alan. 1998. <span>“Use of Randomisation in the Medical Research Council’s Clinical Trial of Streptomycin in Pulmonary Tuberculosis in the 1940s.”</span> <em>BMJ</em> 317 (7167): 1220–23. <a href="https://doi.org/10.1136/bmj.317.7167.1220">https://doi.org/10.1136/bmj.317.7167.1220</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-gather.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Gather data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-clean_and_prepare.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Clean and prepare</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>