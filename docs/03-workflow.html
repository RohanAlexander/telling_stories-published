<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.266">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Telling Stories with Data - 3&nbsp; Reproducible workflows</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-writing_research.html" rel="next">
<link href="./02-drinking_from_a_fire_hose.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduction.html">Foundations</a></li><li class="breadcrumb-item"><a href="./03-workflow.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Telling Stories with Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RohanAlexander/telling_stories/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Telling stories with data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-drinking_from_a_fire_hose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Drinking from a fire hose</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-workflow.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-writing_research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-static_communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Static communication</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Acquisition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-farm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Farm data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-gather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Gather data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-hunt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hunt data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-clean_and_prepare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Clean and prepare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-store_and_share.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Store and share</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ijalm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-ijaglm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Generalized linear models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-causality_from_obs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Causality from observational data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mrp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multilevel regression with post-stratification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Text as data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-concluding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Concluding remarks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-r_essentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R essentials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Papers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Interaction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-datasheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Datasheets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">SQL essentials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Production</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29-activities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Class activities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./97-errata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Errata and updates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-cocktails.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Cocktails</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto"><span class="header-section-number">3.2</span> Quarto</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">3.2.1</span> Getting started</a></li>
  <li><a href="#top-matter" id="toc-top-matter" class="nav-link" data-scroll-target="#top-matter"><span class="header-section-number">3.2.2</span> Top matter</a></li>
  <li><a href="#essential-commands" id="toc-essential-commands" class="nav-link" data-scroll-target="#essential-commands"><span class="header-section-number">3.2.3</span> Essential commands</a></li>
  <li><a href="#r-chunks" id="toc-r-chunks" class="nav-link" data-scroll-target="#r-chunks"><span class="header-section-number">3.2.4</span> R chunks</a></li>
  <li><a href="#sec-equations" id="toc-sec-equations" class="nav-link" data-scroll-target="#sec-equations"><span class="header-section-number">3.2.5</span> Equations</a></li>
  <li><a href="#sec-quartocrossreferences" id="toc-sec-quartocrossreferences" class="nav-link" data-scroll-target="#sec-quartocrossreferences"><span class="header-section-number">3.2.6</span> Cross-references</a></li>
  </ul></li>
  <li><a href="#r-projects-and-file-structure" id="toc-r-projects-and-file-structure" class="nav-link" data-scroll-target="#r-projects-and-file-structure"><span class="header-section-number">3.3</span> R Projects and file structure</a></li>
  <li><a href="#version-control" id="toc-version-control" class="nav-link" data-scroll-target="#version-control"><span class="header-section-number">3.4</span> Version control</a>
  <ul class="collapse">
  <li><a href="#git" id="toc-git" class="nav-link" data-scroll-target="#git"><span class="header-section-number">3.4.1</span> Git</a></li>
  <li><a href="#github" id="toc-github" class="nav-link" data-scroll-target="#github"><span class="header-section-number">3.4.2</span> GitHub</a></li>
  </ul></li>
  <li><a href="#using-r-in-practice" id="toc-using-r-in-practice" class="nav-link" data-scroll-target="#using-r-in-practice"><span class="header-section-number">3.5</span> Using R in practice</a>
  <ul class="collapse">
  <li><a href="#sec-dealingwitherrors" id="toc-sec-dealingwitherrors" class="nav-link" data-scroll-target="#sec-dealingwitherrors"><span class="header-section-number">3.5.1</span> Dealing with errors</a></li>
  <li><a href="#sec-omgpleasemakeareprexplease" id="toc-sec-omgpleasemakeareprexplease" class="nav-link" data-scroll-target="#sec-omgpleasemakeareprexplease"><span class="header-section-number">3.5.2</span> Reproducible examples</a></li>
  <li><a href="#mentality" id="toc-mentality" class="nav-link" data-scroll-target="#mentality"><span class="header-section-number">3.5.3</span> Mentality</a></li>
  <li><a href="#code-comments-and-style" id="toc-code-comments-and-style" class="nav-link" data-scroll-target="#code-comments-and-style"><span class="header-section-number">3.5.4</span> Code comments and style</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests"><span class="header-section-number">3.5.5</span> Tests</a></li>
  </ul></li>
  <li><a href="#efficiency" id="toc-efficiency" class="nav-link" data-scroll-target="#efficiency"><span class="header-section-number">3.6</span> Efficiency</a>
  <ul class="collapse">
  <li><a href="#sharing-a-code-environment" id="toc-sharing-a-code-environment" class="nav-link" data-scroll-target="#sharing-a-code-environment"><span class="header-section-number">3.6.1</span> Sharing a code environment</a></li>
  <li><a href="#code-linting-and-styling" id="toc-code-linting-and-styling" class="nav-link" data-scroll-target="#code-linting-and-styling"><span class="header-section-number">3.6.2</span> Code linting and styling</a></li>
  <li><a href="#code-review" id="toc-code-review" class="nav-link" data-scroll-target="#code-review"><span class="header-section-number">3.6.3</span> Code review</a></li>
  <li><a href="#code-refactoring" id="toc-code-refactoring" class="nav-link" data-scroll-target="#code-refactoring"><span class="header-section-number">3.6.4</span> Code refactoring</a></li>
  <li><a href="#parallel-processing" id="toc-parallel-processing" class="nav-link" data-scroll-target="#parallel-processing"><span class="header-section-number">3.6.5</span> Parallel processing</a></li>
  </ul></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks"><span class="header-section-number">3.7</span> Concluding remarks</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3.8</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales">Scales</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial">Tutorial</a></li>
  <li><a href="#paper" id="toc-paper" class="nav-link" data-scroll-target="#paper">Paper</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RohanAlexander/telling_stories/edit/main/03-workflow.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-reproducible-workflows" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Prerequisites</strong></p>
<ul>
<li>Read <em>What has happened down here is the winds have changed</em>, <span class="citation" data-cites="Gelman2016">(<a href="99-references.html#ref-Gelman2016" role="doc-biblioref">Gelman 2016</a>)</span>
<ul>
<li>A blog post that provides an overview of the replication crisis, and how social science changed in response.</li>
</ul></li>
<li>Read <em>Good enough practices in scientific computing</em>, <span class="citation" data-cites="wilsongoodenough">(<a href="99-references.html#ref-wilsongoodenough" role="doc-biblioref">Wilson et al. 2017</a>)</span>
<ul>
<li>A paper that provides a set of clear, easily adoptable, recommendations for how to do data science, focused on how we use computers.</li>
</ul></li>
<li>Read <em>How to improve your relationship with your future self</em>, <span class="citation" data-cites="bowers2016improve">(<a href="99-references.html#ref-bowers2016improve" role="doc-biblioref">Bowers and Voors 2016</a>)</span>
<ul>
<li>A paper that provides a set of clear, easily adoptable, recommendations for how to do data science, focused on analysis.</li>
</ul></li>
<li>Watch <em>Overcoming barriers to sharing code</em>, <span class="citation" data-cites="monicatalks">(<a href="99-references.html#ref-monicatalks" role="doc-biblioref">Alexander 2021</a>)</span>
<ul>
<li>This video is a personal reflection on becoming comfortable with sharing code.</li>
</ul></li>
<li>Watch <em>Make a reprex<span class="math inline">\(\dots\)</span> Please</em>, <span class="citation" data-cites="sharlatalks">(<a href="99-references.html#ref-sharlatalks" role="doc-biblioref">Gelfand 2021</a>)</span>
<ul>
<li>This video details why creating a reproducible example is so important when asking for help.</li>
</ul></li>
<li>Read <em>The tidyverse style guide</em>, <span class="citation" data-cites="tidyversestyleguide">(<a href="99-references.html#ref-tidyversestyleguide" role="doc-biblioref">Wickham 2021</a>)</span>
<ul>
<li>A website documenting a set of recommended best-practices when coding in R.</li>
</ul></li>
<li>Watch <em>Code smells and feels</em>, <span class="citation" data-cites="codesmells">(<a href="99-references.html#ref-codesmells" role="doc-biblioref">Bryan 2018b</a>)</span>
<ul>
<li>A video that details things to try to avoid when coding.</li>
</ul></li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>Reproducibility typically begins as something that someone imposes on you. It can be onerous and annoying. This typically lasts until you need to revisit a project after a small break. At that point you typically realize that reproducibility is not just a requirement for data science because it is the only way that we can make genuine progress, but because it helps us help ourselves.</li>
<li>Reproducibility implies sharing data, code, and environment. This is enhanced by using Quarto, R Projects, and Git and GitHub: Quarto builds documents that integrate normal text and R code; R Projects enable a file structure that is not dependent on a user’s personal directory set-up; and Git and GitHub make it easier to share code and data.</li>
<li>This is not an unimpeachable workflow, but one that is good enough and provides many of the benefits. We will improve various aspects of it through various tools, but improving code structure and comments goes a long way.</li>
<li>There are always errors that occur, and it is important to recognize that debugging is a skill that improves with practice. But one key aspect of being able to get help is to be able to make a reproducible example others can use.</li>
</ul>
<p><strong>Software and packages</strong></p>
<ul>
<li>Base R <span class="citation" data-cites="citeR">(<a href="99-references.html#ref-citeR" role="doc-biblioref">R Core Team 2023</a>)</span></li>
<li><code>AER</code> <span class="citation" data-cites="citeaer">(<a href="99-references.html#ref-citeaer" role="doc-biblioref">Kleiber and Zeileis 2008</a>)</span></li>
<li><code>future</code> <span class="citation" data-cites="future">(<a href="99-references.html#ref-future" role="doc-biblioref">Bengtsson 2021</a>)</span></li>
<li><code>gitcreds</code> <span class="citation" data-cites="gitcreds">(<a href="99-references.html#ref-gitcreds" role="doc-biblioref">Csárdi 2022</a>)</span></li>
<li><code>knitr</code> <span class="citation" data-cites="citeknitr">(<a href="99-references.html#ref-citeknitr" role="doc-biblioref">Xie 2023</a>)</span></li>
<li><code>lintr</code> <span class="citation" data-cites="lintr">(<a href="99-references.html#ref-lintr" role="doc-biblioref">Hester et al. 2022</a>)</span></li>
<li><code>renv</code> <span class="citation" data-cites="renv">(<a href="99-references.html#ref-renv" role="doc-biblioref">Ushey 2022</a>)</span></li>
<li><code>reprex</code> <span class="citation" data-cites="reprex">(<a href="99-references.html#ref-reprex" role="doc-biblioref">Bryan et al. 2022</a>)</span></li>
<li><code>styler</code> <span class="citation" data-cites="styler">(<a href="99-references.html#ref-styler" role="doc-biblioref">Müller and Walthert 2022</a>)</span></li>
<li><code>tictoc</code> <span class="citation" data-cites="Izrailev2014">(<a href="99-references.html#ref-Izrailev2014" role="doc-biblioref">Izrailev 2022</a>)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(<a href="99-references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span></li>
<li><code>tinytex</code> <span class="citation" data-cites="tinytex">(<a href="99-references.html#ref-tinytex" role="doc-biblioref">Xie 2019</a>)</span></li>
<li><code>usethis</code> <span class="citation" data-cites="usethis">(<a href="99-references.html#ref-usethis" role="doc-biblioref">Wickham, Bryan, and Barrett 2022</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gitcreds)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lintr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(renv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reprex)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(styler)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytex)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1</span> Introduction</h2>
<blockquote class="blockquote">
<p>The number one thing to keep in mind about machine learning is that performance is evaluated on samples from one dataset, but the model is used in production on samples that may not necessarily follow the same characteristics<span class="math inline">\(\dots\)</span> So when asking the question, “would you rather use a model that was evaluated as 90% accurate, or a human that was evaluated as 80% accurate”, the answer depends on whether your data is typical per the evaluation process. Humans are adaptable, models are not. If significant uncertainty is involved, go with the human. They may have inferior pattern recognition capabilities (versus models trained on enormous amounts of data), but they understand what they do, they can reason about it, and they can improvise when faced with novelty.</p>
<p>François Chollet, 20 February 2020.</p>
</blockquote>
<p>If science is about systematically building and organizing knowledge in terms of testable explanations and predictions, then data science takes this and focuses on data. This means that building, organizing, and sharing knowledge is a critical aspect. Creating knowledge, once, in a way that only you can do it, does not meet this standard. Hence, there is a need for reproducible data science workflows.</p>
<p><span class="citation" data-cites="Alexander2019">Alexander (<a href="99-references.html#ref-Alexander2019" role="doc-biblioref">2019</a>)</span> defines reproducible research as that which can be exactly redone, given all the materials used. This underscores the importance of providing the code, data, and environment. The minimum expectation is that another person is independently able to use your code, data, and environment to get your results, including figures and tables. Ironically, there are different definitions of reproducibility between disciplines. <span class="citation" data-cites="barba2018terminologies">Barba (<a href="99-references.html#ref-barba2018terminologies" role="doc-biblioref">2018</a>)</span> surveys a variety of disciplines and concludes that the predominant language usage implies the following definitions:</p>
<ul>
<li>Reproducible research is when “[a]uthors provide all the necessary data and the computer codes to run the analysis again, re-creating the results.”</li>
<li>A replication is a study “that arrives at the same scientific findings as another study, collecting new data (possibly with different methods) and completing new analyses.”</li>
</ul>
<p>Regardless of what it is specifically called, <span class="citation" data-cites="Gelman2016">Gelman (<a href="99-references.html#ref-Gelman2016" role="doc-biblioref">2016</a>)</span> identifies how large an issue the lack of it is in various social sciences. The problem with work that is not reproducible is that it does not contribute to our stock of knowledge about the world. This is wasteful and potentially even unethical. Since <span class="citation" data-cites="Gelman2016">Gelman (<a href="99-references.html#ref-Gelman2016" role="doc-biblioref">2016</a>)</span>, a great deal of work has been done in many social sciences and the situation has improved a little, but much work remains. That is also the case in the life sciences <span class="citation" data-cites="heil2021reproducibility">(<a href="99-references.html#ref-heil2021reproducibility" role="doc-biblioref">Heil et al. 2021</a>)</span> and computer science <span class="citation" data-cites="pineau2021improving">(<a href="99-references.html#ref-pineau2021improving" role="doc-biblioref">Pineau et al. 2021</a>)</span>.</p>
<p>Some of the examples that <span class="citation" data-cites="Gelman2016">Gelman (<a href="99-references.html#ref-Gelman2016" role="doc-biblioref">2016</a>)</span> talks about are not that important in the scheme of things. But at the same time, we saw, and continue to see, similar approaches being used in areas with big impacts. For instance, many governments have created “nudge” units that implement public policy <span class="citation" data-cites="sunstein2017economics">(<a href="99-references.html#ref-sunstein2017economics" role="doc-biblioref">Sunstein and Reisch 2017</a>)</span> even though there is evidence that some of the claims lack credibility <span class="citation" data-cites="nonudge gelmannudge">(<a href="99-references.html#ref-nonudge" role="doc-biblioref">Maier et al. 2022</a>; <a href="99-references.html#ref-gelmannudge" role="doc-biblioref">Szaszi et al. 2022</a>)</span>. Governments are increasingly using algorithms that they do not make open <span class="citation" data-cites="chouldechova18a">(<a href="99-references.html#ref-chouldechova18a" role="doc-biblioref">Chouldechova et al. 2018</a>)</span>. And <span class="citation" data-cites="herndon2014does">Herndon, Ash, and Pollin (<a href="99-references.html#ref-herndon2014does" role="doc-biblioref">2014</a>)</span> document how research in economics that was used by governments to justify austerity policies following the 2007–2008 financial crisis turned out to not be reproducible.</p>
<p>At a minimum, and with few exceptions, we must release our code, datasets, and environment. Without these, it is difficult to know what a finding speaks to <span class="citation" data-cites="miyakawa2020no">(<a href="99-references.html#ref-miyakawa2020no" role="doc-biblioref">Miyakawa 2020</a>)</span>. More banally, we also do not know if there are mistakes or aspects that were inadvertently overlooked <span class="citation" data-cites="merali2010computational hillelwayne natefixesmistake">(<a href="99-references.html#ref-merali2010computational" role="doc-biblioref">Merali 2010</a>; <a href="99-references.html#ref-hillelwayne" role="doc-biblioref">Hillel 2017</a>; <a href="99-references.html#ref-natefixesmistake" role="doc-biblioref">Silver 2020</a>)</span>. Increasingly, following <span class="citation" data-cites="buckheit1995wavelab">Buckheit and Donoho (<a href="99-references.html#ref-buckheit1995wavelab" role="doc-biblioref">1995</a>)</span>, we consider a paper to be an advertisement, and for the associated code, data, and environment to be the actual work. Steve Jobs, a co-founder of Apple, talked about how the best craftsmen ensure that even the aspects of their work that no one else will ever see are as well finished and high quality as the aspects that are public facing <span class="citation" data-cites="stevejobs">(<a href="99-references.html#ref-stevejobs" role="doc-biblioref">Isaacson 2011</a>)</span>. The same is true in data science, where often one of the distinguishing aspects of high-quality work is that the README and code comments are as polished as, say, the abstract of the associated paper.</p>
<p>Workflows exist within a cultural and social context, which imposes an additional ethical reason for the need for them to be reproducible. For instance, <span class="citation" data-cites="wang2018deep">Wang and Kosinski (<a href="99-references.html#ref-wang2018deep" role="doc-biblioref">2018</a>)</span> train a neural network to distinguish between the faces of gay and heterosexual men. (<span class="citation" data-cites="murphy2017">Murphy (<a href="99-references.html#ref-murphy2017" role="doc-biblioref">2017</a>)</span> provides a summary of the paper, the associated issues, and comments from its authors.) To do this, <span class="citation" data-cites="wang2018deep">Wang and Kosinski (<a href="99-references.html#ref-wang2018deep" role="doc-biblioref">2018, 248</a>)</span> needed a dataset of photos of people that were “adult, Caucasian, fully visible, and of a gender that matched the one reported on the user’s profile”. They verified this using Amazon Mechanical Turk, an online platform that pays workers a small amount of money to complete specific tasks. The instructions provided to the Mechanical Turk workers for this task specify that Barack Obama, the 44th US President, who had a white mother and a black father, should be classified as “Black”; and that Latino is an ethnicity, rather than a race <span class="citation" data-cites="Mattson2017">(<a href="99-references.html#ref-Mattson2017" role="doc-biblioref">Mattson 2017</a>)</span>. The classification task may seem objective, but, perhaps unthinkingly, echoes the views of Americans with a certain class and background.</p>
<p>This is just one specific concern about one part of the <span class="citation" data-cites="wang2018deep">Wang and Kosinski (<a href="99-references.html#ref-wang2018deep" role="doc-biblioref">2018</a>)</span> workflow. Broader concerns are raised by others including <span class="citation" data-cites="Gelman_2018">Gelman, Mattson, and Simpson (<a href="99-references.html#ref-Gelman_2018" role="doc-biblioref">2018</a>)</span>. The main issue is that statistical models are specific to the data on which they were trained. And the only reason that we can identify likely issues in the model of <span class="citation" data-cites="wang2018deep">Wang and Kosinski (<a href="99-references.html#ref-wang2018deep" role="doc-biblioref">2018</a>)</span> is because, despite not releasing the specific dataset that they used, they were nonetheless open about their procedure. For our work to be credible, it needs to be reproducible by others.</p>
<p>Some of the steps that we can take to make our work more reproducible include:</p>
<ol type="1">
<li>Ensure the entire workflow is documented. This may involve addressing questions such as:
<ul>
<li>How was the original, unedited dataset obtained and is access likely to be persistent and available to others?</li>
<li>What specific steps are being taken to transform the original, unedited data into the data that were analyzed, and how can this be made available to others?</li>
<li>What analysis has been done, and how clearly can this be shared?</li>
<li>How has the final paper or report been built and to what extent can others follow that process themselves?</li>
</ul></li>
<li>Not worrying about perfect reproducibility initially, but instead focusing on trying to improve with each successive project. For instance, each of the following requirements are increasingly more onerous and there is no need to be concerned about not being able to do the last, until you can do the first:
<ul>
<li>Can you run your entire workflow again?</li>
<li>Can another person run your entire workflow again?</li>
<li>Can “future-you” run your entire workflow again?</li>
<li>Can “future-another-person” run your entire workflow again?</li>
</ul></li>
<li>Including a detailed discussion about the limitations of the dataset and the approach in the final paper or report.</li>
</ol>
<p>The workflow that we advocate in this book is:</p>
<p><span class="math display">\[
\mbox{Plan}\rightarrow\mbox{Simulate}\rightarrow\mbox{Acquire}\rightarrow\mbox{Explore}\rightarrow\mbox{Share}
\]</span></p>
<p>But it can be alternatively considered as: “Think an awful lot, mostly read and write, sometimes code”.</p>
<p>There are various tools that we can use at the different stages that will improve the reproducibility of this workflow. This includes Quarto, R Projects, and Git and GitHub.</p>
</section>
<section id="quarto" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="quarto"><span class="header-section-number">3.2</span> Quarto</h2>
<section id="getting-started" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">3.2.1</span> Getting started</h3>
<p>Quarto integrates code and natural language in a way that is called “literate programming” <span class="citation" data-cites="Knuth1984">(<a href="99-references.html#ref-Knuth1984" role="doc-biblioref">Knuth 1984</a>)</span>. It is the successor to R Markdown, which was a variant of Markdown specifically designed to allow R code chunks to be included. Quarto uses a mark-up language similar to HyperText Markup Language (HTML) or LaTeX, in comparison to a “What You See Is What You Get” (WYSIWYG) language, such as Microsoft Word. This means that all the aspects are consistent, for instance, all top-level headings will look the same. But it means that we must designate or “mark up” how we would like certain aspects to appear. And it is only when we render the document that we get to see what it looks like. A visual editor option can also be used, and this hides the need for the user to do this mark-up themselves.</p>
<p>While it makes sense to use Quarto going forward, there are many resources written for and in R Markdown. For this reason we provide R Markdown equivalents in <a href="22-rmarkdown.html">Online Appendix&nbsp;<span>C</span></a>.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fernando Pérez is an associate professor of statistics at the University of California, Berkeley and a Faculty Scientist, Data Science and Technology Division, at Lawrence Berkeley National Laboratory. He earned a PhD in particle physics from the University of Colorado, Boulder. During his PhD he created iPython, which enables Python to be used interactively, and now underpins Project Jupyter, which inspired similar notebook approaches such as R Markdown and now Quarto. <span class="citation" data-cites="somers2018obsolete">Somers (<a href="99-references.html#ref-somers2018obsolete" role="doc-biblioref">2018</a>)</span> describes how open-source notebook approaches create virtuous feedback loops that result in dramatically improved scientific computing. And <span class="citation" data-cites="romersays">Romer (<a href="99-references.html#ref-romersays" role="doc-biblioref">2018</a>)</span> aligns the features of open-source approaches, such as Jupyter, with the features that enable scientific consensus and progress. In 2017 Pérez was awarded the Association for Computing Machinery (ACM) Software System Award.</p>
</div>
</div>
<p>One advantage of literate programming is that we get a “live” document in which code executes and then forms part of the document. Another advantage of Quarto is that similar code can compile into a variety of documents, including HTML and PDFs. Quarto also has default options for including a title, author, and date. One disadvantage is that it can take a while for a document to compile because the code needs to run.</p>
<p>We need to download Quarto from <a href="https://quarto.org/docs/get-started/">here</a>. (Skip this step if you are using Posit Cloud because it is already installed.) We can then create a new Quarto document within RStudio: “File” <span class="math inline">\(\rightarrow\)</span> “New File” <span class="math inline">\(\rightarrow\)</span> “Quarto Document<span class="math inline">\(\dots\)</span>”.</p>
<p>After opening a new Quarto document and selecting “Source” view, you will see the default <a href="#Top%20matter">top matter</a>, contained within a pair of three dashes, as well as some examples of text showing a few of the markdown <a href="#essential%20commands">essential commands</a> and <a href="#R%20chunks">R chunks</a>, each of which are discussed further in the following sections.</p>
</section>
<section id="top-matter" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="top-matter"><span class="header-section-number">3.2.2</span> Top matter</h3>
<p>Top matter consists of defining aspects such as the title, author, and date. It is contained within three dashes at the top of a Quarto document. For instance, the following would specify a title, a date that automatically updated to the date the document was rendered, and an author.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
format: html
---</code></pre>
<p>An abstract is a short summary of the paper, and we could add that to the top matter.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
abstract: "This is my abstract."
format: html
---</code></pre>
<p>By default, Quarto will create an HTML document, but we can change the output format to produce a PDF. This uses LaTeX in the background and requires the installation of supporting packages. To do this install <code>tinytex</code>. But as it is used in the background we should not need to load it.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
abstract: "This is my abstract."
format: pdf
---</code></pre>
<p>We can include references by specifying a BibTeX file in the top matter and then calling it within the text, as needed.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
format: pdf
abstract: "This is my abstract."
bibliography: bibliography.bib
---</code></pre>
<p>We would need to make a separate file called “bibliography.bib” and save it next to the Quarto file. In the BibTeX file we need an entry for the item that is to be referenced. For instance, the citation for R can be obtained with <code>citation()</code> and this can be added to the “bibliography.bib” file. The citation for a package can be found by including the package name, for instance <code>citation("tidyverse")</code>, and again adding the output to the “.bib” file. It can be helpful to use <a href="https://scholar.google.com">Google Scholar</a> or <a href="https://www.doi2bib.org">doi2bib</a> to get citations for books or articles.</p>
<p>We need to create a unique key that we use to refer to this item in the text. This can be anything, provided it is unique, but meaningful ones can be easier to remember, for instance “citeR”.</p>
<pre><code>@Manual{citeR,
    title = {R: A Language and Environment for Statistical Computing},
    author = {{R Core Team}},
    organization = {R Foundation for Statistical Computing},
    address = {Vienna, Austria},
    year = {2021},
    url = {https://www.R-project.org/},
  }
@book{tellingstories,
    title = {Telling Stories with Data},
    author = {Rohan Alexander},
    year = {2023},
    publisher = {Chapman and Hall/CRC},
    url = {https://tellingstorieswithdata.com}
  }</code></pre>
<p>To cite R in the Quarto document we then include <code>@citeR</code>, which would put brackets around the year: <span class="citation" data-cites="citeR">R Core Team (<a href="99-references.html#ref-citeR" role="doc-biblioref">2023</a>)</span>, or <code>[@citeR]</code>, which would put brackets around the whole thing: <span class="citation" data-cites="citeR">(<a href="99-references.html#ref-citeR" role="doc-biblioref">R Core Team 2023</a>)</span>.</p>
<p>The reference list at the end of the paper is automatically built based on calling the BibTeX file and including references in the paper. At the end of the Quarto document, include a heading “# References” and the actual citations will be included after that. When the Quarto file is rendered, Quarto sees these in the content, goes to the BibTeX file to get the reference details that it needs, builds the reference list, and then adds it at the end of the rendered document.</p>
</section>
<section id="essential-commands" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="essential-commands"><span class="header-section-number">3.2.3</span> Essential commands</h3>
<p>Quarto uses a variation of Markdown as its underlying syntax. Essential Markdown commands include those for emphasis, headers, lists, links, and images. A reminder of these is included in RStudio: “Help” <span class="math inline">\(\rightarrow\)</span> “Markdown Quick Reference”. It is your choice as to whether you want to use the visual or source editor. But either way, it is good to understand these essentials because it will not always be possible to use a visual editor (for instance if you are quickly looking at a Quarto document in GitHub). As you get more experience it can be useful to use a text editor such as Sublime Text, or an alternative Integrated Development Environment such as VS Code.</p>
<ul>
<li>Emphasis: <code>*italic*</code>, <code>**bold**</code></li>
<li>Headers (these go on their own line with a blank line before and after):</li>
</ul>
<pre><code>         # First level header
         
         ## Second level header
         
         ### Third level header</code></pre>
<ul>
<li>Unordered list, with sub-lists:</li>
</ul>
<pre><code>    * Item 1
    * Item 2
        + Item 2a
        + Item 2b</code></pre>
<ul>
<li>Ordered list, with sub-lists:</li>
</ul>
<pre><code>    1. Item 1
    2. Item 2
    3. Item 3
        + Item 3a
        + Item 3b</code></pre>
<ul>
<li>URLs can be added: <code>[this book](https://www.tellingstorieswithdata.com)</code> results in <a href="https://www.tellingstorieswithdata.com">this book</a>.</li>
<li>A paragraph is created by leaving a blank line.</li>
</ul>
<pre><code>A paragraph about an idea, nicely spaced from the following paragraph.

A paragraph about another idea, again spaced from the earlier paragraph.</code></pre>
<p>Once we have added some aspects, then we may want to see the actual document. To build the document click “Render”.</p>
</section>
<section id="r-chunks" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="r-chunks"><span class="header-section-number">3.2.4</span> R chunks</h3>
<p>We can include code for R and many other languages in code chunks within a Quarto document. When we render the document the code will run and be included in the document.</p>
<p>To create an R chunk, we start with three backticks and then within curly braces we tell Quarto that this is an R chunk. Anything inside this chunk will be considered R code and run as such. We use data from <span class="citation" data-cites="citeaer">Kleiber and Zeileis (<a href="99-references.html#ref-citeaer" role="doc-biblioref">2008</a>)</span> who provide the R package <code>AER</code> to accompany their book <em>Applied Econometrics with R</em>. We could load the <code>tidyverse</code> and install and load <code>AER</code> and make a graph of the number of times a survey respondent visited the doctor in the past two weeks.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = illness)) +</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The output of that code is <a href="#fig-doctervisits">Figure&nbsp;<span>3.1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-doctervisits" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-workflow_files/figure-html/fig-doctervisits-1.png" class="quarto-discovered-preview-image img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>There are various evaluation options that are available in chunks. We include these, each on a new line, by opening the line with the chunk-specific comment delimiter “#|” and then the option. Helpful options include:</p>
<ul>
<li><code>echo</code>: This controls whether the code itself is included in the document. For instance, <code>#| echo: false</code> would mean the code will be run and its output will show, but the code itself would not be included in the document.</li>
<li><code>include</code>: This controls whether the output of the code is included in the document. For instance, <code>#| include: false</code> would run the code, but would not result in any output, and the code itself would not be included in the document.</li>
<li><code>eval</code>: This controls whether the code should be included in the document. For instance, <code>#| eval: false</code> would mean that the code is not run, and hence there would not be any output to include, but the code itself would be included in the document.</li>
<li><code>warning</code>: This controls whether warnings should be included in the document. For instance, <code>#| warning: false</code> would mean that warnings are not included.</li>
<li><code>message</code>: This controls whether messages should be included in the document. For instance, <code>#| message: false</code> would mean that messages are not included in the document.</li>
</ul>
<p>For instance, we could include the output, but not the code, and suppress any warnings.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>#| echo: false</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>#| warning: false</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = visits)) +</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Leave a blank line on either side of an R chunk, otherwise it may not run properly. And use lower case for logical values, i.e.&nbsp;“false” not “FALSE”.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Most people did not visit a doctor in the past week.</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>#| echo: false</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>#| warning: false</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = visits)) +</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>There were some people that visited a doctor once, and then...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The Quarto document itself must load any datasets that are needed. It is not enough that they are in the environment. This is because the Quarto document evaluates the code in the document when it is rendered, not necessarily the environment.</p>
<p>Often when writing code, we may want to make the same change across multiple lines or change all instances of a particular thing. We achieve this with multiple cursors. If we want a cursor across multiple, consecutive lines, then hold “option” on Mac or “Alt” on PC, while you drag your cursor over the relevant lines. If you want to select all instances of something, then highlight one instance, say a variable name, then use Find/Replace (Command + F on Mac or CTRL + F on PC) and select “All”. This will then enable a cursor at all the other instances.</p>
</section>
<section id="sec-equations" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="sec-equations"><span class="header-section-number">3.2.5</span> Equations</h3>
<p>We can include equations by using LaTeX, which is based on the programming language TeX. We invoke math mode in LaTeX by using two dollar signs as opening and closing tags. Then whatever is inside is evaluated as LaTeX mark-up. For instance we can produce the compound interest formula with:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>A = P\left(1+\frac{r}{n}\right)^{nt}</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
A = P\left(1+\frac{r}{n}\right)^{nt}
\]</span></p>
<p>LaTeX is a comprehensive mark-up language but we will mostly just use it to specify the model of interest. We include some examples here that contain the critical aspects we will draw on starting in <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
y_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma)
\]</span></p>
<p>Underscores are used to get subscripts: <code>y_i</code> for <span class="math inline">\(y_i\)</span>. And we can get a subscript of more than one item by surrounding it with curly braces: <code>y_{i,c}</code> for <span class="math inline">\(y_{i,c}\)</span>. In this case we wanted math mode within the line, and so we surround these with only one dollar sign as opening and closing tags.</p>
<p>Greek letters are typically preceded by a backslash. Common Greek letters include: <code>\alpha</code> for <span class="math inline">\(\alpha\)</span>, <code>\beta</code> for <span class="math inline">\(\beta\)</span>, <code>\delta</code> for <span class="math inline">\(\delta\)</span>, <code>\epsilon</code> for <span class="math inline">\(\epsilon\)</span>, <code>\gamma</code> for <span class="math inline">\(\gamma\)</span>, <code>\lambda</code> for <span class="math inline">\(\lambda\)</span>, <code>\mu</code> for <span class="math inline">\(\mu\)</span>, <code>\phi</code> for <span class="math inline">\(\phi\)</span>, <code>\pi</code> for <span class="math inline">\(\pi\)</span>, <code>\Pi</code> for <span class="math inline">\(\Pi\)</span>, <code>\rho</code> for <span class="math inline">\(\rho\)</span>, <code>\sigma</code> for <span class="math inline">\(\sigma\)</span>, <code>\Sigma</code> for <span class="math inline">\(\Sigma\)</span>, <code>\tau</code> for <span class="math inline">\(\tau\)</span>, and <code>\theta</code> for <span class="math inline">\(\theta\)</span>.</p>
<p>LaTeX math mode assumes letters are variables and so makes them italic, but sometimes we want a word to appear in normal font because it is not a variable, such as “Normal”. In that case we surround it with <code>\mbox{}</code>, for instance <code>\mbox{Normal}</code> for <span class="math inline">\(\mbox{Normal}\)</span>.</p>
<p>We line up equations across multiple lines using <code>\begin{aligned}</code> and <code>\end{aligned}</code>. Then the item that is to be lined up is noted by an ampersand. The following is a model that we will estimate in <a href="15-mrp.html"><span>Chapter&nbsp;15</span></a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) <span class="sc">\\</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>\mbox{logit}(\pi_i) &amp; = \beta_0+ \alpha_{g<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{gender}} + \alpha_{a<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{age}} + \alpha_{s<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{state}} + \alpha_{e<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{edu}} <span class="sc">\\</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)<span class="sc">\\</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>\alpha_{g}^{\mbox{gender}} &amp; \sim \mbox{Normal}(0, 2.5)\mbox{ for }g=1, 2<span class="sc">\\</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>\alpha_{a}^{\mbox{age}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{age}}\right)\mbox{ for }a = 1, 2, \dots, A<span class="sc">\\</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>\alpha_{s}^{\mbox{state}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{state}}\right)\mbox{ for }s = 1, 2, \dots, S<span class="sc">\\</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>\alpha_{e}^{\mbox{edu}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{edu}}\right)\mbox{ for }e = 1, 2, \dots, E<span class="sc">\\</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{gender}} &amp; \sim \mbox{Exponential}(1)<span class="sc">\\</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{state}} &amp; \sim \mbox{Exponential}(1)<span class="sc">\\</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{edu}} &amp; \sim \mbox{Exponential}(1)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
\begin{aligned}
y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &amp; = \beta_0+ \alpha_{g[i]}^{\mbox{gender}} + \alpha_{a[i]}^{\mbox{age}} + \alpha_{s[i]}^{\mbox{state}} + \alpha_{e[i]}^{\mbox{edu}} \\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\alpha_{g}^{\mbox{gender}} &amp; \sim \mbox{Normal}(0, 2.5)\mbox{ for }g=1, 2\\
\alpha_{a}^{\mbox{age}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{age}}\right)\mbox{ for }a = 1, 2, \dots, A\\
\alpha_{s}^{\mbox{state}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{state}}\right)\mbox{ for }s = 1, 2, \dots, S\\
\alpha_{e}^{\mbox{edu}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{edu}}\right)\mbox{ for }e = 1, 2, \dots, E\\
\sigma_{\mbox{gender}} &amp; \sim \mbox{Exponential}(1)\\
\sigma_{\mbox{state}} &amp; \sim \mbox{Exponential}(1)\\
\sigma_{\mbox{edu}} &amp; \sim \mbox{Exponential}(1)
\end{aligned}
\]</span></p>
<p>Finally, certain functions are built into LaTeX. For instance, we can appropriately typeset “log” with <code>\log</code>.</p>
</section>
<section id="sec-quartocrossreferences" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="sec-quartocrossreferences"><span class="header-section-number">3.2.6</span> Cross-references</h3>
<p>It can be useful to cross-reference figures, tables, and equations. This makes it easier to refer to them in the text. To do this for a figure we refer to the name of the R chunk that creates or contains the figure. For instance, consider the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-uniquename</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Number of illnesses in the past two weeks, based on the 1977--1978 Australian Health Survey</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"DoctorVisits"</span>, <span class="at">package =</span> <span class="st">"AER"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>DoctorVisits <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> illness)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-uniquename" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-workflow_files/figure-html/fig-uniquename-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Then <code>(@fig-uniquename)</code> would produce: (<a href="#fig-uniquename">Figure&nbsp;<span>3.3</span></a>) as the name of the R chunk is <code>fig-uniquename</code>. We need to add “fig” to the start of the chunk name so that Quarto knows that this is a figure. We then include a “fig-cap:” in the R chunk that specifies a caption.</p>
<p>We can add <code>#| layout-ncol: 2</code> in an R chunk within a Quarto document to have two graphs appear side by side (<a href="#fig-doctorgraphsidebyside">Figure&nbsp;<span>3.4</span></a>). Here <a href="#fig-doctorgraphsidebyside-1">Figure&nbsp;<span>3.4 (a)</span></a> uses the minimal theme, and <a href="#fig-doctorgraphsidebyside-2">Figure&nbsp;<span>3.4 (b)</span></a> uses the classic theme. These both cross-reference the same label <code>#| label: fig-doctorgraphsidebyside</code> in the R chunk, with an additional option added in the R chunk of <code>#| fig-subcap: ["Number of illnesses","Number of visits to the doctor"]</code> which provides the sub-captions. The addition of a letter in-text is accomplished by adding “-1” and “-2” to the end of the label when it is used in-text: <code>(@fig-doctorgraphsidebyside)</code>, <code>@fig-doctorgraphsidebyside-1</code>, and <code>@fig-doctorgraphsidebyside-2</code> for (<a href="#fig-doctorgraphsidebyside">Figure&nbsp;<span>3.4</span></a>), <a href="#fig-doctorgraphsidebyside-1">Figure&nbsp;<span>3.4 (a)</span></a>, and <a href="#fig-doctorgraphsidebyside-2">Figure&nbsp;<span>3.4 (b)</span></a>, respectively.</p>
<div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-doctorgraphsidebyside</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Two variants of graphs"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: ["Illnesses","Visits to the doctor"]</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>DoctorVisits <span class="sc">|&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> illness)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>DoctorVisits <span class="sc">|&gt;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> visits)) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-doctorgraphsidebyside" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-doctorgraphsidebyside-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-workflow_files/figure-html/fig-doctorgraphsidebyside-1.png" class="img-fluid figure-img" data-ref-parent="fig-doctorgraphsidebyside" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Illnesses</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-doctorgraphsidebyside-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-workflow_files/figure-html/fig-doctorgraphsidebyside-2.png" class="img-fluid figure-img" data-ref-parent="fig-doctorgraphsidebyside" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Visits to the doctor</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.4: Two variants of graphs</figcaption><p></p>
</figure>
</div>
</div>
<p>We can take a similar approach to cross-reference tables. For instance, <code>(@tbl-docvisittable)</code> will produce: (<a href="#tbl-docvisittable">Table&nbsp;<span>3.1</span></a>). In this case we specify “tbl” at the start of the label so that Quarto knows that it is a table. And we specify a caption for the table with “tbl-cap:”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-docvisittable</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Distribution of the number of doctor visits"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>DoctorVisits <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(visits) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-docvisittable" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;3.1: Distribution of the number of doctor visits</caption>
<thead>
<tr class="header">
<th style="text-align: right;">visits</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4141</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">782</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">174</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finally, we can also cross-reference equations. To that we need to add a tag such as <code>{#eq-macroidentity}</code> which we then reference.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Y = C + I + G + (X - M)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gdpidentity}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For instance, we then use <code>@eq-gdpidentity</code> to produce <a href="#eq-gdpidentity">Equation&nbsp;<span>3.1</span></a></p>
<p><span id="eq-gdpidentity"><span class="math display">\[
Y = C + I + G + (X - M)
\tag{3.1}\]</span></span></p>
<p>Labels should be relatively simple when using cross-references. In general, try to keep the names simple but unique, avoid punctuation, and stick to letters and hyphens. Try not to use underscores, because they can cause an error.</p>
</section>
</section>
<section id="r-projects-and-file-structure" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="r-projects-and-file-structure"><span class="header-section-number">3.3</span> R Projects and file structure</h2>
<p>Projects are widely used in software development and exist to keep all the files (data, analysis, report, etc) associated with a particular project together and related to each other. (This use of “project” in a software development sense, is distinct to a “project”, in the project management sense.) An R Project can be created in RStudio. Click “File” <span class="math inline">\(\rightarrow\)</span> “New Project”, then select “Empty project”, name the R Project and decide where to save it. For instance, a R Project focused on maternal mortality may be called “maternalmortality”. The use of R Projects enables “reliable, polite behavior across different computers or users and over time” <span class="citation" data-cites="whattheyforgot">(<a href="99-references.html#ref-whattheyforgot" role="doc-biblioref">Bryan and Hester 2020</a>)</span>. This is because they remove the context of that folder from its broader existence; files exist in relation to the base of the R Project, not the base of the computer.</p>
<p>Once a project has been created, a new file with the extension “.RProj” will appear in that folder. An example of a folder with an R Project, a Quarto document, and an appropriate file structure is available <a href="https://github.com/RohanAlexander/starter_folder">here</a>. That can be downloaded: “Code” <span class="math inline">\(\rightarrow\)</span> “Download ZIP”.</p>
<p>The main advantage of using an R Project is that we can reference files within it in a self-contained way. That means when others want to reproduce our work, they will not need to change all the file references and structure as everything is referenced in relation to the “.Rproj” file. For instance, instead of reading a CSV from, say, <code>"~/Documents/projects/book/data/"</code> you can read it from <code>book/data/</code>. It may be that someone else does not have a <code>projects</code> folder, and so the former would not work for them, while the latter would.</p>
<p>The use of projects is required to meet the minimal level of reproducibility expected of credible work. The use of functions such as <code>setwd()</code>, and computer-specific file paths, bind work to a specific computer in a way that is not appropriate.</p>
<p>There are a variety of ways to set up a folder. A variant of <span class="citation" data-cites="wilsongoodenough">Wilson et al. (<a href="99-references.html#ref-wilsongoodenough" role="doc-biblioref">2017</a>)</span> that is often useful when you are getting started is shown in the example file structure linked above.</p>
<pre class="text"><code>example_project/
├── .gitignore
├── LICENSE.md
├── README.md
├── example_project.Rproj
├── inputs
│   ├── data
│   │   ├── unedited_data.csv
│   │   └── ...
│   ├── literature
│   │   ├── alexander-tellingstorieswithdata.pdf
│   │   ├── gelman-xboxpaper.pdf
│   │   └── ...
├── outputs
│   ├── README.md
│   ├── data
│   │   ├── analysis_data.csv
│   │   └── ...
│   ├── paper
│   │   ├── paper.pdf
│   │   ├── paper.qmd
│   │   ├── references.bib
│   │   └── ...
│   └── ...
├── scripts
│   ├── 00-simulate_data.R
│   ├── 01-download_data.R
│   ├── 02-data_cleaning.R
│   ├── 03-test_data.R
│   └── ...
└── ...</code></pre>
<p>Here we have an <code>inputs</code> folder that contains original, unedited data that should not be written over <span class="citation" data-cites="wilsongoodenough">(<a href="99-references.html#ref-wilsongoodenough" role="doc-biblioref">Wilson et al. 2017</a>)</span> and literature related to the project. An <code>outputs</code> folder contains data that we create using R, as well as the paper that we are writing. And a <code>scripts</code> folder is what modifies the unedited data and saves it into <code>outputs</code>. We will do most of our work in “scripts”, and the Quarto file for the paper in <code>outputs</code>. Useful other aspects include a <code>README.md</code> which will specify overview details about the project, and a LICENSE. An example of what to put in the README is <a href="https://social-science-data-editors.github.io/template_README/">here</a>. Another helpful variant of this project skeleton is provided by <span class="citation" data-cites="GoodResearchCode">Mineault and The Good Research Code Handbook Community (<a href="99-references.html#ref-GoodResearchCode" role="doc-biblioref">2021</a>)</span>.</p>
</section>
<section id="version-control" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="version-control"><span class="header-section-number">3.4</span> Version control</h2>
<p>In this book we implement version control through a combination of Git and GitHub. There are a variety of reasons for this including:</p>
<ol type="1">
<li>enhancing the reproducibility of work by making it easier to share code and data;</li>
<li>making it easier to share work;</li>
<li>improving workflow by encouraging systematic approaches; and</li>
<li>making it easier to work in teams.</li>
</ol>
<p>Git is a version control system with a fascinating history <span class="citation" data-cites="githistory">(<a href="99-references.html#ref-githistory" role="doc-biblioref">Brown 2018</a>)</span>. The way one often starts doing version control is to have various copies of the one file: “first_go.R”, “first_go-fixed.R”, “first_go-fixed-with-mons-edits.R”. But this soon becomes cumbersome. One often soon turns to dates, for instance: “2022-01-01-analysis.R”, “2022-01-02-analysis.R”, “2022-01-03-analysis.R”, etc. While this keeps a record, it can be difficult to search when we need to go back, because it is hard to remember the date some change was made. In any case, it quickly gets unwieldy for a project that is being regularly worked on.</p>
<p>Instead of this, we use Git so that we can have one version of the file. Git keeps a record of the changes to that file, and a snapshot of that file at a given point in time. We determine when Git takes that snapshot. We additionally include a message saying what changed between this snapshot and the last. In that way, there is only ever one version of the file, and the history can be more easily searched.</p>
<p>One complication is that Git was designed for teams of software developers. As such, while it works, it can be a little ungainly for non-developers. Nonetheless Git has been usefully adapted for data science, even when the only collaborator one may have is one’s future self <span class="citation" data-cites="Bryan2018">(<a href="99-references.html#ref-Bryan2018" role="doc-biblioref">Bryan 2018a</a>)</span>.</p>
<p>GitHub, GitLab, and various other companies offer easier-to-use services that build on Git. While there are tradeoffs, we introduce GitHub here because it is the predominant platform <span class="citation" data-cites="eghbal2020working">(<a href="99-references.html#ref-eghbal2020working" role="doc-biblioref">Eghbal 2020, 21</a>)</span>. Git and GitHub are built into Posit Cloud, which provides a nice option if you have issues with local installation. One of the initial challenging aspects of Git is the terminology. Folders are called “repos”. Creating a snapshot is called a “commit”. One gets used to it eventually, but feeling confused initially is normal. <span class="citation" data-cites="happygit">Bryan (<a href="99-references.html#ref-happygit" role="doc-biblioref">2020</a>)</span> is especially useful for setting up and using Git and GitHub.</p>
<section id="git" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="git"><span class="header-section-number">3.4.1</span> Git</h3>
<p>We first need to check whether Git is installed. Open RStudio, go to the Terminal, type the following, and then enter/return.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">--version</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you get a version number, then you are done (<a href="#fig-gitone">Figure&nbsp;<span>3.5 (a)</span></a>).</p>
<div id="fig-grits" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-gitone" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03-git-setup-01.png" class="img-fluid figure-img" data-ref-parent="fig-grits"></p>
<p></p><figcaption class="figure-caption">(a) Using Terminal to check whether Git is installed in RStudio</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-gitone-setup" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03-git-setup-02.png" class="img-fluid figure-img" data-ref-parent="fig-grits"></p>
<p></p><figcaption class="figure-caption">(b) Adding a username and email address to Git in RStudio</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.5: An overview of the steps involved in setting up Git</figcaption><p></p>
</figure>
</div>
<p>Git is pre-installed in Posit Cloud, it should be pre-installed on Mac, and it may be pre-installed on Windows. If you do not get a version number in response, then you need to install it. To do that you should follow the instructions specific to your operating system in <span class="citation" data-cites="happygit">Bryan (<a href="99-references.html#ref-happygit" role="doc-biblioref">2020, chap. 5</a>)</span>.</p>
<p>After Git is installed we need to tell it a username and email. We need to do this because Git adds this information whenever we take a snapshot, or to use Git’s language, whenever we make a commit.</p>
<p>Again, within the Terminal, type the following, replacing the details with yours, and then press “enter/return” after each line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.name <span class="st">"Rohan Alexander"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.email <span class="st">"rohan.alexander@utoronto.ca"</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> <span class="at">--list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When this set-up has been done properly, the values that you entered for “user.name” and “user.email” will be returned after the last line (<a href="#fig-gitone-setup">Figure&nbsp;<span>3.5 (b)</span></a>).</p>
<p>These details—username and email address—will be public. There are various ways to hide the email address if necessary, and GitHub provides instructions about this. <span class="citation" data-cites="happygit">Bryan (<a href="99-references.html#ref-happygit" role="doc-biblioref">2020, chap. 7</a>)</span> provides more detailed instructions about this step, and a trouble-shooting guide.</p>
</section>
<section id="github" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="github"><span class="header-section-number">3.4.2</span> GitHub</h3>
<p>Now that Git is set up, we need to set up GitHub. We created a GitHub account in <a href="02-drinking_from_a_fire_hose.html"><span>Chapter&nbsp;2</span></a>, which we use again here. After being signed in at <code>github.com</code> we first need to make a new folder, which is called a “repo” in Git. Look for a “+” in the top right, and then select “New Repository” (<a href="#fig-githubtwo">Figure&nbsp;<span>3.6 (a)</span></a>).</p>
<div id="fig-gritshub" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubtwo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/github_2.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(a) Start process of creating a new repository</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubfour" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/github_4.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(b) Copy the URL of the new repository</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubnewproject" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03-github-new-project.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(c) Adding the project to Posit Cloud</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubpat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/04-githubpat.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(d) Creating a PAT</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubadd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03-github-add.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(e) Adding files to be committed</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-githubcommit" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03-github-commit.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub"></p>
<p></p><figcaption class="figure-caption">(f) Making a commit</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.6: An overview of the steps involved in setting up GitHub</figcaption><p></p>
</figure>
</div>
<p>At this point we can add a sensible name for the repo. Leave it as “public” for now, because it can always be deleted later. And check the box to “Initialize this repository with a README”. Change “Add .gitignore” to R. After that, click “Create repository”.</p>
<p>This will take us to a screen that is fairly empty, but the details that we need—a URL—are in the green “Clone or Download” button, which we can copy by clicking the clipboard (<a href="#fig-githubfour">Figure&nbsp;<span>3.6 (b)</span></a>).</p>
<p>Now returning to RStudio, in Posit Cloud, we create a new project using “New Project from Git Repository”. It will ask for the URL that we just copied (<a href="#fig-githubnewproject">Figure&nbsp;<span>3.6 (c)</span></a>). If you are using a local computer, then this step is accomplished through the menu: “File” <span class="math inline">\(\rightarrow\)</span> “New Project…” <span class="math inline">\(\rightarrow\)</span> “Version Control” <span class="math inline">\(\rightarrow\)</span> “Git”, then paste in the URL, give the folder a meaningful name, check “Open in new session”, then click “Create Project”.</p>
<p>At this point, a new folder has been created that we can use. We will want to be able to push it back to GitHub, and for that we will need to use a Personal Access Token (PAT) to link our RStudio Workspace with our GitHub account. We use <code>usethis</code> and <code>gitcreds</code> to enable this. These are, respectively, a package that automates repetitive tasks, and a package that authenticates with GitHub. To create a PAT, while signed into GitHub in the browser, and after installing and loading <code>usethis</code> run <code>create_github_token()</code> in your R session. GitHub will open in the browser with various options filled out (<a href="#fig-githubpat">Figure&nbsp;<span>3.6 (d)</span></a>). It can be useful to give the PAT an informative name by replacing “Note”, for instance “PAT for RStudio”, then click “Generate token”.</p>
<p>We only have one chance to copy this token, and if we make a mistake then we will need to generate a new one. Do not include the PAT in any R script or Quarto document. Instead, after installing and loading <code>gitcreds</code>, run <code>gitcreds_set()</code>, which will then prompt you to add your PAT in the console.</p>
<p>To use GitHub for a project that we are actively working on we follow this procedure:</p>
<ol type="1">
<li>The first thing to do is almost always to get any changes with “pull”. To do this, open the Git pane in RStudio, and click the blue down arrow. This gets any changes to the folder, as it is on GitHub, into our own version of the folder.</li>
<li>We can then make our changes to our copy of the folder. For instance, we could update the README, and then save it as normal.</li>
<li>Once this is done, we need to add, commit, and push. In the Git pane in RStudio, select the files to be added. This adds them to the staging area. Then click “Commit” (<a href="#fig-githubadd">Figure&nbsp;<span>3.6 (e)</span></a>). A new window will open. Add an informative message about the change that was made, and then click “Commit” in that new window (<a href="#fig-githubcommit">Figure&nbsp;<span>3.6 (f)</span></a>). Finally, click “Push” to send the changes to GitHub.</li>
</ol>
<p>There are a few common pain-points when it comes to Git and GitHub. We recommend committing and pushing regularly, especially when you are new to version control. This increases the number of snapshots that you could come back to if needed. All commits should have an informative commit message. If you are new to version control, then the expectation of a good commit message is that it contains a short summary of the change, followed by a blank line, and then an explanation of the change including what the change is, and why it is being made. For instance, if your commit adds graphs to a paper, then a commit message could be:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Add graphs</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>Graphs of unemployment and inflation added into Data section.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There is some evidence of a relationship between overall quality and commit behavior <span class="citation" data-cites="sprint2019mining">(<a href="99-references.html#ref-sprint2019mining" role="doc-biblioref">Sprint and Conci 2019</a>)</span>. As you get more experience ideally the commit messages will act as a kind of journal of the project. But the main thing is to commit regularly.</p>
<p>Git and GitHub were designed for software developers, rather than data scientists. GitHub limits the size of the files it will consider to 100MB, and even 50MB can prompt a warning. Data science projects regularly involve datasets that are larger than this. In <a href="10-store_and_share.html"><span>Chapter&nbsp;10</span></a> we discuss the use of data deposits, which can be especially useful when a project is completed, but when we are actively working on a project it can be useful to ignore large data files, at least as far as Git and GitHub are concerned. We do this using a “.gitignore” file, in which we list all of the files that we do not want to track using Git. The <a href="https://github.com/RohanAlexander/starter_folder">example folder</a> contains a “.gitignore” file. And it can be helpful to run <code>git_vaccinate()</code> from <code>usethis</code>, which will add a variety of files to a global “.gitignore” file in case you forget to do it on a project basis. Mac users will find it useful that this will cause “.DS_Store” files to be ignored.</p>
<p>We used the Git pane in RStudio which removed the need to use the Terminal, but it did not remove the need to go to GitHub and set up a new project. Having set up Git and GitHub, we can further improve this aspect of our workflow with <code>usethis</code>.</p>
<p>First check that Git is set up with <code>git_sitrep()</code> from <code>usethis</code>. This should print information about the username and email. We can use <code>use_git_config()</code> to update these details if needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git_config</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">user.name =</span> <span class="st">"Rohan Alexander"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">user.email =</span> <span class="st">"rohan.alexander@utoronto.ca"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rather than starting a new project in GitHub, and then adding it locally, we can now use <code>use_git()</code> to initiate it and commit the files. Having committed, we can use <code>use_github()</code> to push to GitHub, which will create the folder on GitHub as well.</p>
<p>It is normal to be intimidated by Git and GitHub. Many data scientists only know a little about how to use it, and that is okay. Try to push regularly so that you have a recent snapshot in case you need it.</p>
</section>
</section>
<section id="using-r-in-practice" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="using-r-in-practice"><span class="header-section-number">3.5</span> Using R in practice</h2>
<section id="sec-dealingwitherrors" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="sec-dealingwitherrors"><span class="header-section-number">3.5.1</span> Dealing with errors</h3>
<blockquote class="blockquote">
<p>When you are programming, eventually your code will break, when I say eventually, I mean like probably 10 or 20 times a day.</p>
<p><span class="citation" data-cites="sharlatalks">Gelfand (<a href="99-references.html#ref-sharlatalks" role="doc-biblioref">2021</a>)</span></p>
</blockquote>
<p>Everyone who uses R, or any programming language for that matter, has trouble find them at some point. This is normal. Programming is hard. At some point code will not run or will throw an error. This happens to everyone. It is common to get frustrated, but to move forward we develop strategies to work through the issues:</p>
<ol type="1">
<li>If you are getting an error message, then sometimes it will be useful. Try to read it carefully to see if there is anything of use in it.</li>
<li>Try to search for the error message. It can be useful to include “tidyverse” or “in R” in the search to help make the results more appropriate. Sometimes Stack Overflow results can be useful.</li>
<li>Look at the help file for the function by putting “?” before the function, for instance, <code>?pivot_wider()</code>. A common issue is to use a slightly incorrect argument name or format, such as accidentally including a string instead of an object name.</li>
<li>Look at where the error is happening and remove or comment out code until the error is resolved, and then slowly add code back again.</li>
<li>Check the class of the object with <code>class()</code>, for instance, <code>class(data_set$data_column)</code>. Ensure that it is what is expected.</li>
<li>Restart R: “Session” <span class="math inline">\(\rightarrow\)</span> “Restart R and Clear Output”. Then load everything again.</li>
<li>Restart your computer.</li>
<li>Search for what you are trying to do, rather than the error, being sure to include “tidyverse” or “in R” in the search to help make the results more appropriate. For instance, “save PDF of graph in R using ggplot”. Sometimes there are relevant blog posts or Stack Overflow answers that will help.</li>
<li>Make a small, self-contained, reproducible example “reprex” to see if the issue can be isolated and to enable others to help.</li>
</ol>
<p>More generally, while this is not always possible, it is almost always helpful to take a break and come back the next day.</p>
</section>
<section id="sec-omgpleasemakeareprexplease" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="sec-omgpleasemakeareprexplease"><span class="header-section-number">3.5.2</span> Reproducible examples</h3>
<blockquote class="blockquote">
<p>No one can advise or help you—no one. There is only one thing you should do. Go into yourself.</p>
<p><span class="citation" data-cites="rilke">Rilke (<a href="99-references.html#ref-rilke" role="doc-biblioref">[1929] 2014</a>)</span></p>
</blockquote>
<p>Asking for help is a skill like any other. We get better at it with practice. It is important to try not to say “this doesn’t work”, “I tried everything”, “your code does not work”, or “here is the error message, what do I do?”. In general, it is not possible to help based on these comments, because there are too many possible issues. You need to make it easy for others to help you. This involves a few steps.</p>
<ol type="1">
<li>Provide a small, self-contained example of your data, and code, and detail what is going wrong.</li>
<li>Document what you have tried so far, including which Stack Overflow and Posit Forum posts you looked at, and why they are not what you are after.</li>
<li>Be clear about the outcome that you would like.</li>
</ol>
<p>Begin by creating a minimal REPRoducible EXample—a “reprex”. This is code that contains what is needed to reproduce the error, but only what is needed. This means that the code is likely a smaller, simpler version that nonetheless reproduces the error.</p>
<p>Sometimes this process enables one to solve the problem. If it does not, then it gives someone else a fighting chance of being able to help. There is almost no chance that you have got a problem that someone has not addressed before. It is more likely that the main difficulty is trying to communicate what you want to do and what is happening, in a way that allows others to recognize both. Developing tenacity is important.</p>
<p>To develop reproducible examples, <code>reprex</code> is especially useful. After installing it we:</p>
<ol type="1">
<li>Load the <code>reprex</code> package: <code>library(reprex)</code>.</li>
<li>Highlight and copy the code that is giving issues.</li>
<li>Run <code>reprex()</code> in the console.</li>
</ol>
<p>If the code is self-contained, then it will preview in the viewer. If it is not, then it will error, and you should rewrite the code so that it is self-contained.</p>
<p>If you need data to reproduce the error, then you should use data that is built into R. There are a large number of datasets that are built into R and can be seen using <code>library(help = "datasets")</code>. But if possible, you should use a common option such as <code>mtcars</code> or <code>faithful</code>. Combining a reprex with a GitHub Gist that was introduced in <a href="02-drinking_from_a_fire_hose.html"><span>Chapter&nbsp;2</span></a> increases the chances that someone is able to help you.</p>
</section>
<section id="mentality" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="mentality"><span class="header-section-number">3.5.3</span> Mentality</h3>
<blockquote class="blockquote">
<p>(Y)ou are a real, valid, <em>competent</em> user and programmer no matter what IDE you develop in or what tools you use to make your work work for you</p>
<p>(L)et’s break down the gates, there’s enough room for everyone</p>
<p>Sharla Gelfand, 10 March 2020.</p>
</blockquote>
<p>If you write code, then you are a programmer, regardless of how you do it, what you are using it for, or who you are. But there are a few traits that one tends to notice great programmers have in common.</p>
<ul>
<li><strong>Focused:</strong> Often having an aim to “learn R” or similar tends to be problematic, because there is no real end point to that. It tends to be more efficient to have smaller, more specific goals, such as “make a histogram about the 2022 Australian Election with <code>ggplot2</code>”. This is something that can be focused on and achieved in a few hours. The issue with goals that are more nebulous, such as “I want to learn R”, is that it is easier to get lost on tangents and more difficult to get help. This can be demoralizing and lead to people quitting too early.</li>
<li><strong>Curious:</strong> It is almost always useful to “have a go”; that is, if you are not sure, then just try it. In general, the worst that happens is that you waste your time. You can rarely break something irreparably. For instance, if you want to know what happens if you pass a vector instead of a dataframe to <code>ggplot()</code> then try it.</li>
<li><strong>Pragmatic:</strong> At the same time, it can be useful to stick within reasonable bounds, and make one small change each time. For instance, say you want to run some regressions, and are curious about the possibility of using <code>rstanarm</code> instead of <code>lm()</code>. A pragmatic way to proceed is to use one aspect from <code>rstanarm</code> initially and then make another change next time.</li>
<li><strong>Tenacious:</strong> Again, this is a balancing act. Unexpected problems and issues arise with every project. On the one hand, persevering despite these is a good tendency. But on the other hand, sometimes one does need to be prepared to give up on something if it does not seem like a break through is possible. Mentors can be useful as they tend to be a better judge of what is reasonable.</li>
<li><strong>Planned:</strong> It is almost always useful to excessively plan what you are going to do. For instance, you may want to make a histogram of some data. You should plan the steps that are needed and even sketch out how each step might be implemented. For instance, the first step is to get the data. What packages might be useful? Where might the data be? What is the back-up plan if the data do not exist there?</li>
<li><strong>Done is better than perfect:</strong> We all have various perfectionist tendencies, but it can be useful to initially try to turn them off to a certain extent. Initially just worry about writing code that works. You can always come back and improve aspects of it. But it is important to actually ship. Ugly code that gets the job done is better than beautiful code that is never finished.</li>
</ul>
</section>
<section id="code-comments-and-style" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="code-comments-and-style"><span class="header-section-number">3.5.4</span> Code comments and style</h3>
<p>Code must be commented. Comments should focus on why certain code was written and to a lesser extent, why a common alternative was not selected. Indeed, it can be a good idea to write the comments before you write the code, explaining what you want to do and why, and then returning to write the code <span class="citation" data-cites="refactoringbook">(<a href="99-references.html#ref-refactoringbook" role="doc-biblioref">Fowler and Beck 2018, 59</a>)</span>.</p>
<p>There is no one way to write code, especially in R. However, there are some general guidelines that will make it easier for you even if you are just working on your own. Most projects will evolve over time, and one purpose of code comments is to enable future-you to retrace what was done and why certain decisions were made <span class="citation" data-cites="bowers2016improve">(<a href="99-references.html#ref-bowers2016improve" role="doc-biblioref">Bowers and Voors 2016</a>)</span>.</p>
<p>Comments in R scripts can be added by including the # symbol. (The behavior of # is different for lines inside an R chunk in a Quarto document where it acts as a comment, compared with lines outside an R chunk where it sets heading levels.) We do not have to put a comment at the start of the line, it can be midway through. In general, you do not need to comment what every aspect of your code is doing but you should comment parts that are not obvious. For instance, if we read in some value then we may like to comment where it is coming from.</p>
<p>You should try to comment why you are doing something <span class="citation" data-cites="tidyversestyleguide">(<a href="99-references.html#ref-tidyversestyleguide" role="doc-biblioref">Wickham 2021</a>)</span>. What are you trying to achieve? You must comment to explain weird things. Like if you are removing some specific row, say row 27, then why are you removing that row? It may seem obvious in the moment, but future-you will not remember.</p>
<p>You should break your code into sections. For instance, setting up the workspace, reading in datasets, manipulating and cleaning the datasets, analyzing the datasets, and finally producing tables and figures. Each of these should be separated with comments explaining what is going on, and sometimes into separate files, depending on the length.</p>
<p>Additionally, at the top of each file it is important to note basic information, such as the purpose of the file, and prerequisites or dependencies, the date, the author and contact information, and finally any red flags or todos.</p>
<p>Your R scripts should have a preamble and a clear demarcation of sections.</p>
<pre><code>#### Preamble ####
# Purpose: Brief sentence about what this script does
# Author: Your name
# Date: The date it was written
# Contact: Add your email
# License: Think about how your code may be used
# Pre-requisites: 
# - Maybe you need some data or some other script to have been run?


#### Workspace setup ####
# do not keep install.packages lines; comment out if need be
# Load packages
library(tidyverse)

# Read in the unedited data. 
raw_data &lt;- read_csv("inputs/data/unedited_data.csv")


#### Next section ####
...
</code></pre>
<p>Finally, try not to rely on a user commenting and uncommenting code, or any other manual step, such as directory specification, for code to work. This will preclude the use of automated code checking and testing.</p>
<p>This all takes time. As a rough rule of thumb, you should expect to spend at least as much time commenting and improving your code as you spent writing it. Some examples of nicely commented code include <span class="citation" data-cites="AhadyDolatsara2021">Dolatsara et al. (<a href="99-references.html#ref-AhadyDolatsara2021" role="doc-biblioref">2021</a>)</span> and <span class="citation" data-cites="burton2021reconsidering">Burton, Cruz, and Hahn (<a href="99-references.html#ref-burton2021reconsidering" role="doc-biblioref">2021</a>)</span>.</p>
</section>
<section id="tests" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="tests"><span class="header-section-number">3.5.5</span> Tests</h3>
<p>Tests should be written throughout the code, and you need to write them as we go, not all at the end. This will slow you down. But it will help you to think, and to fix mistakes, which will make your code better and lead to better overall productivity. Code without tests should be viewed with suspicion. There is room for improvement when it comes to testing practices in R packages <span class="citation" data-cites="Vidoni2021">(<a href="99-references.html#ref-Vidoni2021" role="doc-biblioref">Vidoni 2021</a>)</span>, let alone R code more generally.</p>
<p>The need for other people, and ideally, automated processes, to run tests on code is one reason that we emphasize reproducibility. That is also why we emphasize smaller aspects such as not hardcoding file-paths, using projects, and not having spaces in file names.</p>
<p>It is difficult to define a complete and general suite of tests, but broadly we want to test:</p>
<ol type="1">
<li>boundary conditions,</li>
<li>classes,</li>
<li>missing data,</li>
<li>the number of observations and variables,</li>
<li>duplicates, and</li>
<li>regression results.</li>
</ol>
<p>We do all this initially on our simulated data and then move to the real data. It is possible to write an infinite number of tests but a smaller number of high-quality tests is better than many thoughtless tests.</p>
<p>One type of test is an “assertion”. Assertions are written throughout the code to check whether something is true and stop the code from running if not <span class="citation" data-cites="researchsoftware">(<a href="99-references.html#ref-researchsoftware" role="doc-biblioref">Irving et al. 2021, 272</a>)</span>. For instance, you might assert that a variable should be numeric. If it was tested against this assertion and found to be a character, then the test would fail and the script would stop running. Assertion tests in data science will typically be used in data cleaning and preparation scripts. We have more to say about these in <a href="09-clean_and_prepare.html"><span>Chapter&nbsp;9</span></a>. Unit tests check some complete aspect of code <span class="citation" data-cites="researchsoftware">(<a href="99-references.html#ref-researchsoftware" role="doc-biblioref">Irving et al. 2021, 274</a>)</span>. We will consider them more in <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a> when we consider modeling.</p>
</section>
</section>
<section id="efficiency" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="efficiency"><span class="header-section-number">3.6</span> Efficiency</h2>
<p>Generally in this book we are, and will continue to be, concerned with just getting something done. Not necessarily getting it done in the best or most efficient way, because to a large extent, being worried about that is a waste of time. For the most part one is better off just pushing things into the cloud, letting them run for a reasonable time, and using that time to worry about other aspects of the pipeline. But that eventually becomes unfeasible. At a certain point, and this differs depending on context, efficiency becomes important. Eventually ugly or slow code, and dogmatic insistence on a particular way of doing things, have an effect. And it is at that point that one needs to be open to new approaches to ensure efficiency. There is rarely a most common area for obvious performance gains. Instead, it is important to develop the ability to measure, evaluate, and think.</p>
<p>One of the best ways to improve the efficiency of our code is preparing it in such a way that we can bring in a second pair of eyes. To make the most of their time, it is important that our code easy to read. So we start with “code linting” and “styling”. This does not speed up our code, per se, but instead makes it more efficient when another person comes to it, or we revisit it. This enables formal code review and refactoring, which is where we rewrite code to make it better, while not changing what it does (it does the same thing, but in a different way). We then turn to measurement of run time, and introduce parallel processing, where we allow our computer to run code for multiple processes at the same time</p>
<section id="sharing-a-code-environment" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="sharing-a-code-environment"><span class="header-section-number">3.6.1</span> Sharing a code environment</h3>
<p>We have discussed at length the need to share code, and we have put forward an approach to this using GitHub. And in <a href="10-store_and_share.html"><span>Chapter&nbsp;10</span></a>, we will discuss sharing data. But, there is another requirement to enable other people to run our code. In <a href="02-drinking_from_a_fire_hose.html"><span>Chapter&nbsp;2</span></a> we discussed how R itself, as well as R packages update from time to time, as new functionality is developed, errors fixed, and other general improvements made. <a href="20-r_essentials.html">Online Appendix&nbsp;<span>A</span></a> describes how one advantage of the <code>tidyverse</code> is that it can update faster than base R, because it is more specific. But this could mean that even if we were to share all the code and data that we use, it is possible that the software versions that have become available would cause errors.</p>
<p>The solution to this is to detail the environment that was used. There are a large number of ways to do this, and they can add complexity. We just focus on documenting the version of R and R packages that were used, and making it easier for others to install that exact version. We use <code>renv</code> to do this.</p>
<p>Once <code>renv</code> is installed and loaded, we use <code>init()</code> to get the infrastructure set-up that we will need. We are going to create a file that will record the packages and versions used. We then use <code>snapshot()</code> to actually document what we are using. This creates a “lockfile” that records the information.</p>
<p>If we want to see which packages we are using in the R Project, then we can use <code>dependencies()</code>. Doing this for the <a href="https://github.com/RohanAlexander/starter_folder">example folder</a> indicates that the following packages are used: <code>rmarkdown</code>, <code>bookdown</code>, <code>knitr</code>, <code>rmarkdown</code>, <code>bookdown</code>, <code>knitr</code>, <code>palmerpenguins</code>, <code>tidyverse</code>, <code>renv</code>, <code>haven</code>, <code>readr</code>, and <code>tidyverse</code>.</p>
<p>We could open the lockfile file—“renv.lock”—to see the exact versions if we wanted. The lockfile also documents all the other packages that were installed and where they were downloaded from. Someone coming to this project from outside could then use <code>restore()</code> which would install the exact version of the packages that we used.</p>
</section>
<section id="code-linting-and-styling" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="code-linting-and-styling"><span class="header-section-number">3.6.2</span> Code linting and styling</h3>
<p>Being fast is valuable but it is mostly about being able to iterate fast, not necessarily having code that runs fast. <span class="citation" data-cites="oldlanguages">Backus (<a href="99-references.html#ref-oldlanguages" role="doc-biblioref">1981, 26</a>)</span> describes how even in 1954 a programmer cost at least as much as a computer, and these days additional computational power is usually much cheaper than a programmer. Performant code is important, but it is also important to use other people’s time efficiently. Code is rarely only written once. Instead we typically have to come back to it, even if to just fix mistakes, and this means that code must be able to be read by humans <span class="citation" data-cites="beautifulcode">(<a href="99-references.html#ref-beautifulcode" role="doc-biblioref">Matsumoto 2007, 478</a>)</span>. If this is not done then there will be an efficiency cost.</p>
<p>Linting and styling is the process of checking code, mostly for stylistic issues, and re-arranging code to make it easier to read. (There is another aspect of linting, which is dealing with programming errors, such as forgetting a closing bracket, but here we focus on stylistic issues.) Often the best efficiency gain comes from making it easier for others to read our code, even if this is just ourselves returning to the code after a break. Jane Street, a US proprietary trading firm, places a very strong focus on ensuring their code is readable, as a core part of risk mitigation <span class="citation" data-cites="minsky2011ocaml">(<a href="99-references.html#ref-minsky2011ocaml" role="doc-biblioref">Minsky 2011</a>)</span>. While we may not all have billions of dollars under the potentially mercurial management of code, we all would likely prefer that our code does not produce errors.</p>
<p>We use <code>lint()</code> from <code>lintr</code> to lint our code. For instance, consider the following R code (saved as “linting_example.R”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>SIMULATED_DATA <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">division =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>, <span class="dv">151</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> <span class="fu">sample</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Liberal"</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">151</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace =</span> T</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lint</span>(<span class="at">filename =</span> <span class="st">"linting_example.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The result is that the file “linting_example.R” is opened and the issues that <code>lint()</code> found are printed in “Markers” (<a href="#fig-linter">Figure&nbsp;<span>3.7</span></a>). It is then up to you to deal with the issues.</p>
<div id="fig-linter" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/linter.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.7: Linting results from example R code</figcaption><p></p>
</figure>
</div>
<p>Making the recommended changes results in code that is more readable, and consistent with best practice, as defined by <span class="citation" data-cites="tidyversestyleguide">Wickham (<a href="99-references.html#ref-tidyversestyleguide" role="doc-biblioref">2021</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">division =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>, <span class="dv">151</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> <span class="fu">sample</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Liberal"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">151</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At first it may seem that some aspects that the linter is identifying, like trailing whitespace and only using double quotes are small and inconsequential. But they distract from being able to fix bigger issues. Further, if we are not able to get small things right, then how could anyone trust that we could get the big things right? Therefore, it is important to have dealt with all the small aspects that a linter identifies.</p>
<p>In addition to <code>lintr</code> we also use <code>styler</code>. This will automatically adjust style issues, in contrast to the linter, which gave a list of issues to look at. To run this we use <code>style_file()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">style_file</span>(<span class="at">path =</span> <span class="st">"linting_example.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will automatically make changes, such as spacing and indentation. As such this should be done regularly, rather than only once at the end of a project, so as to be able to review the changes and make sure no errors have been introduced.</p>
</section>
<section id="code-review" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="code-review"><span class="header-section-number">3.6.3</span> Code review</h3>
<p>Having dealt with all of these aspects of style, we can turn to code review. This is the process of having another person go through and critique the code. Code review is a critical part of writing code, and <span class="citation" data-cites="researchsoftware">Irving et al. (<a href="99-references.html#ref-researchsoftware" role="doc-biblioref">2021, 465</a>)</span> describe it as “the most effective way to find bugs”. It is especially helpful, although quite daunting, when learning to code because getting feedback is a great way to improve.</p>
<p>Go out of your way to be polite and collegial when reviewing another person’s code. Small aspects to do with style, things like spacing and separation, should have been taken care of by a linter and styler, but if not, then make a general recommendation about that. Most of your time as a code reviewer in data science should be spent on aspects such as:</p>
<ol type="1">
<li>Is there an informative README and how could it be improved?</li>
<li>Are the file names and variable names consistent, informative, and meaningful?</li>
<li>Do the comments allow you to understand why something is being done?</li>
<li>Are the tests both appropriate and sufficient? Are there edge cases or corner solutions that are not considered? Similarly, are there unnecessary tests that could be removed?</li>
<li>Are there magic numbers that could be changed to variables and explained?</li>
<li>Is there duplicated code that could be changed?</li>
<li>Are there any outstanding warnings that should be addressed?</li>
<li>Are there any especially large functions or pipes that could be separated into smaller ones?</li>
<li>Is the structure of the project appropriate?</li>
<li>Can we change any of the code to data <span class="citation" data-cites="researchsoftware">(<a href="99-references.html#ref-researchsoftware" role="doc-biblioref">Irving et al. 2021, 462</a>)</span>?</li>
</ol>
<p>For instance, consider some code that looked for the names of prime ministers and presidents. When we first wrote this code we likely added the relevant names directly into the code. But as part of code review, we might instead recommend that this be changed. We might recommend creating a small dataset of relevant names, and then re-writing the code to have it look up that dataset.</p>
<p>Code review ensures that the code can be understood by at least one other person. This is a critical part of building knowledge about the world. At Google, code review is not primarily about finding defects, although that may happen, but is instead about ensuring readability and maintainability as well as education <span class="citation" data-cites="codereview">(<a href="99-references.html#ref-codereview" role="doc-biblioref">Sadowski et al. 2018</a>)</span>. This is also the case at Jane Street where they use code review to catch bugs, share institutional knowledge, assist with training, and oblige staff to write code that can be read <span class="citation" data-cites="ocamlyaronpodcast">(<a href="99-references.html#ref-ocamlyaronpodcast" role="doc-biblioref">Minsky 2015</a>)</span>.</p>
<p>Finally, code review does not have to, and should not, be an onerous days-consuming process of reading all the code. The best code review is a quick review of just one file, focused on suggesting changes to just a handful of lines. Indeed, it may be better to have a review done by a small team of people rather than one individual. Do not review too much code at any one time. At most a few hundred lines, which should take around an hour, because any more than that has been found to be associated with reduced efficacy <span class="citation" data-cites="cohen2006best">(<a href="99-references.html#ref-cohen2006best" role="doc-biblioref">Cohen, Teleki, and Brown 2006, 79</a>)</span>.</p>
</section>
<section id="code-refactoring" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="code-refactoring"><span class="header-section-number">3.6.4</span> Code refactoring</h3>
<p>To refactor code means to rewrite it so that the new code achieves the same outcome as the old code, but the new code does it better. For instance, <span class="citation" data-cites="refactornature">Chawla (<a href="99-references.html#ref-refactornature" role="doc-biblioref">2020</a>)</span> discuss how the code underpinning an important UK Covid model was initially written by epidemiologists, and months later clarified and cleaned up by a team from the Royal Society, Microsoft, and GitHub. This was valuable because it provided more confidence in the model, even though both versions produced the same outputs, given the same inputs.</p>
<p>We typically refer to code refactoring in relation to code that someone else wrote. (Although it may be that we actually wrote the code, and it was just that it was some time ago.) When we start to refactor code, we want to make sure that the rewritten code achieves the same outcomes as the original code. This means that we need a suite of appropriate tests written that we can depend on. If these do not exist, then we may need to create them.</p>
<p>We rewrite code to make it easier for others to understand, which in turn allows more confidence in our conclusions. But before we can do that, we need to understand what the existing code is doing. One way to get started is to go through the code and add extensive comments. These comments are different to normal comments. They are our active process of trying to understand what is each code chunk trying to do and how could this be improved.</p>
<p>Refactoring code is an opportunity to ensure that it satisfies best practice. <span class="citation" data-cites="Trisovic2022">Trisovic et al. (<a href="99-references.html#ref-Trisovic2022" role="doc-biblioref">2022</a>)</span> details some core recommendations based on examining 9,000 R scripts including:</p>
<ol type="1">
<li>Remove <code>setwd()</code> and any absolute paths, and ensure that only relative paths, in relation to the “.Rproj” file, are used.</li>
<li>Ensure there is a clear order of execution. We have recommended using numbers in filenames to achieve this initially, but eventually more sophisticated approaches, such as <code>targets</code> <span class="citation" data-cites="targets">(<a href="99-references.html#ref-targets" role="doc-biblioref">Landau 2021</a>)</span>, could be used instead.</li>
<li>Ensure that code can run on a different computer.</li>
</ol>
<p>For instance, consider the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/rohanalexander/Documents/telling_stories"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"cars.csv"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">=</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  mtcars <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">K_P_L =</span> mpg <span class="sc">/</span> <span class="fl">2.352</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>datasaurus_dozen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We could change that, starting by creating an R Project which enables us to remove <code>setwd()</code>, grouping all the <code>library()</code> calls at the top, using “&lt;-” instead of “=”, and being consistent with variable names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>cars_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"cars.csv"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>mpg_to_kpl_conversion_factor <span class="ot">&lt;-</span> <span class="fl">2.352</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  mtcars <span class="sc">|&gt;</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kpl =</span> mpg <span class="sc">/</span> mpg_to_kpl_conversion_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parallel-processing" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="parallel-processing"><span class="header-section-number">3.6.5</span> Parallel processing</h3>
<p>Sometimes code is slow because the computer needs to do the same thing many times. We may be able to take advantage of this and enable these jobs to be done at the same time using parallel processing. This will be especially useful starting from <a href="12-ijalm.html"><span>Chapter&nbsp;12</span></a> for modeling.</p>
<p>After installing and loading <code>tictoc</code> we can use <code>tic()</code> and <code>toc()</code> to time various aspects of our code. This is useful with parallel processing, but also more generally, to help us find out where the largest delays are.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">"First bit of code"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Fast code"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fast code"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First bit of code: 0.003 sec elapsed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>(<span class="st">"Second bit of code"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">3</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Slow code"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Slow code"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Second bit of code: 3.007 sec elapsed</code></pre>
</div>
</div>
<p>And so we know that there is something slowing down the code. (In this artificial case it is <code>Sys.sleep()</code> causing a delay of three seconds.)</p>
<p>We could use <code>parallel</code> which is part of base R to run functions in parallel. We could also use <code>future</code> which brings additional features. After installing and loading <code>future</code> we use <code>plan()</code> to specify whether we want to run things sequentially (“sequential”) or in parallel (“multisession”). We then wrap what we want this applied to within <code>future()</code>.</p>
<p>To see this in action we will create a dataset and then implement a function on a row-wise basis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">random_draws =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">more_random_draws =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  simulated_data <span class="sc">|&gt;</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">which_is_smaller =</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">min</span>(<span class="fu">c</span>(random_draws,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                 more_random_draws)))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">future</span>(simulated_data <span class="sc">|&gt;</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">which_is_smaller =</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">min</span>(<span class="fu">c</span>(</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>                      random_draws,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                      more_random_draws</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                    ))))</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sequential approach takes about 5 seconds, while the multisession approach takes about 0.3 seconds.</p>
</section>
</section>
<section id="concluding-remarks" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="concluding-remarks"><span class="header-section-number">3.7</span> Concluding remarks</h2>
<p>In this chapter we have covered a lot of ground and it is normal to be overwhelmed. Come back to the Quarto section as needed. Many people are confused by Git and Github and just know enough to get by. And while there was a lot of material in efficiency, the most important aspect of performant code is making it easier for another person to read it, even if that person is just yourself returning after a break.</p>
</section>
<section id="exercises" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="exercises"><span class="header-section-number">3.8</span> Exercises</h2>
<section id="scales" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="scales">Scales</h3>
<ol type="1">
<li><em>(Plan)</em> Consider the following scenario: <em>In a certain country there are only ever four parties that could win a seat in parliament. Whichever candidate has a plurality of votes in the area associated with a given seat wins that seat. The parliament is made up of 175 total seats. An analyst is interested in the number of votes for each party by seat.</em> Please sketch what that dataset could look like, and then sketch a graph that you could build to show all observations.</li>
<li><em>(Simulate I)</em> Please further consider the scenario described, and decide which of the following could be used to simulate the situation (select all that apply)?
<ol type="a">
<li><code>tibble(seat = rep(1:175, each = 4), party = rep(x = 1:4, times = 175), votes = runif(n = 175 * 4, min = 0, max = 1000) |&gt; floor())</code></li>
<li><code>tibble(seat = rep(1:175, each = 4), party = sample(x = 1:4, size = 175, replace = TRUE), votes = runif(n = 175 * 4, min = 0, max = 1000) |&gt; floor())</code></li>
<li><code>tibble(seat = rep(1:175, each = 4), party = rep(x = 1:4, times = 175), votes = sample(x = 1:1000, size = 175 * 4))</code></li>
<li><code>tibble(seat = rep(1:175, each = 4), party = sample(x = 1:4, size = 175, replace = TRUE), votes = sample(x = 1:1000, size = 175 * 4))</code></li>
</ol></li>
<li><em>(Simulate II)</em> Please write three tests based on this simulation.</li>
<li><em>(Acquire)</em> Please identify one possible source of actual data about voting in a country of interest to you.</li>
<li><em>(Explore)</em> Assume that the <code>tidyverse</code> is loaded and the dataset “election_results” has the columns “seat”, “party”, and “votes”, as in the earlier question. Which of the following would result in a count of the number of seats won by each party (pick one)?
<ol type="a">
<li><code>election_results |&gt; slice_max(votes, n = 1, by = seat) |&gt; count(party)</code></li>
<li><code>election_results |&gt; slice_max(votes, n = 1, by = party) |&gt; count(seat)</code></li>
<li><code>election_results |&gt; slice_max(votes, n = 1, by = party) |&gt; count(party)</code></li>
<li><code>election_results |&gt; slice_max(votes, n = 1, by = seat) |&gt; count(seat)</code></li>
</ol></li>
<li><em>(Communicate)</em> Please write two paragraphs as if you had gathered data from that source and built a graph. The exact details contained in the paragraphs do not have to be factual (i.e.&nbsp;you do not actually have to get the data nor create the graphs).</li>
</ol>
</section>
<section id="questions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="questions">Questions</h3>
<ol type="1">
<li>According to <span class="citation" data-cites="Alexander2019">Alexander (<a href="99-references.html#ref-Alexander2019" role="doc-biblioref">2019</a>)</span> research is reproducible if (pick one)?
<ol type="a">
<li>It is published in peer-reviewed journals.</li>
<li>All of the materials used in the study are provided.</li>
<li>It can be reproduced exactly without the authors providing materials.</li>
<li>It can be reproduced exactly, given all the materials used in the study.</li>
</ol></li>
<li>Which of the following are components of the project layout recommended by <span class="citation" data-cites="wilsongoodenough">Wilson et al. (<a href="99-references.html#ref-wilsongoodenough" role="doc-biblioref">2017</a>)</span> (select all that apply)?
<ol type="a">
<li>requirements.txt</li>
<li>doc</li>
<li>data</li>
<li>LICENSE</li>
<li>CITATION</li>
<li>README</li>
<li>src</li>
<li>results</li>
</ol></li>
<li>Based on <span class="citation" data-cites="monicatalks">Alexander (<a href="99-references.html#ref-monicatalks" role="doc-biblioref">2021</a>)</span> please write a paragraph about some of the barriers you overcame, or still face, with regard to sharing code that you wrote.</li>
<li>According to <span class="citation" data-cites="tidyversestyleguide">Wickham (<a href="99-references.html#ref-tidyversestyleguide" role="doc-biblioref">2021</a>)</span> for naming files, how would the files “00_get_data.R” and “get data.R” be classified (pick one)?
<ol type="a">
<li>bad; bad.</li>
<li>good; bad.</li>
<li>bad; good.</li>
<li>good; good.</li>
</ol></li>
<li>Which of the following would result in bold text in Quarto (pick one)?
<ol type="a">
<li><code>**bold**</code></li>
<li><code>##bold##</code></li>
<li><code>*bold*</code></li>
<li><code>#bold#</code></li>
</ol></li>
<li>Which option would hide the warnings in a Quarto R chunk (pick one)?
<ol type="a">
<li><code>echo: false</code></li>
<li><code>eval: false</code></li>
<li><code>warning: false</code></li>
<li><code>message: false</code></li>
</ol></li>
<li>Which options would run the R code chunk and display the results, but not show the code in a Quarto R chunk (pick one)?
<ol type="a">
<li><code>echo: false</code></li>
<li><code>include: false</code></li>
<li><code>eval: false</code></li>
<li><code>warning: false</code></li>
<li><code>message: false</code></li>
</ol></li>
<li>Why are R Projects important (select all that apply)?
<ol type="a">
<li>They help with reproducibility.</li>
<li>They make it easier to share code.</li>
<li>They make your workspace more organized.</li>
</ol></li>
<li>Assuming the packages and datasets have been loaded, what is the mistake in this code: <code>DoctorVisits |&gt; filter(visits)</code> (pick one)?
<ol type="a">
<li><code>visits</code></li>
<li><code>DoctorVisits</code></li>
<li><code>filter</code></li>
<li><code>|&gt;</code></li>
</ol></li>
<li>What is a reprex and why is it important to be able to make one (select all that apply)?
<ol type="a">
<li>A reproducible example that enables your error to be reproduced.</li>
<li>A reproducible example that helps others help you.</li>
<li>A reproducible example during the construction of which you may solve your own problem.</li>
<li>A reproducible example that demonstrates you have actually tried to help yourself.</li>
</ol></li>
<li>According to <span class="citation" data-cites="sharlatalks">Gelfand (<a href="99-references.html#ref-sharlatalks" role="doc-biblioref">2021</a>)</span>, what is the key part of “If you need help getting unstuck, the first step is to create a reprex, or reproducible example. The goal of a reprex is to package your problematic code in such a way that other people can run it and feel your pain. Then, hopefully, they can provide a solution and put you out of your misery.” (pick one)?
<ol type="a">
<li>package your problematic code</li>
<li>other people can run it and feel your pain</li>
<li>the first step is to create a reprex</li>
<li>they can provide a solution and put you out of your misery</li>
</ol></li>
</ol>
<ol start="12" type="1">
<li>The following code produces an error. Please use <code>reprex</code> to build a reproducible example that you could use to get help with it, and submit the reprex using a GitHub Gist. You should simplify many aspects including reducing the number of packages, changing the dataset, and simplifying the <code>filter()</code> and <code>mutate()</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>oecd_gdp <span class="ot">&lt;-</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://stats.oecd.org/sdmx-json/data/DP_LIVE/.QGDP.../OECD?contentType=csv&amp;detail=code&amp;separator=comma&amp;csv-lang=en"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oecd_gdp)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="ot">&lt;-</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  oecd_gdp <span class="sc">|&gt;</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    TIME <span class="sc">==</span> <span class="st">"2021-Q3"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    SUBJECT <span class="sc">==</span> <span class="st">"TOT"</span>,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    LOCATION <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"AUS"</span>, <span class="st">"CAN"</span>, <span class="st">"CHL"</span>, <span class="st">"DEU"</span>, <span class="st">"GBR"</span>,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">"IDN"</span>, <span class="st">"ESP"</span>, <span class="st">"NZL"</span>, <span class="st">"USA"</span>, <span class="st">"ZAF"</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    MEASURE <span class="sc">==</span> <span class="st">"PC_CHGPY"</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">european =</span> <span class="fu">if_else</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>      LOCATION <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEU"</span>, <span class="st">"GBR"</span>, <span class="st">"ESP"</span>),</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"European"</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Not european"</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">hemisphere =</span> <span class="fu">if_else</span>(</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>      LOCATION <span class="sc">%in%</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"CAN"</span>, <span class="st">"DEU"</span>, <span class="st">"GBR"</span>, <span class="st">"ESP"</span>, <span class="st">"USA"</span>),</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Northern Hemisphere"</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Southern Hemisphere"</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value)) <span class="sc">|&gt;</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tutorial" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="tutorial">Tutorial</h3>
<p>Code review is an important part of working as a professional <span class="citation" data-cites="codereview">(<a href="99-references.html#ref-codereview" role="doc-biblioref">Sadowski et al. 2018</a>)</span>. Please put together a small Quarto file that downloads a dataset using <code>opendatatoronto</code>, cleans it, and makes a graph. Then exchange it with someone else. Following the advice of <span class="citation" data-cites="googlecoderview">Google (<a href="99-references.html#ref-googlecoderview" role="doc-biblioref">2022</a>)</span>, please provide them with a review of their code. That should be at least two pages of single-spaced content. Submit the review as a PDF.</p>
</section>
<section id="paper" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="paper">Paper</h3>
<p>At about this point the <em>Donaldson</em> Paper from <a href="23-assessment.html">Online Appendix&nbsp;<span>D</span></a> would be appropriate.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Alexander2019" class="csl-entry" role="listitem">
Alexander, Monica. 2019. <span>“Reproducibility in Demographic Research.”</span> <a href="https://www.monicaalexander.com/posts/2019-10-20-reproducibility/">https://www.monicaalexander.com/posts/2019-10-20-reproducibility/</a>.
</div>
<div id="ref-monicatalks" class="csl-entry" role="listitem">
———. 2021. <span>“Overcoming Barriers to Sharing Code.”</span> <em>YouTube</em>, February. <a href="https://youtu.be/yvM2C6aZ94k">https://youtu.be/yvM2C6aZ94k</a>.
</div>
<div id="ref-oldlanguages" class="csl-entry" role="listitem">
Backus, John. 1981. <span>“<span class="nocase">The History of FORTRAN I, II, and III</span>.”</span> In <em>History of Programming Languages</em>, edited by Richard Wexelblat, 25–74. Academic Press.
</div>
<div id="ref-barba2018terminologies" class="csl-entry" role="listitem">
Barba, Lorena. 2018. <span>“Terminologies for Reproducible Research.”</span> <a href="https://arxiv.org/abs/1802.03311">https://arxiv.org/abs/1802.03311</a>.
</div>
<div id="ref-future" class="csl-entry" role="listitem">
Bengtsson, Henrik. 2021. <span>“<span class="nocase">A Unifying Framework for Parallel and Distributed Processing in R using Futures</span>.”</span> <em>The R Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-bowers2016improve" class="csl-entry" role="listitem">
Bowers, Jake, and Maarten Voors. 2016. <span>“How to Improve Your Relationship with Your Future Self.”</span> <em>Revista de Ciencia Pol<span>ı́</span>tica</em> 36 (3): 829–48. <a href="https://doi.org/10.4067/S0718-090X2016000300011">https://doi.org/10.4067/S0718-090X2016000300011</a>.
</div>
<div id="ref-githistory" class="csl-entry" role="listitem">
Brown, Zack. 2018. <span>“A Git Origin Story.”</span> <em>Linux Journal</em>, July. <a href="https://www.linuxjournal.com/content/git-origin-story">https://www.linuxjournal.com/content/git-origin-story</a>.
</div>
<div id="ref-Bryan2018" class="csl-entry" role="listitem">
Bryan, Jenny. 2018a. <span>“Excuse Me, Do You Have a Moment to Talk about Version Control?”</span> <em>The American Statistician</em> 72 (1): 20–27. <a href="https://doi.org/10.1080/00031305.2017.1399928">https://doi.org/10.1080/00031305.2017.1399928</a>.
</div>
<div id="ref-codesmells" class="csl-entry" role="listitem">
———. 2018b. <span>“Code Smells and Feels.”</span> <em>YouTube</em>, July. <a href="https://youtu.be/7oyiPBjLAWY">https://youtu.be/7oyiPBjLAWY</a>.
</div>
<div id="ref-happygit" class="csl-entry" role="listitem">
———. 2020. <em><span class="nocase">Happy Git and GitHub for the useR</span></em>. <a href="https://happygitwithr.com">https://happygitwithr.com</a>.
</div>
<div id="ref-whattheyforgot" class="csl-entry" role="listitem">
Bryan, Jenny, and Jim Hester. 2020. <em><span class="nocase">What They Forgot to Teach You About R</span></em>. <a href="https://rstats.wtf/index.html">https://rstats.wtf/index.html</a>.
</div>
<div id="ref-reprex" class="csl-entry" role="listitem">
Bryan, Jenny, Jim Hester, David Robinson, Hadley Wickham, and Christophe Dervieux. 2022. <em><span class="nocase">reprex: Prepare Reproducible Example Code via the Clipboard</span></em>. <a href="https://CRAN.R-project.org/package=reprex">https://CRAN.R-project.org/package=reprex</a>.
</div>
<div id="ref-buckheit1995wavelab" class="csl-entry" role="listitem">
Buckheit, Jonathan, and David Donoho. 1995. <span>“Wavelab and Reproducible Research.”</span> In <em>Wavelets and Statistics</em>, 55–81. Springer. <a href="https://doi.org/10.1007/978-1-4612-2544-7_5">https://doi.org/10.1007/978-1-4612-2544-7_5</a>.
</div>
<div id="ref-burton2021reconsidering" class="csl-entry" role="listitem">
Burton, Jason, Nicole Cruz, and Ulrike Hahn. 2021. <span>“Reconsidering Evidence of Moral Contagion in Online Social Networks.”</span> <em>Nature Human Behaviour</em> 5 (12): 1629–35. <a href="https://doi.org/10.1038/s41562-021-01133-5">https://doi.org/10.1038/s41562-021-01133-5</a>.
</div>
<div id="ref-refactornature" class="csl-entry" role="listitem">
Chawla, Dalmeet Singh. 2020. <span>“Critiqued Coronavirus Simulation Gets Thumbs up from Code-Checking Efforts.”</span> <em>Nature</em> 582: 323–24. <a href="https://doi.org/10.1038/d41586-020-01685-y">https://doi.org/10.1038/d41586-020-01685-y</a>.
</div>
<div id="ref-chouldechova18a" class="csl-entry" role="listitem">
Chouldechova, Alexandra, Diana Benavides-Prado, Oleksandr Fialko, and Rhema Vaithianathan. 2018. <span>“A Case Study of Algorithm-Assisted Decision Making in Child Maltreatment Hotline Screening Decisions.”</span> In <em>Proceedings of the 1st Conference on Fairness, Accountability and Transparency</em>, edited by Sorelle Friedler and Christo Wilson, 81:134–48. Proceedings of Machine Learning Research. <a href="https://proceedings.mlr.press/v81/chouldechova18a.html">https://proceedings.mlr.press/v81/chouldechova18a.html</a>.
</div>
<div id="ref-cohen2006best" class="csl-entry" role="listitem">
Cohen, Jason, Steven Teleki, and Eric Brown. 2006. <em>Best Kept Secrets of Peer Code Review</em>. Smart Bear Incorporated.
</div>
<div id="ref-gitcreds" class="csl-entry" role="listitem">
Csárdi, Gábor. 2022. <em><span class="nocase">gitcreds: Query <span>“git”</span> Credentials from <span>“R”</span></span></em>. <a href="https://CRAN.R-project.org/package=gitcreds">https://CRAN.R-project.org/package=gitcreds</a>.
</div>
<div id="ref-AhadyDolatsara2021" class="csl-entry" role="listitem">
Dolatsara, Hamidreza Ahady, Ying-Ju Chen, Robert Leonard, Fadel Megahed, and Allison Jones-Farmer. 2021. <span>“Explaining Predictive Model Performance: An Experimental Study of Data Preparation and Model Choice.”</span> <em>Big Data</em>, October. <a href="https://doi.org/10.1089/big.2021.0067">https://doi.org/10.1089/big.2021.0067</a>.
</div>
<div id="ref-eghbal2020working" class="csl-entry" role="listitem">
Eghbal, Nadia. 2020. <em>Working in Public: The Making and Maintenance of Open Source Software</em>. California: Stripe Press.
</div>
<div id="ref-refactoringbook" class="csl-entry" role="listitem">
Fowler, Martin, and Kent Beck. 2018. <em><span class="nocase">Refactoring: Improving the Design of Existing Code</span></em>. 2nd ed. New York: Addison-Wesley Professional.
</div>
<div id="ref-sharlatalks" class="csl-entry" role="listitem">
Gelfand, Sharla. 2021. <span>“Make a ReprEx... Please.”</span> <em>YouTube</em>, February. <a href="https://youtu.be/G5Nm-GpmrLw">https://youtu.be/G5Nm-GpmrLw</a>.
</div>
<div id="ref-Gelman2016" class="csl-entry" role="listitem">
Gelman, Andrew. 2016. <span>“<span class="nocase">What has happened down here is the winds have changed</span>,”</span> September. <a href="https://statmodeling.stat.columbia.edu/2016/09/21/what-has-happened-down-here-is-the-winds-have-changed/">https://statmodeling.stat.columbia.edu/2016/09/21/what-has-happened-down-here-is-the-winds-have-changed/</a>.
</div>
<div id="ref-Gelman_2018" class="csl-entry" role="listitem">
Gelman, Andrew, Greggor Mattson, and Daniel Simpson. 2018. <span>“Gaydar and the Fallacy of Decontextualized Measurement.”</span> <em>Sociological Science</em> 5 (12): 270–80. <a href="https://doi.org/10.15195/v5.a12">https://doi.org/10.15195/v5.a12</a>.
</div>
<div id="ref-googlecoderview" class="csl-entry" role="listitem">
Google. 2022. <span>“What to Look for in a Code Review.”</span> Google Engineering Practices Documentation. <a href="https://google.github.io/eng-practices/review/reviewer/looking-for.html">https://google.github.io/eng-practices/review/reviewer/looking-for.html</a>.
</div>
<div id="ref-heil2021reproducibility" class="csl-entry" role="listitem">
Heil, Benjamin, Michael Hoffman, Florian Markowetz, Su-In Lee, Casey Greene, and Stephanie Hicks. 2021. <span>“Reproducibility Standards for Machine Learning in the Life Sciences.”</span> <em>Nature Methods</em> 18 (10): 1132–35. <a href="https://doi.org/10.1038/s41592-021-01256-7">https://doi.org/10.1038/s41592-021-01256-7</a>.
</div>
<div id="ref-herndon2014does" class="csl-entry" role="listitem">
Herndon, Thomas, Michael Ash, and Robert Pollin. 2014. <span>“Does High Public Debt Consistently Stifle Economic Growth? A Critique of Reinhart and Rogoff.”</span> <em>Cambridge Journal of Economics</em> 38 (2): 257–79. <a href="https://doi.org/10.1093/cje/bet075">https://doi.org/10.1093/cje/bet075</a>.
</div>
<div id="ref-lintr" class="csl-entry" role="listitem">
Hester, Jim, Florent Angly, Russ Hyde, Michael Chirico, Kun Ren, Alexander Rosenstock, and Indrajeet Patil. 2022. <em><span class="nocase">lintr: A <span>“Linter”</span> for R Code</span></em>. <a href="https://CRAN.R-project.org/package=lintr">https://CRAN.R-project.org/package=lintr</a>.
</div>
<div id="ref-hillelwayne" class="csl-entry" role="listitem">
Hillel, Wayne. 2017. <em>How Do We Trust Our Science Code?</em> <a href="https://www.hillelwayne.com/how-do-we-trust-science-code/">https://www.hillelwayne.com/how-do-we-trust-science-code/</a>.
</div>
<div id="ref-researchsoftware" class="csl-entry" role="listitem">
Irving, Damien, Kate Hertweck, Luke Johnston, Joel Ostblom, Charlotte Wickham, and Greg Wilson. 2021. <em>Research Software Engineering with Python</em>. Chapman; Hall/CRC.
</div>
<div id="ref-stevejobs" class="csl-entry" role="listitem">
Isaacson, Walter. 2011. <em>Steve Jobs</em>. 1st ed. Simon &amp; Schuster.
</div>
<div id="ref-Izrailev2014" class="csl-entry" role="listitem">
Izrailev, Sergei. 2022. <em><span class="nocase">tictoc: Functions for Timing R Scripts, as Well as Implementations of <span>“Stack”</span> and <span>“List”</span> Structures</span></em>. <a href="https://CRAN.R-project.org/package=tictoc">https://CRAN.R-project.org/package=tictoc</a>.
</div>
<div id="ref-citeaer" class="csl-entry" role="listitem">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.
</div>
<div id="ref-Knuth1984" class="csl-entry" role="listitem">
Knuth, Donald. 1984. <span>“Literate Programming.”</span> <em>The Computer Journal</em> 27 (2): 97–111. <a href="https://doi.org/10.1093/comjnl/27.2.97">https://doi.org/10.1093/comjnl/27.2.97</a>.
</div>
<div id="ref-targets" class="csl-entry" role="listitem">
Landau, William Michael. 2021. <span>“<span class="nocase">The targets R Package: A Dynamic Make-Like Function-Oriented Pipeline Toolkit for Reproducibility and High-Performance Computing</span>.”</span> <em>Journal of Open Source Software</em> 6 (57): 2959. <a href="https://doi.org/10.21105/joss.02959">https://doi.org/10.21105/joss.02959</a>.
</div>
<div id="ref-nonudge" class="csl-entry" role="listitem">
Maier, Maximilian, František Bartoš, Tom Stanley, David Shanks, Adam Harris, and Eric-Jan Wagenmakers. 2022. <span>“No Evidence for Nudging After Adjusting for Publication Bias.”</span> <em>Proceedings of the National Academy of Sciences</em> 119 (31): e2200300119. <a href="https://doi.org/10.1073/pnas.2200300119">https://doi.org/10.1073/pnas.2200300119</a>.
</div>
<div id="ref-beautifulcode" class="csl-entry" role="listitem">
Matsumoto, Yukihiro. 2007. <span>“<span class="nocase">Treating Code as an Essay</span>.”</span> In <em>Beautiful Code</em>, edited by Andy Oram and Greg Wilson, 477–81. O’Reilly.
</div>
<div id="ref-Mattson2017" class="csl-entry" role="listitem">
Mattson, Greggor. 2017. <span>“Artificial Intelligence Discovers Gayface. Sigh.”</span> <a href="https://greggormattson.com/2017/09/09/artificial-intelligence-discovers-gayface/amp/">https://greggormattson.com/2017/09/09/artificial-intelligence-discovers-gayface/amp/</a>.
</div>
<div id="ref-merali2010computational" class="csl-entry" role="listitem">
Merali, Zeeya. 2010. <span>“Computational Science:... Error.”</span> <em>Nature</em> 467 (7317): 775–77. <a href="https://doi.org/10.1038/467775a">https://doi.org/10.1038/467775a</a>.
</div>
<div id="ref-GoodResearchCode" class="csl-entry" role="listitem">
Mineault, Patrick, and The Good Research Code Handbook Community. 2021. <span>“The Good Research Code Handbook.”</span> <a href="https://doi.org/10.5281/zenodo.5796873">https://doi.org/10.5281/zenodo.5796873</a>.
</div>
<div id="ref-minsky2011ocaml" class="csl-entry" role="listitem">
Minsky, Yaron. 2011. <span>“<span class="nocase">OCaml for the masses</span>.”</span> <em>Communications of the ACM</em> 54 (11): 53–58. <a href="https://doi.org/10.1145/2018396.2018413">https://doi.org/10.1145/2018396.2018413</a>.
</div>
<div id="ref-ocamlyaronpodcast" class="csl-entry" role="listitem">
———. 2015. <span>“Automated Trading and OCaml with Yaron Minsky.”</span> <em>Hackers — Software Engineering Daily</em>, November. <a href="https://softwareengineeringdaily.com/2015/11/09/automated-trading-and-ocaml-with-yaron-minsky/">https://softwareengineeringdaily.com/2015/11/09/automated-trading-and-ocaml-with-yaron-minsky/</a>.
</div>
<div id="ref-miyakawa2020no" class="csl-entry" role="listitem">
Miyakawa, Tsuyoshi. 2020. <span>“No Raw Data, No Science: Another Possible Source of the Reproducibility Crisis.”</span> <em>Molecular Brain</em> 13 (1): 1–6. <a href="https://doi.org/10.1186/s13041-020-0552-2">https://doi.org/10.1186/s13041-020-0552-2</a>.
</div>
<div id="ref-styler" class="csl-entry" role="listitem">
Müller, Kirill, and Lorenz Walthert. 2022. <em><span class="nocase">styler: Non-Invasive Pretty Printing of R Code</span></em>. <a href="https://CRAN.R-project.org/package=styler">https://CRAN.R-project.org/package=styler</a>.
</div>
<div id="ref-murphy2017" class="csl-entry" role="listitem">
Murphy, Heather. 2017. <span>“Why Stanford Researchers Tried to Create a <span>‘Gaydar’</span> Machine.”</span> <em>The New York Times</em>, October. <a href="https://www.nytimes.com/2017/10/09/science/stanford-sexual-orientation-study.html">https://www.nytimes.com/2017/10/09/science/stanford-sexual-orientation-study.html</a>.
</div>
<div id="ref-pineau2021improving" class="csl-entry" role="listitem">
Pineau, Joelle, Philippe Vincent-Lamarre, Koustuv Sinha, Vincent Larivière, Alina Beygelzimer, Florence d’Alché-Buc, Emily Fox, and Hugo Larochelle. 2021. <span>“Improving Reproducibility in Machine Learning Research (a Report from the NeurIPS 2019 Reproducibility Program).”</span> <em>Journal of Machine Learning Research</em> 22 (164): 1–20. <a href="http://jmlr.org/papers/v22/20-303.html">http://jmlr.org/papers/v22/20-303.html</a>.
</div>
<div id="ref-citeR" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-rilke" class="csl-entry" role="listitem">
Rilke, Rainer Maria. (1929) 2014. <em>Letters to a Young Poet</em>. Penguin Classics.
</div>
<div id="ref-romersays" class="csl-entry" role="listitem">
Romer, Paul. 2018. <span>“Jupyter, Mathematica, and the Future of the Research Paper,”</span> April. <a href="https://paulromer.net/jupyter-mathematica-and-the-future-of-the-research-paper/">https://paulromer.net/jupyter-mathematica-and-the-future-of-the-research-paper/</a>.
</div>
<div id="ref-codereview" class="csl-entry" role="listitem">
Sadowski, Caitlin, Emma Söderberg, Luke Church, Michal Sipko, and Alberto Bacchelli. 2018. <span>“Modern Code Review: A Case Study at Google.”</span> In <em>Proceedings of the 40th International Conference on Software Engineering: Software Engineering in Practice</em>, 181–90. ICSE-SEIP ’18. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/3183519.3183525">https://doi.org/10.1145/3183519.3183525</a>.
</div>
<div id="ref-natefixesmistake" class="csl-entry" role="listitem">
Silver, Nate. 2020. <span>“We Fixed an Issue with How Our Primary Forecast Was Calculating Candidates’ Demographic Strengths.”</span> <em>FiveThirtyEight</em>, February. <a href="https://fivethirtyeight.com/features/we-fixed-a-mistake-in-how-our-primary-forecast-was-calculating-candidates-demographic-strengths/">https://fivethirtyeight.com/features/we-fixed-a-mistake-in-how-our-primary-forecast-was-calculating-candidates-demographic-strengths/</a>.
</div>
<div id="ref-somers2018obsolete" class="csl-entry" role="listitem">
Somers, James. 2018. <span>“The Scientific Paper Is Obsolete.”</span> <em>The Atlantic</em>, April. <a href="https://www.theatlantic.com/science/archive/2018/04/the-scientific-paper-is-obsolete/556676/">https://www.theatlantic.com/science/archive/2018/04/the-scientific-paper-is-obsolete/556676/</a>.
</div>
<div id="ref-sprint2019mining" class="csl-entry" role="listitem">
Sprint, Gina, and Jason Conci. 2019. <span>“Mining GitHub Classroom Commit Behavior in Elective and Introductory Computer Science Courses.”</span> <em>Journal of Computing Sciences in Colleges</em> 35 (1): 76–84.
</div>
<div id="ref-sunstein2017economics" class="csl-entry" role="listitem">
Sunstein, Cass, and Lucia Reisch. 2017. <em>The Economics of Nudge</em>. Routledge.
</div>
<div id="ref-gelmannudge" class="csl-entry" role="listitem">
Szaszi, Barnabas, Anthony Higney, Aaron Charlton, Andrew Gelman, Ignazio Ziano, Balazs Aczel, Daniel Goldstein, David Yeager, and Elizabeth Tipton. 2022. <span>“No Reason to Expect Large and Consistent Effects of Nudge Interventions.”</span> <em>Proceedings of the National Academy of Sciences</em> 119 (31): e2200732119. <a href="https://doi.org/10.1073/pnas.2200732119">https://doi.org/10.1073/pnas.2200732119</a>.
</div>
<div id="ref-Trisovic2022" class="csl-entry" role="listitem">
Trisovic, Ana, Matthew Lau, Thomas Pasquier, and Mercè Crosas. 2022. <span>“A Large-Scale Study on Research Code Quality and Execution.”</span> <em>Scientific Data</em> 9 (1). <a href="https://doi.org/10.1038/s41597-022-01143-6">https://doi.org/10.1038/s41597-022-01143-6</a>.
</div>
<div id="ref-renv" class="csl-entry" role="listitem">
Ushey, Kevin. 2022. <em><span class="nocase">renv: Project Environments</span></em>. <a href="https://CRAN.R-project.org/package=renv">https://CRAN.R-project.org/package=renv</a>.
</div>
<div id="ref-Vidoni2021" class="csl-entry" role="listitem">
Vidoni, Melina. 2021. <span>“<span class="nocase">Evaluating Unit Testing Practices in R Packages</span>.”</span> In <em>2021 IEEE/ACM 43rd International Conference on Software Engineering (ICSE)</em>, 1523–34. <a href="https://doi.org/10.1109/ICSE43902.2021.00136">https://doi.org/10.1109/ICSE43902.2021.00136</a>.
</div>
<div id="ref-wang2018deep" class="csl-entry" role="listitem">
Wang, Yilun, and Michal Kosinski. 2018. <span>“Deep Neural Networks Are More Accurate Than Humans at Detecting Sexual Orientation from Facial Images.”</span> <em>Journal of Personality and Social Psychology</em> 114 (2): 246–57. <a href="https://doi.org/10.1037/pspa0000098">https://doi.org/10.1037/pspa0000098</a>.
</div>
<div id="ref-tidyversestyleguide" class="csl-entry" role="listitem">
Wickham, Hadley. 2021. <em>The Tidyverse Style Guide</em>. <a href="https://style.tidyverse.org/index.html">https://style.tidyverse.org/index.html</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“<span class="nocase">Welcome to the Tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-usethis" class="csl-entry" role="listitem">
Wickham, Hadley, Jennifer Bryan, and Malcolm Barrett. 2022. <em><span class="nocase">usethis: Automate Package and Project Setup</span></em>. <a href="https://CRAN.R-project.org/package=usethis">https://CRAN.R-project.org/package=usethis</a>.
</div>
<div id="ref-wilsongoodenough" class="csl-entry" role="listitem">
Wilson, Greg, Jenny Bryan, Karen Cranston, Justin Kitzes, Lex Nederbragt, and Tracy Teal. 2017. <span>“Good Enough Practices in Scientific Computing.”</span> <em>PLOS Computational Biology</em> 13 (6): 1–20. <a href="https://doi.org/10.1371/journal.pcbi.1005510">https://doi.org/10.1371/journal.pcbi.1005510</a>.
</div>
<div id="ref-tinytex" class="csl-entry" role="listitem">
Xie, Yihui. 2019. <span>“<span class="nocase">TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live</span>.”</span> <em>TUGboat</em>, no. 1: 30–32. <a href="https://tug.org/TUGboat/Contents/contents40-1.html">https://tug.org/TUGboat/Contents/contents40-1.html</a>.
</div>
<div id="ref-citeknitr" class="csl-entry" role="listitem">
———. 2023. <em><span class="nocase">knitr: A General-Purpose Package for Dynamic Report Generation in R</span></em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-drinking_from_a_fire_hose.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Drinking from a fire hose</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-writing_research.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing research</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>